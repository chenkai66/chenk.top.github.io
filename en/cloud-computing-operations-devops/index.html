<!DOCTYPE html>



<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="keywords" content="Hexo Theme Keep">
    <meta name="description" content="Hexo Theme Keep">
    <meta name="author" content="Chen Kai">
    
    <title>
        
            Cloud Computing (7): Operations and DevOps Practices |
        
        Chen Kai Blog
    </title>
    
<link rel="stylesheet" href="/css/style.css">

    <link rel="shortcut icon" href="/images/logo.svg">
    
<link rel="stylesheet" href="/css/font-awesome.min.css">

    <script id="hexo-configurations">
    let KEEP = window.KEEP || {};
    KEEP.hexo_config = {"hostname":"chenk.top","root":"/","language":"en","default_language":"zh-CN","languages":["zh-CN","en"],"path":"search.json"};
    KEEP.theme_config = {"toc":{"enable":true,"number":true,"expand_all":true,"init_open":true},"style":{"primary_color":"#0066CC","avatar":"/images/avatar.svg","favicon":"/images/logo.svg","article_img_align":"left","left_side_width":"260px","content_max_width":"920px","hover":{"shadow":false,"scale":false},"first_screen":{"enable":true,"background_img":"/images/bg.svg","description":"Keep writing and Keep loving."},"scroll":{"progress_bar":{"enable":true},"percent":{"enable":false}}},"local_search":{"enable":true,"preload":true},"code_copy":{"enable":true,"style":"default"},"pjax":{"enable":true},"lazyload":{"enable":false},"version":"3.4.5"};
    KEEP.language_ago = {"second":"%s seconds ago","minute":"%s minutes ago","hour":"%s hours ago","day":"%s days ago","week":"%s weeks ago","month":"%s months ago","year":"%s years ago"};
  </script>
<meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="Chen Kai Blog" type="application/atom+xml">
</head>


<body>
<div class="progress-bar-container">
    
        <span class="scroll-progress-bar"></span>
    

    
        <span class="pjax-progress-bar"></span>
        <span class="pjax-progress-icon">
            <i class="fas fa-circle-notch fa-spin"></i>
        </span>
    
</div>


<main class="page-container">

    

    <div class="page-main-content">

        <div class="page-main-content-top">
            <header class="header-wrapper">

    
    
    
    
    

    <div class="header-content">
        <div class="left">
            
            <a class="logo-title" href="/en/">
                Chen Kai Blog
            </a>
        </div>

        <div class="right">
            <div class="pc">
                <ul class="menu-list">
                    
                        <li class="menu-item">
                            
                            
                            <a class=""
                               href="/en/"
                            >
                                HOME
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            
                            
                            <a class=""
                               href="/en/archives"
                            >
                                ARCHIVES
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            
                            
                            <a class=""
                               href="/en/categories"
                            >
                                CATEGORIES
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            
                            
                            <a class=""
                               href="/en/tags"
                            >
                                TAGS
                            </a>
                        </li>
                    
                    <li class="menu-item lang-switch lang-switch-trigger" title="Language">
                        <i class="fas fa-globe"></i>
                    </li>
                    
                        <li class="menu-item search search-popup-trigger">
                            <i class="fas fa-search"></i>
                        </li>
                    
                </ul>
            </div>
            <div class="mobile">
                
                    <div class="icon-item search search-popup-trigger"><i class="fas fa-search"></i></div>
                
                <div class="icon-item lang-switch-trigger"><i class="fas fa-globe"></i></div>
                <div class="icon-item menu-bar">
                    <div class="menu-bar-middle"></div>
                </div>
            </div>
        </div>
    </div>

    <div class="header-drawer">
        <ul class="drawer-menu-list">
            
                <li class="drawer-menu-item flex-center">
                    
                    
                    <a class=""
                       href="/en/">HOME</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    
                    
                    <a class=""
                       href="/en/archives">ARCHIVES</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    
                    
                    <a class=""
                       href="/en/categories">CATEGORIES</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    
                    
                    <a class=""
                       href="/en/tags">TAGS</a>
                </li>
            
        </ul>
    </div>

    <div class="window-mask"></div>

</header>


        </div>

        <div class="page-main-content-middle">

            <div class="main-content">

                
                    <div class="fade-in-down-animation">
    
    
    
    

    <div class="article-content-container">

        <div class="article-title">
            <span class="title-hover-animation">Cloud Computing (7): Operations and DevOps Practices</span>
        </div>

        
            <div class="article-header">
                <div class="avatar">
                    <img src="/images/avatar.svg">
                </div>
                <div class="info">
                    <div class="author">
                        <span class="name">Chen Kai</span>
                        
                            <span class="author-label">BOSS</span>
                        
                    </div>
                    <div class="meta-info">
                        <div class="article-meta-info">
    
    
    
    
    <span class="article-date article-meta-item">
        <i class="fas fa-edit"></i>&nbsp;
        <span class="pc">2025-01-05 00:00:00</span>
        <span class="mobile">2025-01-05 00:00</span>
    </span>
    
        <span class="article-categories article-meta-item">
            <i class="fas fa-folder"></i>&nbsp;
            <ul>
                
                    <li>
                        <a href="/en/categories/Cloud-Computing/">Cloud Computing</a>&nbsp;
                    </li>
                
            </ul>
        </span>
    
    
        <span class="article-tags article-meta-item">
            <i class="fas fa-tags"></i>&nbsp;
            <ul>
                
                    <li>
                        <a href="/en/tags/DevOps/">DevOps</a>&nbsp;
                    </li>
                
                    <li>
                        | <a href="/en/tags/Cloud-Computing/">Cloud Computing</a>&nbsp;
                    </li>
                
                    <li>
                        | <a href="/en/tags/Operations/">Operations</a>&nbsp;
                    </li>
                
                    <li>
                        | <a href="/en/tags/Monitoring/">Monitoring</a>&nbsp;
                    </li>
                
                    <li>
                        | <a href="/en/tags/Automation/">Automation</a>&nbsp;
                    </li>
                
            </ul>
        </span>
    

    
    
        <span class="article-wordcount article-meta-item">
            <i class="fas fa-file-word"></i>&nbsp;<span>7.8k Words</span>
        </span>
    
    
        <span class="article-min2read article-meta-item">
            <i class="fas fa-clock"></i>&nbsp;<span>48 Mins</span>
        </span>
    
    
        <span class="article-pv article-meta-item">
            <i class="fas fa-eye"></i>&nbsp;<span id="busuanzi_value_page_pv"></span>
        </span>
    
</div>

                    </div>
                </div>
            </div>
        

        <div class="article-content markdown-body">
            <p>Picture this: you've deployed your application to the cloud. It's
running smoothly, users are happy, and everything looks great. Then, at
3 AM on a Sunday, your monitoring alerts start firing. Response times
have spiked, error rates are climbing, and your on-call engineer is
scrambling to figure out what's wrong. Is it a database connection pool
exhaustion? A memory leak? A sudden traffic spike? Or something else
entirely?</p>
<p>This scenario plays out daily in cloud operations. Building and
deploying applications is only half the battle—keeping them running
reliably, efficiently, and cost-effectively is where operations and
DevOps practices become critical. The difference between a well-operated
cloud system and a poorly managed one isn't just uptime; it's the
ability to detect issues before they impact users, respond to incidents
quickly, optimize costs continuously, and scale seamlessly.</p>
<p>In this comprehensive guide, we'll explore the full spectrum of cloud
operations and DevOps practices: infrastructure as code, monitoring and
observability, logging and analysis, application performance management,
automation pipelines, auto-scaling strategies, cost optimization
techniques, troubleshooting methodologies, Site Reliability Engineering
principles, and modern GitOps workflows. We'll dive deep into tools like
Terraform, Ansible, Prometheus, Grafana, ELK stack, and examine
real-world case studies that demonstrate these practices in action.</p>
<span id="more"></span>
<h2 id="the-evolution-of-cloud-operations">The Evolution of Cloud
Operations</h2>
<h3 id="from-traditional-it-to-devops">From Traditional IT to
DevOps</h3>
<p>Traditional IT operations followed a siloed model: developers wrote
code, handed it to operations teams who deployed and maintained it, and
the two groups often worked at cross-purposes. Developers wanted rapid
releases; operations wanted stability. This tension created bottlenecks,
slow deployments, and finger-pointing when things went wrong.</p>
<p>DevOps emerged as a cultural and technical movement to bridge this
divide. The term, coined around 2009, combines "development" and
"operations" to emphasize collaboration, shared responsibility, and
automation. DevOps isn't just about tools—it's about creating a culture
where building, deploying, and operating software becomes a unified,
continuous process.</p>
<p><strong>Key Principles</strong>: - <strong>Automation</strong>:
Eliminate manual, error-prone processes through scripting and tooling -
<strong>Continuous Integration/Continuous Deployment (CI/CD)</strong>:
Integrate code changes frequently and deploy automatically -
<strong>Infrastructure as Code</strong>: Manage infrastructure through
version-controlled code - <strong>Monitoring and Logging</strong>:
Comprehensive observability into system behavior -
<strong>Collaboration</strong>: Break down silos between development and
operations teams</p>
<h3 id="cloud-operations-challenges">Cloud Operations Challenges</h3>
<p>Operating cloud infrastructure introduces unique challenges compared
to traditional on-premises environments:</p>
<p><strong>Scale and Complexity</strong>: Cloud systems can span
multiple regions, availability zones, and services. A single application
might depend on dozens of microservices, databases, caches, message
queues, and external APIs. Understanding dependencies and failure modes
becomes exponentially more complex.</p>
<p><strong>Dynamic Nature</strong>: Resources are ephemeral—instances
come and go, auto-scaling groups expand and contract, containers are
created and destroyed. Traditional static monitoring approaches don't
work well in this environment.</p>
<p><strong>Multi-Tenancy</strong>: Cloud providers operate massive
shared infrastructure. Understanding how your application's performance
might be affected by "noisy neighbors" or provider-side issues requires
sophisticated monitoring.</p>
<p><strong>Cost Management</strong>: Cloud costs can spiral out of
control without careful management. Idle resources, over-provisioning,
inefficient instance types, and data transfer costs can quickly exceed
budgets.</p>
<p><strong>Security and Compliance</strong>: Cloud environments require
continuous security monitoring, compliance validation, and access
management. Misconfigurations can expose sensitive data or create
security vulnerabilities.</p>
<p><strong>Vendor Lock-in</strong>: While cloud providers offer powerful
managed services, relying too heavily on proprietary services can make
migration difficult. Balancing convenience with portability is a
constant operational consideration.</p>
<h2 id="infrastructure-as-code-iac">Infrastructure as Code (IaC)</h2>
<p>Infrastructure as Code is the practice of managing and provisioning
infrastructure through machine-readable definition files rather than
manual configuration. This approach brings version control, testing,
code review, and automation to infrastructure management.</p>
<h3 id="why-infrastructure-as-code">Why Infrastructure as Code?</h3>
<p><strong>Consistency</strong>: Manual configuration leads to
drift—servers configured differently, missing security patches,
inconsistent networking rules. IaC ensures every environment is
identical.</p>
<p><strong>Speed</strong>: Provisioning infrastructure manually takes
hours or days. With IaC, you can spin up entire environments in
minutes.</p>
<p><strong>Risk Reduction</strong>: Manual changes are error-prone. IaC
allows you to test infrastructure changes before applying them, review
changes through pull requests, and roll back if needed.</p>
<p><strong>Documentation</strong>: IaC code serves as living
documentation of your infrastructure. New team members can understand
the system by reading the code.</p>
<p><strong>Cost Control</strong>: IaC makes it easy to destroy unused
resources, right-size instances, and replicate cost-optimized
configurations.</p>
<h3 id="terraform-declarative-infrastructure-provisioning">Terraform:
Declarative Infrastructure Provisioning</h3>
<p>Terraform by HashiCorp is the most popular IaC tool, using a
declarative configuration language (HCL - HashiCorp Configuration
Language) to define desired infrastructure state.</p>
<p><strong>Core Concepts</strong>:</p>
<ol type="1">
<li><strong>Providers</strong>: Plugins that interact with cloud APIs
(AWS, Azure, GCP, etc.)</li>
<li><strong>Resources</strong>: Infrastructure components (EC2
instances, S3 buckets, VPCs)</li>
<li><strong>State</strong>: A file tracking the mapping between
configuration and real infrastructure</li>
<li><strong>Modules</strong>: Reusable, parameterized
configurations</li>
</ol>
<p><strong>Example: AWS EC2 Instance with Terraform</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br></pre></td><td class="code"><pre><span class="line"># variables.tf</span><br><span class="line">variable &quot;instance_type&quot; &#123;</span><br><span class="line">  description = &quot;EC2 instance type&quot;</span><br><span class="line">  type        = string</span><br><span class="line">  default     = &quot;t3.medium&quot;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">variable &quot;ami_id&quot; &#123;</span><br><span class="line">  description = &quot;AMI ID for the instance&quot;</span><br><span class="line">  type        = string</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">variable &quot;environment&quot; &#123;</span><br><span class="line">  description = &quot;Environment name&quot;</span><br><span class="line">  type        = string</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"># main.tf</span><br><span class="line">terraform &#123;</span><br><span class="line">  required_version = &quot;&gt;= 1.0&quot;</span><br><span class="line">  </span><br><span class="line">  required_providers &#123;</span><br><span class="line">    aws = &#123;</span><br><span class="line">      source  = &quot;hashicorp/aws&quot;</span><br><span class="line">      version = &quot;~&gt; 5.0&quot;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">provider &quot;aws&quot; &#123;</span><br><span class="line">  region = &quot;us-east-1&quot;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"># Data source to get the latest Amazon Linux 2 AMI</span><br><span class="line">data &quot;aws_ami&quot; &quot;amazon_linux&quot; &#123;</span><br><span class="line">  most_recent = true</span><br><span class="line">  owners      = [&quot;amazon&quot;]</span><br><span class="line">  </span><br><span class="line">  filter &#123;</span><br><span class="line">    name   = &quot;name&quot;</span><br><span class="line">    values = [&quot;amzn2-ami-hvm-*-x86_64-gp2&quot;]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"># Security group for the instance</span><br><span class="line">resource &quot;aws_security_group&quot; &quot;web_server&quot; &#123;</span><br><span class="line">  name        = &quot;$&#123;var.environment&#125;-web-server-sg&quot;</span><br><span class="line">  description = &quot;Security group for web server&quot;</span><br><span class="line">  </span><br><span class="line">  ingress &#123;</span><br><span class="line">    description = &quot;HTTP&quot;</span><br><span class="line">    from_port   = 80</span><br><span class="line">    to_port     = 80</span><br><span class="line">    protocol    = &quot;tcp&quot;</span><br><span class="line">    cidr_blocks = [&quot;0.0.0.0/0&quot;]</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  ingress &#123;</span><br><span class="line">    description = &quot;HTTPS&quot;</span><br><span class="line">    from_port   = 443</span><br><span class="line">    to_port     = 443</span><br><span class="line">    protocol    = &quot;tcp&quot;</span><br><span class="line">    cidr_blocks = [&quot;0.0.0.0/0&quot;]</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  ingress &#123;</span><br><span class="line">    description = &quot;SSH&quot;</span><br><span class="line">    from_port   = 22</span><br><span class="line">    to_port     = 22</span><br><span class="line">    protocol    = &quot;tcp&quot;</span><br><span class="line">    cidr_blocks = [&quot;10.0.0.0/8&quot;]</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  egress &#123;</span><br><span class="line">    from_port   = 0</span><br><span class="line">    to_port     = 0</span><br><span class="line">    protocol    = &quot;-1&quot;</span><br><span class="line">    cidr_blocks = [&quot;0.0.0.0/0&quot;]</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  tags = &#123;</span><br><span class="line">    Name        = &quot;$&#123;var.environment&#125;-web-server-sg&quot;</span><br><span class="line">    Environment = var.environment</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"># EC2 instance</span><br><span class="line">resource &quot;aws_instance&quot; &quot;web_server&quot; &#123;</span><br><span class="line">  ami           = var.ami_id != &quot;&quot; ? var.ami_id : data.aws_ami.amazon_linux.id</span><br><span class="line">  instance_type = var.instance_type</span><br><span class="line">  </span><br><span class="line">  vpc_security_group_ids = [aws_security_group.web_server.id]</span><br><span class="line">  </span><br><span class="line">  user_data = &lt;&lt;-EOF</span><br><span class="line">              #!/bin/bash</span><br><span class="line">              yum update -y</span><br><span class="line">              yum install -y httpd</span><br><span class="line">              systemctl start httpd</span><br><span class="line">              systemctl enable httpd</span><br><span class="line">              echo &quot;&lt;h1&gt;Hello from $&#123;var.environment&#125;&lt;/h1&gt;&quot; &gt; /var/www/html/index.html</span><br><span class="line">              EOF</span><br><span class="line">  </span><br><span class="line">  tags = &#123;</span><br><span class="line">    Name        = &quot;$&#123;var.environment&#125;-web-server&quot;</span><br><span class="line">    Environment = var.environment</span><br><span class="line">    ManagedBy   = &quot;Terraform&quot;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"># Output the instance public IP</span><br><span class="line">output &quot;instance_public_ip&quot; &#123;</span><br><span class="line">  description = &quot;Public IP address of the instance&quot;</span><br><span class="line">  value       = aws_instance.web_server.public_ip</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>Terraform Workflow</strong>:</p>
<ol type="1">
<li><strong>Write Configuration</strong>: Define resources in
<code>.tf</code> files</li>
<li><strong>Initialize</strong>: <code>terraform init</code> downloads
providers and modules</li>
<li><strong>Plan</strong>: <code>terraform plan</code> shows what
changes will be made</li>
<li><strong>Apply</strong>: <code>terraform apply</code> creates or
modifies infrastructure</li>
<li><strong>Destroy</strong>: <code>terraform destroy</code> removes
infrastructure</li>
</ol>
<p><strong>State Management</strong>: Terraform state files track
resource mappings. For team collaboration, store state remotely using
backends like S3, Azure Storage, or Terraform Cloud.</p>
<p><strong>Best Practices</strong>: - Use modules for reusable
components - Separate environments (dev, staging, prod) into different
workspaces or directories - Enable state locking to prevent concurrent
modifications - Use variables and outputs for flexibility - Implement
policy as code with tools like OPA (Open Policy Agent)</p>
<h3 id="ansible-configuration-management-and-automation">Ansible:
Configuration Management and Automation</h3>
<p>While Terraform focuses on provisioning infrastructure, Ansible
excels at configuration management and application deployment. Ansible
uses YAML playbooks to define automation tasks.</p>
<p><strong>Key Concepts</strong>: - <strong>Playbooks</strong>: YAML
files describing automation tasks - <strong>Tasks</strong>: Individual
units of work (install package, start service, copy file) -
<strong>Modules</strong>: Reusable units of code (apt, service, copy,
template) - <strong>Inventory</strong>: List of hosts to manage -
<strong>Roles</strong>: Reusable collections of tasks, variables, and
templates</p>
<p><strong>Example: Ansible Playbook for Web Server Setup</strong></p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># playbook.yml</span></span><br><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Configure</span> <span class="string">web</span> <span class="string">server</span></span><br><span class="line">  <span class="attr">hosts:</span> <span class="string">webservers</span></span><br><span class="line">  <span class="attr">become:</span> <span class="literal">yes</span></span><br><span class="line">  <span class="attr">vars:</span></span><br><span class="line">    <span class="attr">http_port:</span> <span class="number">80</span></span><br><span class="line">    <span class="attr">https_port:</span> <span class="number">443</span></span><br><span class="line">    <span class="attr">app_user:</span> <span class="string">www-data</span></span><br><span class="line">  </span><br><span class="line">  <span class="attr">tasks:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Update</span> <span class="string">apt</span> <span class="string">cache</span></span><br><span class="line">      <span class="attr">apt:</span></span><br><span class="line">        <span class="attr">update_cache:</span> <span class="literal">yes</span></span><br><span class="line">        <span class="attr">cache_valid_time:</span> <span class="number">3600</span></span><br><span class="line">    </span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Install</span> <span class="string">required</span> <span class="string">packages</span></span><br><span class="line">      <span class="attr">apt:</span></span><br><span class="line">        <span class="attr">name:</span></span><br><span class="line">          <span class="bullet">-</span> <span class="string">nginx</span></span><br><span class="line">          <span class="bullet">-</span> <span class="string">certbot</span></span><br><span class="line">          <span class="bullet">-</span> <span class="string">python3-certbot-nginx</span></span><br><span class="line">        <span class="attr">state:</span> <span class="string">present</span></span><br><span class="line">    </span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Create</span> <span class="string">web</span> <span class="string">directory</span></span><br><span class="line">      <span class="attr">file:</span></span><br><span class="line">        <span class="attr">path:</span> <span class="string">/var/www/app</span></span><br><span class="line">        <span class="attr">state:</span> <span class="string">directory</span></span><br><span class="line">        <span class="attr">owner:</span> <span class="string">&quot;<span class="template-variable">&#123;&#123; app_user &#125;&#125;</span>&quot;</span></span><br><span class="line">        <span class="attr">group:</span> <span class="string">&quot;<span class="template-variable">&#123;&#123; app_user &#125;&#125;</span>&quot;</span></span><br><span class="line">        <span class="attr">mode:</span> <span class="string">&#x27;0755&#x27;</span></span><br><span class="line">    </span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Configure</span> <span class="string">Nginx</span></span><br><span class="line">      <span class="attr">template:</span></span><br><span class="line">        <span class="attr">src:</span> <span class="string">nginx.conf.j2</span></span><br><span class="line">        <span class="attr">dest:</span> <span class="string">/etc/nginx/sites-available/app</span></span><br><span class="line">      <span class="attr">notify:</span> <span class="string">restart</span> <span class="string">nginx</span></span><br><span class="line">    </span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Enable</span> <span class="string">site</span></span><br><span class="line">      <span class="attr">file:</span></span><br><span class="line">        <span class="attr">src:</span> <span class="string">/etc/nginx/sites-available/app</span></span><br><span class="line">        <span class="attr">dest:</span> <span class="string">/etc/nginx/sites-enabled/app</span></span><br><span class="line">        <span class="attr">state:</span> <span class="string">link</span></span><br><span class="line">      <span class="attr">notify:</span> <span class="string">restart</span> <span class="string">nginx</span></span><br><span class="line">    </span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Start</span> <span class="string">and</span> <span class="string">enable</span> <span class="string">Nginx</span></span><br><span class="line">      <span class="attr">systemd:</span></span><br><span class="line">        <span class="attr">name:</span> <span class="string">nginx</span></span><br><span class="line">        <span class="attr">state:</span> <span class="string">started</span></span><br><span class="line">        <span class="attr">enabled:</span> <span class="literal">yes</span></span><br><span class="line">  </span><br><span class="line">  <span class="attr">handlers:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">restart</span> <span class="string">nginx</span></span><br><span class="line">      <span class="attr">systemd:</span></span><br><span class="line">        <span class="attr">name:</span> <span class="string">nginx</span></span><br><span class="line">        <span class="attr">state:</span> <span class="string">restarted</span></span><br></pre></td></tr></table></figure>
<p><strong>Ansible Inventory Example</strong>:</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># inventory.ini</span></span><br><span class="line"><span class="section">[webservers]</span></span><br><span class="line">web1.example.com <span class="attr">ansible_host</span>=<span class="number">10.0</span>.<span class="number">1.10</span></span><br><span class="line">web2.example.com <span class="attr">ansible_host</span>=<span class="number">10.0</span>.<span class="number">1.11</span></span><br><span class="line"></span><br><span class="line"><span class="section">[databases]</span></span><br><span class="line">db1.example.com <span class="attr">ansible_host</span>=<span class="number">10.0</span>.<span class="number">2.10</span></span><br><span class="line"></span><br><span class="line"><span class="section">[webservers:vars]</span></span><br><span class="line"><span class="attr">ansible_user</span>=ubuntu</span><br><span class="line"><span class="attr">ansible_ssh_private_key_file</span>=~/.ssh/id_rsa</span><br></pre></td></tr></table></figure>
<p><strong>Ansible vs Terraform</strong>: - <strong>Terraform</strong>:
Best for provisioning cloud resources (VPCs, instances, load balancers)
- <strong>Ansible</strong>: Best for configuring existing systems
(installing software, managing services, deploying applications) -
<strong>Together</strong>: Use Terraform to create infrastructure, then
Ansible to configure it</p>
<h3 id="aws-cloudformation-native-aws-iac">AWS CloudFormation: Native
AWS IaC</h3>
<p>CloudFormation is AWS's native IaC service, using JSON or YAML
templates to define AWS resources.</p>
<p><strong>Example: CloudFormation Template</strong></p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">AWSTemplateFormatVersion:</span> <span class="string">&#x27;2010-09-09&#x27;</span></span><br><span class="line"><span class="attr">Description:</span> <span class="string">&#x27;Web server stack with auto-scaling&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="attr">Parameters:</span></span><br><span class="line">  <span class="attr">InstanceType:</span></span><br><span class="line">    <span class="attr">Type:</span> <span class="string">String</span></span><br><span class="line">    <span class="attr">Default:</span> <span class="string">t3.medium</span></span><br><span class="line">    <span class="attr">AllowedValues:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">t3.small</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">t3.medium</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">t3.large</span></span><br><span class="line">    <span class="attr">Description:</span> <span class="string">EC2</span> <span class="string">instance</span> <span class="string">type</span></span><br><span class="line">  </span><br><span class="line">  <span class="attr">Environment:</span></span><br><span class="line">    <span class="attr">Type:</span> <span class="string">String</span></span><br><span class="line">    <span class="attr">Default:</span> <span class="string">dev</span></span><br><span class="line">    <span class="attr">AllowedValues:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">dev</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">staging</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">prod</span></span><br><span class="line"></span><br><span class="line"><span class="attr">Resources:</span></span><br><span class="line">  <span class="attr">VPC:</span></span><br><span class="line">    <span class="attr">Type:</span> <span class="string">AWS::EC2::VPC</span></span><br><span class="line">    <span class="attr">Properties:</span></span><br><span class="line">      <span class="attr">CidrBlock:</span> <span class="number">10.0</span><span class="number">.0</span><span class="number">.0</span><span class="string">/16</span></span><br><span class="line">      <span class="attr">EnableDnsHostnames:</span> <span class="literal">true</span></span><br><span class="line">      <span class="attr">EnableDnsSupport:</span> <span class="literal">true</span></span><br><span class="line">      <span class="attr">Tags:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">Key:</span> <span class="string">Name</span></span><br><span class="line">          <span class="attr">Value:</span> <span class="type">!Sub</span> <span class="string">&#x27;$&#123;Environment&#125;-vpc&#x27;</span></span><br><span class="line">  </span><br><span class="line">  <span class="attr">PublicSubnet:</span></span><br><span class="line">    <span class="attr">Type:</span> <span class="string">AWS::EC2::Subnet</span></span><br><span class="line">    <span class="attr">Properties:</span></span><br><span class="line">      <span class="attr">VpcId:</span> <span class="type">!Ref</span> <span class="string">VPC</span></span><br><span class="line">      <span class="attr">CidrBlock:</span> <span class="number">10.0</span><span class="number">.1</span><span class="number">.0</span><span class="string">/24</span></span><br><span class="line">      <span class="attr">AvailabilityZone:</span> <span class="type">!Select</span> [<span class="number">0</span>, <span class="type">!GetAZs</span> <span class="string">&#x27;&#x27;</span>]</span><br><span class="line">      <span class="attr">MapPublicIpOnLaunch:</span> <span class="literal">true</span></span><br><span class="line">  </span><br><span class="line">  <span class="attr">InternetGateway:</span></span><br><span class="line">    <span class="attr">Type:</span> <span class="string">AWS::EC2::InternetGateway</span></span><br><span class="line">    <span class="attr">Properties:</span></span><br><span class="line">      <span class="attr">Tags:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">Key:</span> <span class="string">Name</span></span><br><span class="line">          <span class="attr">Value:</span> <span class="type">!Sub</span> <span class="string">&#x27;$&#123;Environment&#125;-igw&#x27;</span></span><br><span class="line">  </span><br><span class="line">  <span class="attr">AttachGateway:</span></span><br><span class="line">    <span class="attr">Type:</span> <span class="string">AWS::EC2::VPCGatewayAttachment</span></span><br><span class="line">    <span class="attr">Properties:</span></span><br><span class="line">      <span class="attr">VpcId:</span> <span class="type">!Ref</span> <span class="string">VPC</span></span><br><span class="line">      <span class="attr">InternetGatewayId:</span> <span class="type">!Ref</span> <span class="string">InternetGateway</span></span><br><span class="line">  </span><br><span class="line">  <span class="attr">PublicRouteTable:</span></span><br><span class="line">    <span class="attr">Type:</span> <span class="string">AWS::EC2::RouteTable</span></span><br><span class="line">    <span class="attr">Properties:</span></span><br><span class="line">      <span class="attr">VpcId:</span> <span class="type">!Ref</span> <span class="string">VPC</span></span><br><span class="line">  </span><br><span class="line">  <span class="attr">DefaultPublicRoute:</span></span><br><span class="line">    <span class="attr">Type:</span> <span class="string">AWS::EC2::Route</span></span><br><span class="line">    <span class="attr">DependsOn:</span> <span class="string">AttachGateway</span></span><br><span class="line">    <span class="attr">Properties:</span></span><br><span class="line">      <span class="attr">RouteTableId:</span> <span class="type">!Ref</span> <span class="string">PublicRouteTable</span></span><br><span class="line">      <span class="attr">DestinationCidrBlock:</span> <span class="number">0.0</span><span class="number">.0</span><span class="number">.0</span><span class="string">/0</span></span><br><span class="line">      <span class="attr">GatewayId:</span> <span class="type">!Ref</span> <span class="string">InternetGateway</span></span><br><span class="line">  </span><br><span class="line">  <span class="attr">PublicSubnetRouteTableAssociation:</span></span><br><span class="line">    <span class="attr">Type:</span> <span class="string">AWS::EC2::SubnetRouteTableAssociation</span></span><br><span class="line">    <span class="attr">Properties:</span></span><br><span class="line">      <span class="attr">SubnetId:</span> <span class="type">!Ref</span> <span class="string">PublicSubnet</span></span><br><span class="line">      <span class="attr">RouteTableId:</span> <span class="type">!Ref</span> <span class="string">PublicRouteTable</span></span><br><span class="line">  </span><br><span class="line">  <span class="attr">WebServerSecurityGroup:</span></span><br><span class="line">    <span class="attr">Type:</span> <span class="string">AWS::EC2::SecurityGroup</span></span><br><span class="line">    <span class="attr">Properties:</span></span><br><span class="line">      <span class="attr">GroupName:</span> <span class="type">!Sub</span> <span class="string">&#x27;$&#123;Environment&#125;-web-sg&#x27;</span></span><br><span class="line">      <span class="attr">GroupDescription:</span> <span class="string">Security</span> <span class="string">group</span> <span class="string">for</span> <span class="string">web</span> <span class="string">servers</span></span><br><span class="line">      <span class="attr">VpcId:</span> <span class="type">!Ref</span> <span class="string">VPC</span></span><br><span class="line">      <span class="attr">SecurityGroupIngress:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">IpProtocol:</span> <span class="string">tcp</span></span><br><span class="line">          <span class="attr">FromPort:</span> <span class="number">80</span></span><br><span class="line">          <span class="attr">ToPort:</span> <span class="number">80</span></span><br><span class="line">          <span class="attr">CidrIp:</span> <span class="number">0.0</span><span class="number">.0</span><span class="number">.0</span><span class="string">/0</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">IpProtocol:</span> <span class="string">tcp</span></span><br><span class="line">          <span class="attr">FromPort:</span> <span class="number">443</span></span><br><span class="line">          <span class="attr">ToPort:</span> <span class="number">443</span></span><br><span class="line">          <span class="attr">CidrIp:</span> <span class="number">0.0</span><span class="number">.0</span><span class="number">.0</span><span class="string">/0</span></span><br><span class="line">      <span class="attr">SecurityGroupEgress:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">IpProtocol:</span> <span class="number">-1</span></span><br><span class="line">          <span class="attr">CidrIp:</span> <span class="number">0.0</span><span class="number">.0</span><span class="number">.0</span><span class="string">/0</span></span><br><span class="line">  </span><br><span class="line">  <span class="attr">LaunchTemplate:</span></span><br><span class="line">    <span class="attr">Type:</span> <span class="string">AWS::EC2::LaunchTemplate</span></span><br><span class="line">    <span class="attr">Properties:</span></span><br><span class="line">      <span class="attr">LaunchTemplateName:</span> <span class="type">!Sub</span> <span class="string">&#x27;$&#123;Environment&#125;-web-lt&#x27;</span></span><br><span class="line">      <span class="attr">LaunchTemplateData:</span></span><br><span class="line">        <span class="attr">ImageId:</span> <span class="string">ami-0c55b159cbfafe1f0</span></span><br><span class="line">        <span class="attr">InstanceType:</span> <span class="type">!Ref</span> <span class="string">InstanceType</span></span><br><span class="line">        <span class="attr">SecurityGroupIds:</span></span><br><span class="line">          <span class="bullet">-</span> <span class="type">!Ref</span> <span class="string">WebServerSecurityGroup</span></span><br><span class="line">        <span class="attr">UserData:</span></span><br><span class="line">          <span class="attr">Fn::Base64:</span> <span class="type">!Sub</span> <span class="string">|</span></span><br><span class="line"><span class="string">            #!/bin/bash</span></span><br><span class="line"><span class="string">            yum update -y</span></span><br><span class="line"><span class="string">            yum install -y httpd</span></span><br><span class="line"><span class="string">            systemctl start httpd</span></span><br><span class="line"><span class="string">            systemctl enable httpd</span></span><br><span class="line"><span class="string"></span>  </span><br><span class="line">  <span class="attr">AutoScalingGroup:</span></span><br><span class="line">    <span class="attr">Type:</span> <span class="string">AWS::AutoScaling::AutoScalingGroup</span></span><br><span class="line">    <span class="attr">Properties:</span></span><br><span class="line">      <span class="attr">VPCZoneIdentifier:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="type">!Ref</span> <span class="string">PublicSubnet</span></span><br><span class="line">      <span class="attr">LaunchTemplate:</span></span><br><span class="line">        <span class="attr">LaunchTemplateId:</span> <span class="type">!Ref</span> <span class="string">LaunchTemplate</span></span><br><span class="line">        <span class="attr">Version:</span> <span class="type">!GetAtt</span> <span class="string">LaunchTemplate.LatestVersionNumber</span></span><br><span class="line">      <span class="attr">MinSize:</span> <span class="number">2</span></span><br><span class="line">      <span class="attr">MaxSize:</span> <span class="number">10</span></span><br><span class="line">      <span class="attr">DesiredCapacity:</span> <span class="number">2</span></span><br><span class="line">      <span class="attr">HealthCheckType:</span> <span class="string">ELB</span></span><br><span class="line">      <span class="attr">HealthCheckGracePeriod:</span> <span class="number">300</span></span><br><span class="line">      <span class="attr">Tags:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">Key:</span> <span class="string">Name</span></span><br><span class="line">          <span class="attr">Value:</span> <span class="type">!Sub</span> <span class="string">&#x27;$&#123;Environment&#125;-web-asg&#x27;</span></span><br><span class="line">          <span class="attr">PropagateAtLaunch:</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="attr">Outputs:</span></span><br><span class="line">  <span class="attr">VPCId:</span></span><br><span class="line">    <span class="attr">Description:</span> <span class="string">VPC</span> <span class="string">ID</span></span><br><span class="line">    <span class="attr">Value:</span> <span class="type">!Ref</span> <span class="string">VPC</span></span><br><span class="line">    <span class="attr">Export:</span></span><br><span class="line">      <span class="attr">Name:</span> <span class="type">!Sub</span> <span class="string">&#x27;$&#123;AWS::StackName&#125;-VPCId&#x27;</span></span><br><span class="line">  </span><br><span class="line">  <span class="attr">PublicSubnetId:</span></span><br><span class="line">    <span class="attr">Description:</span> <span class="string">Public</span> <span class="string">Subnet</span> <span class="string">ID</span></span><br><span class="line">    <span class="attr">Value:</span> <span class="type">!Ref</span> <span class="string">PublicSubnet</span></span><br><span class="line">    <span class="attr">Export:</span></span><br><span class="line">      <span class="attr">Name:</span> <span class="type">!Sub</span> <span class="string">&#x27;$&#123;AWS::StackName&#125;-PublicSubnetId&#x27;</span></span><br></pre></td></tr></table></figure>
<p><strong>CloudFormation Features</strong>: - <strong>Stack
Management</strong>: Create, update, and delete entire stacks -
<strong>Change Sets</strong>: Preview changes before applying -
<strong>Drift Detection</strong>: Identify manual changes to resources -
<strong>Nested Stacks</strong>: Organize complex templates -
<strong>Stack Policies</strong>: Control which resources can be
modified</p>
<h2 id="monitoring-and-observability">Monitoring and Observability</h2>
<p>Monitoring tells you what's happening; observability helps you
understand why. Modern cloud applications require comprehensive
observability across metrics, logs, and traces.</p>
<h3 id="the-three-pillars-of-observability">The Three Pillars of
Observability</h3>
<p><strong>Metrics</strong>: Numerical measurements over time (CPU
usage, request rate, error count). Metrics are efficient to store and
query but lose detail.</p>
<p><strong>Logs</strong>: Event records with timestamps and context.
Logs provide detailed information but can be expensive to store and
search.</p>
<p><strong>Traces</strong>: Request flows across distributed systems.
Traces show how requests propagate through microservices, helping
identify bottlenecks.</p>
<h3 id="prometheus-metrics-collection-and-alerting">Prometheus: Metrics
Collection and Alerting</h3>
<p>Prometheus is an open-source monitoring and alerting toolkit designed
for reliability and scalability. It uses a pull-based model where
Prometheus scrapes metrics from instrumented applications.</p>
<p><strong>Core Concepts</strong>:</p>
<ol type="1">
<li><strong>Metrics</strong>: Time-series data points</li>
<li><strong>Labels</strong>: Key-value pairs that identify metrics</li>
<li><strong>Scraping</strong>: Prometheus pulls metrics from
targets</li>
<li><strong>PromQL</strong>: Query language for metrics</li>
<li><strong>Alertmanager</strong>: Handles alerts and routing</li>
</ol>
<p><strong>Prometheus Configuration Example</strong>:</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># prometheus.yml</span></span><br><span class="line"><span class="attr">global:</span></span><br><span class="line">  <span class="attr">scrape_interval:</span> <span class="string">15s</span></span><br><span class="line">  <span class="attr">evaluation_interval:</span> <span class="string">15s</span></span><br><span class="line">  <span class="attr">external_labels:</span></span><br><span class="line">    <span class="attr">cluster:</span> <span class="string">&#x27;production&#x27;</span></span><br><span class="line">    <span class="attr">environment:</span> <span class="string">&#x27;prod&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="attr">rule_files:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">&quot;alerts.yml&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="attr">alerting:</span></span><br><span class="line">  <span class="attr">alertmanagers:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">static_configs:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">targets:</span></span><br><span class="line">          <span class="bullet">-</span> <span class="string">alertmanager:9093</span></span><br><span class="line"></span><br><span class="line"><span class="attr">scrape_configs:</span></span><br><span class="line">  <span class="comment"># Prometheus itself</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">job_name:</span> <span class="string">&#x27;prometheus&#x27;</span></span><br><span class="line">    <span class="attr">static_configs:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">targets:</span> [<span class="string">&#x27;localhost:9090&#x27;</span>]</span><br><span class="line">  </span><br><span class="line">  <span class="comment"># Node Exporter for system metrics</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">job_name:</span> <span class="string">&#x27;node&#x27;</span></span><br><span class="line">    <span class="attr">static_configs:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">targets:</span> [<span class="string">&#x27;node-exporter:9100&#x27;</span>]</span><br><span class="line">    <span class="attr">relabel_configs:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">source_labels:</span> [<span class="string">__address__</span>]</span><br><span class="line">        <span class="attr">target_label:</span> <span class="string">instance</span></span><br><span class="line">        <span class="attr">regex:</span> <span class="string">&#x27;([^:]+):\d+&#x27;</span></span><br><span class="line">        <span class="attr">replacement:</span> <span class="string">&#x27;$&#123;1&#125;&#x27;</span></span><br><span class="line">  </span><br><span class="line">  <span class="comment"># Application metrics</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">job_name:</span> <span class="string">&#x27;app&#x27;</span></span><br><span class="line">    <span class="attr">static_configs:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">targets:</span> [<span class="string">&#x27;app:8080&#x27;</span>]</span><br><span class="line">    <span class="attr">metrics_path:</span> <span class="string">&#x27;/metrics&#x27;</span></span><br><span class="line">    <span class="attr">scrape_interval:</span> <span class="string">10s</span></span><br><span class="line">  </span><br><span class="line">  <span class="comment"># Kubernetes service discovery</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">job_name:</span> <span class="string">&#x27;kubernetes-pods&#x27;</span></span><br><span class="line">    <span class="attr">kubernetes_sd_configs:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">role:</span> <span class="string">pod</span></span><br><span class="line">    <span class="attr">relabel_configs:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">source_labels:</span> [<span class="string">__meta_kubernetes_pod_annotation_prometheus_io_scrape</span>]</span><br><span class="line">        <span class="attr">action:</span> <span class="string">keep</span></span><br><span class="line">        <span class="attr">regex:</span> <span class="literal">true</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">source_labels:</span> [<span class="string">__meta_kubernetes_pod_annotation_prometheus_io_path</span>]</span><br><span class="line">        <span class="attr">action:</span> <span class="string">replace</span></span><br><span class="line">        <span class="attr">target_label:</span> <span class="string">__metrics_path__</span></span><br><span class="line">        <span class="attr">regex:</span> <span class="string">(.+)</span></span><br></pre></td></tr></table></figure>
<p><strong>PromQL Query Examples</strong>:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"># CPU usage percentage</span><br><span class="line">100 - (avg(irate(node_cpu_seconds_total&#123;mode=&quot;idle&quot;&#125;[5m])) * 100)</span><br><span class="line"></span><br><span class="line"># Request rate per second</span><br><span class="line">rate(http_requests_total[5m])</span><br><span class="line"></span><br><span class="line"># Error rate percentage</span><br><span class="line">sum(rate(http_requests_total&#123;status=~&quot;5..&quot;&#125;[5m])) / sum(rate(http_requests_total[5m])) * 100</span><br><span class="line"></span><br><span class="line"># P95 latency</span><br><span class="line">histogram_quantile(0.95, rate(http_request_duration_seconds_bucket[5m]))</span><br><span class="line"></span><br><span class="line"># Available memory</span><br><span class="line">node_memory_MemAvailable_bytes / node_memory_MemTotal_bytes * 100</span><br></pre></td></tr></table></figure>
<p><strong>Alert Rules Example</strong>:</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># alerts.yml</span></span><br><span class="line"><span class="attr">groups:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">infrastructure</span></span><br><span class="line">    <span class="attr">interval:</span> <span class="string">30s</span></span><br><span class="line">    <span class="attr">rules:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">alert:</span> <span class="string">HighCPUUsage</span></span><br><span class="line">        <span class="attr">expr:</span> <span class="number">100</span> <span class="bullet">-</span> <span class="string">(avg(irate(node_cpu_seconds_total&#123;mode=&quot;idle&quot;&#125;[5m]))</span> <span class="string">*</span> <span class="number">100</span><span class="string">)</span> <span class="string">&gt;</span> <span class="number">80</span></span><br><span class="line">        <span class="attr">for:</span> <span class="string">5m</span></span><br><span class="line">        <span class="attr">labels:</span></span><br><span class="line">          <span class="attr">severity:</span> <span class="string">warning</span></span><br><span class="line">        <span class="attr">annotations:</span></span><br><span class="line">          <span class="attr">summary:</span> <span class="string">&quot;High CPU usage detected&quot;</span></span><br><span class="line">          <span class="attr">description:</span> <span class="string">&quot;CPU usage is above 80% for more than 5 minutes on <span class="template-variable">&#123;&#123; $labels.instance &#125;&#125;</span>&quot;</span></span><br><span class="line">      </span><br><span class="line">      <span class="bullet">-</span> <span class="attr">alert:</span> <span class="string">HighMemoryUsage</span></span><br><span class="line">        <span class="attr">expr:</span> <span class="string">(1</span> <span class="bullet">-</span> <span class="string">(node_memory_MemAvailable_bytes</span> <span class="string">/</span> <span class="string">node_memory_MemTotal_bytes))</span> <span class="string">*</span> <span class="number">100</span> <span class="string">&gt;</span> <span class="number">85</span></span><br><span class="line">        <span class="attr">for:</span> <span class="string">5m</span></span><br><span class="line">        <span class="attr">labels:</span></span><br><span class="line">          <span class="attr">severity:</span> <span class="string">warning</span></span><br><span class="line">        <span class="attr">annotations:</span></span><br><span class="line">          <span class="attr">summary:</span> <span class="string">&quot;High memory usage detected&quot;</span></span><br><span class="line">          <span class="attr">description:</span> <span class="string">&quot;Memory usage is above 85% on <span class="template-variable">&#123;&#123; $labels.instance &#125;&#125;</span>&quot;</span></span><br><span class="line">      </span><br><span class="line">      <span class="bullet">-</span> <span class="attr">alert:</span> <span class="string">DiskSpaceLow</span></span><br><span class="line">        <span class="attr">expr:</span> <span class="string">(node_filesystem_avail_bytes&#123;mountpoint=&quot;/&quot;&#125;</span> <span class="string">/</span> <span class="string">node_filesystem_size_bytes&#123;mountpoint=&quot;/&quot;&#125;)</span> <span class="string">*</span> <span class="number">100</span> <span class="string">&lt;</span> <span class="number">15</span></span><br><span class="line">        <span class="attr">for:</span> <span class="string">5m</span></span><br><span class="line">        <span class="attr">labels:</span></span><br><span class="line">          <span class="attr">severity:</span> <span class="string">critical</span></span><br><span class="line">        <span class="attr">annotations:</span></span><br><span class="line">          <span class="attr">summary:</span> <span class="string">&quot;Disk space running low&quot;</span></span><br><span class="line">          <span class="attr">description:</span> <span class="string">&quot;Disk space is below 15% on <span class="template-variable">&#123;&#123; $labels.instance &#125;&#125;</span>&quot;</span></span><br><span class="line">  </span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">application</span></span><br><span class="line">    <span class="attr">interval:</span> <span class="string">30s</span></span><br><span class="line">    <span class="attr">rules:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">alert:</span> <span class="string">HighErrorRate</span></span><br><span class="line">        <span class="attr">expr:</span> <span class="string">sum(rate(http_requests_total&#123;status=~&quot;5..&quot;&#125;[5m]))</span> <span class="string">/</span> <span class="string">sum(rate(http_requests_total[5m]))</span> <span class="string">&gt;</span> <span class="number">0.05</span></span><br><span class="line">        <span class="attr">for:</span> <span class="string">5m</span></span><br><span class="line">        <span class="attr">labels:</span></span><br><span class="line">          <span class="attr">severity:</span> <span class="string">critical</span></span><br><span class="line">        <span class="attr">annotations:</span></span><br><span class="line">          <span class="attr">summary:</span> <span class="string">&quot;High error rate detected&quot;</span></span><br><span class="line">          <span class="attr">description:</span> <span class="string">&quot;Error rate is above 5% for the last 5 minutes&quot;</span></span><br><span class="line">      </span><br><span class="line">      <span class="bullet">-</span> <span class="attr">alert:</span> <span class="string">HighLatency</span></span><br><span class="line">        <span class="attr">expr:</span> <span class="string">histogram_quantile(0.95,</span> <span class="string">rate(http_request_duration_seconds_bucket[5m]))</span> <span class="string">&gt;</span> <span class="number">1</span></span><br><span class="line">        <span class="attr">for:</span> <span class="string">10m</span></span><br><span class="line">        <span class="attr">labels:</span></span><br><span class="line">          <span class="attr">severity:</span> <span class="string">warning</span></span><br><span class="line">        <span class="attr">annotations:</span></span><br><span class="line">          <span class="attr">summary:</span> <span class="string">&quot;High latency detected&quot;</span></span><br><span class="line">          <span class="attr">description:</span> <span class="string">&quot;P95 latency is above 1 second for the last 10 minutes&quot;</span></span><br></pre></td></tr></table></figure>
<h3 id="grafana-visualization-and-dashboards">Grafana: Visualization and
Dashboards</h3>
<p>Grafana is an open-source analytics and visualization platform that
works with Prometheus and other data sources. It provides rich
dashboards for visualizing metrics.</p>
<p><strong>Dashboard JSON Example</strong>:</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;dashboard&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;title&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Application Monitoring Dashboard&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;tags&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;application&quot;</span><span class="punctuation">,</span> <span class="string">&quot;monitoring&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;timezone&quot;</span><span class="punctuation">:</span> <span class="string">&quot;browser&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;panels&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">      <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="number">1</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;title&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Request Rate&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;graph&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;targets&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">          <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;expr&quot;</span><span class="punctuation">:</span> <span class="string">&quot;sum(rate(http_requests_total[5m]))&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;legendFormat&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Requests/sec&quot;</span></span><br><span class="line">          <span class="punctuation">&#125;</span></span><br><span class="line">        <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;gridPos&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span><span class="attr">&quot;h&quot;</span><span class="punctuation">:</span> <span class="number">8</span><span class="punctuation">,</span> <span class="attr">&quot;w&quot;</span><span class="punctuation">:</span> <span class="number">12</span><span class="punctuation">,</span> <span class="attr">&quot;x&quot;</span><span class="punctuation">:</span> <span class="number">0</span><span class="punctuation">,</span> <span class="attr">&quot;y&quot;</span><span class="punctuation">:</span> <span class="number">0</span><span class="punctuation">&#125;</span></span><br><span class="line">      <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="number">2</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;title&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Error Rate&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;graph&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;targets&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">          <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;expr&quot;</span><span class="punctuation">:</span> <span class="string">&quot;sum(rate(http_requests_total&#123;status=~\&quot;5..\&quot;&#125;[5m])) / sum(rate(http_requests_total[5m])) * 100&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;legendFormat&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Error %&quot;</span></span><br><span class="line">          <span class="punctuation">&#125;</span></span><br><span class="line">        <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;gridPos&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span><span class="attr">&quot;h&quot;</span><span class="punctuation">:</span> <span class="number">8</span><span class="punctuation">,</span> <span class="attr">&quot;w&quot;</span><span class="punctuation">:</span> <span class="number">12</span><span class="punctuation">,</span> <span class="attr">&quot;x&quot;</span><span class="punctuation">:</span> <span class="number">12</span><span class="punctuation">,</span> <span class="attr">&quot;y&quot;</span><span class="punctuation">:</span> <span class="number">0</span><span class="punctuation">&#125;</span></span><br><span class="line">      <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="number">3</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;title&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Response Time (P95)&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;graph&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;targets&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">          <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;expr&quot;</span><span class="punctuation">:</span> <span class="string">&quot;histogram_quantile(0.95, rate(http_request_duration_seconds_bucket[5m]))&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;legendFormat&quot;</span><span class="punctuation">:</span> <span class="string">&quot;P95 Latency&quot;</span></span><br><span class="line">          <span class="punctuation">&#125;</span></span><br><span class="line">        <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;gridPos&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span><span class="attr">&quot;h&quot;</span><span class="punctuation">:</span> <span class="number">8</span><span class="punctuation">,</span> <span class="attr">&quot;w&quot;</span><span class="punctuation">:</span> <span class="number">12</span><span class="punctuation">,</span> <span class="attr">&quot;x&quot;</span><span class="punctuation">:</span> <span class="number">0</span><span class="punctuation">,</span> <span class="attr">&quot;y&quot;</span><span class="punctuation">:</span> <span class="number">8</span><span class="punctuation">&#125;</span></span><br><span class="line">      <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="number">4</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;title&quot;</span><span class="punctuation">:</span> <span class="string">&quot;CPU Usage&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;graph&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;targets&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">          <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;expr&quot;</span><span class="punctuation">:</span> <span class="string">&quot;100 - (avg(irate(node_cpu_seconds_total&#123;mode=\&quot;idle\&quot;&#125;[5m])) * 100)&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;legendFormat&quot;</span><span class="punctuation">:</span> <span class="string">&quot;CPU %&quot;</span></span><br><span class="line">          <span class="punctuation">&#125;</span></span><br><span class="line">        <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;gridPos&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span><span class="attr">&quot;h&quot;</span><span class="punctuation">:</span> <span class="number">8</span><span class="punctuation">,</span> <span class="attr">&quot;w&quot;</span><span class="punctuation">:</span> <span class="number">12</span><span class="punctuation">,</span> <span class="attr">&quot;x&quot;</span><span class="punctuation">:</span> <span class="number">12</span><span class="punctuation">,</span> <span class="attr">&quot;y&quot;</span><span class="punctuation">:</span> <span class="number">8</span><span class="punctuation">&#125;</span></span><br><span class="line">      <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;refresh&quot;</span><span class="punctuation">:</span> <span class="string">&quot;10s&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;time&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;from&quot;</span><span class="punctuation">:</span> <span class="string">&quot;now-6h&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;to&quot;</span><span class="punctuation">:</span> <span class="string">&quot;now&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>
<p><strong>Grafana Features</strong>: - <strong>Multiple Data
Sources</strong>: Prometheus, InfluxDB, Elasticsearch, CloudWatch, etc.
- <strong>Rich Visualizations</strong>: Graphs, heatmaps, tables, stat
panels, logs - <strong>Alerting</strong>: Create alerts based on
dashboard queries - <strong>Variables</strong>: Dynamic dashboard
variables for filtering - <strong>Annotations</strong>: Mark events on
graphs - <strong>Sharing</strong>: Export dashboards as JSON or share
via URL</p>
<h3 id="application-performance-monitoring-apm">Application Performance
Monitoring (APM)</h3>
<p>APM tools provide deep insights into application performance,
tracking request flows, database queries, external API calls, and
identifying performance bottlenecks.</p>
<p><strong>Key APM Capabilities</strong>: - <strong>Distributed
Tracing</strong>: Track requests across microservices - <strong>Code
Profiling</strong>: Identify slow functions and database queries -
<strong>Error Tracking</strong>: Capture and analyze application errors
- <strong>Real User Monitoring (RUM)</strong>: Track actual user
experience - <strong>Synthetic Monitoring</strong>: Proactive testing
from various locations</p>
<p><strong>Popular APM Tools</strong>: - <strong>Datadog APM</strong>:
Full-stack observability with distributed tracing - <strong>New
Relic</strong>: Application performance monitoring with AI-powered
insights - <strong>Dynatrace</strong>: AI-powered observability platform
- <strong>Jaeger</strong>: Open-source distributed tracing system -
<strong>Zipkin</strong>: Distributed tracing system -
<strong>OpenTelemetry</strong>: Vendor-neutral observability
framework</p>
<p><strong>OpenTelemetry Example</strong>:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Python application instrumentation</span></span><br><span class="line"><span class="keyword">from</span> opentelemetry <span class="keyword">import</span> trace</span><br><span class="line"><span class="keyword">from</span> opentelemetry.sdk.trace <span class="keyword">import</span> TracerProvider</span><br><span class="line"><span class="keyword">from</span> opentelemetry.sdk.trace.export <span class="keyword">import</span> BatchSpanProcessor</span><br><span class="line"><span class="keyword">from</span> opentelemetry.exporter.jaeger.thrift <span class="keyword">import</span> JaegerExporter</span><br><span class="line"><span class="keyword">from</span> opentelemetry.instrumentation.requests <span class="keyword">import</span> RequestsInstrumentor</span><br><span class="line"><span class="keyword">from</span> opentelemetry.instrumentation.sqlalchemy <span class="keyword">import</span> SQLAlchemyInstrumentor</span><br><span class="line"></span><br><span class="line"><span class="comment"># Initialize tracing</span></span><br><span class="line">trace.set_tracer_provider(TracerProvider())</span><br><span class="line">tracer = trace.get_tracer(__name__)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Configure Jaeger exporter</span></span><br><span class="line">jaeger_exporter = JaegerExporter(</span><br><span class="line">    agent_host_name=<span class="string">&quot;jaeger-agent&quot;</span>,</span><br><span class="line">    agent_port=<span class="number">6831</span>,</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Add span processor</span></span><br><span class="line">span_processor = BatchSpanProcessor(jaeger_exporter)</span><br><span class="line">trace.get_tracer_provider().add_span_processor(span_processor)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Instrument libraries</span></span><br><span class="line">RequestsInstrumentor().instrument()</span><br><span class="line">SQLAlchemyInstrumentor().instrument()</span><br><span class="line"></span><br><span class="line"><span class="comment"># Example application code</span></span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/api/users/&lt;user_id&gt;&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_user</span>(<span class="params">user_id</span>):</span><br><span class="line">    <span class="keyword">with</span> tracer.start_as_current_span(<span class="string">&quot;get_user&quot;</span>) <span class="keyword">as</span> span:</span><br><span class="line">        span.set_attribute(<span class="string">&quot;user.id&quot;</span>, user_id)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># Database query (automatically traced)</span></span><br><span class="line">        user = db.session.query(User).filter_by(<span class="built_in">id</span>=user_id).first()</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># External API call (automatically traced)</span></span><br><span class="line">        response = requests.get(<span class="string">f&quot;https://api.example.com/profile/<span class="subst">&#123;user_id&#125;</span>&quot;</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> &#123;<span class="string">&quot;user&quot;</span>: user, <span class="string">&quot;profile&quot;</span>: response.json()&#125;</span><br></pre></td></tr></table></figure>
<h2 id="logging-and-analysis">Logging and Analysis</h2>
<p>Logs provide detailed records of system events, errors, and user
activities. Effective log management requires collection, storage,
indexing, and analysis capabilities.</p>
<h3 id="elk-stack-elasticsearch-logstash-and-kibana">ELK Stack:
Elasticsearch, Logstash, and Kibana</h3>
<p>The ELK stack is a popular open-source solution for log management: -
<strong>Elasticsearch</strong>: Distributed search and analytics engine
- <strong>Logstash</strong>: Log processing pipeline -
<strong>Kibana</strong>: Visualization and exploration interface</p>
<p><strong>Logstash Configuration Example</strong>:</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># logstash.conf</span></span><br><span class="line">input &#123;</span><br><span class="line">  <span class="comment"># File input for application logs</span></span><br><span class="line">  file &#123;</span><br><span class="line">    path =&gt; <span class="string">&quot;/var/log/app/*.log&quot;</span></span><br><span class="line">    start_position =&gt; <span class="string">&quot;beginning&quot;</span></span><br><span class="line">    sincedb_path =&gt; <span class="string">&quot;/dev/null&quot;</span></span><br><span class="line">    codec =&gt; <span class="string">&quot;json&quot;</span></span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="comment"># Beats input for system logs</span></span><br><span class="line">  beats &#123;</span><br><span class="line">    port =&gt; <span class="number">5044</span></span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="comment"># Syslog input</span></span><br><span class="line">  syslog &#123;</span><br><span class="line">    port =&gt; <span class="number">514</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">filter &#123;</span><br><span class="line">  <span class="comment"># Parse JSON logs</span></span><br><span class="line">  <span class="keyword">if</span> [type] == <span class="string">&quot;app&quot;</span> &#123;</span><br><span class="line">    json &#123;</span><br><span class="line">      source =&gt; <span class="string">&quot;message&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># Extract timestamp</span></span><br><span class="line">    date &#123;</span><br><span class="line">      match =&gt; [<span class="string">&quot;timestamp&quot;</span>, <span class="string">&quot;ISO8601&quot;</span>]</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># Add fields</span></span><br><span class="line">    mutate &#123;</span><br><span class="line">      add_field =&gt; &#123; <span class="string">&quot;environment&quot;</span> =&gt; <span class="string">&quot;production&quot;</span> &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># Parse error messages</span></span><br><span class="line">    <span class="keyword">if</span> [level] == <span class="string">&quot;ERROR&quot;</span> &#123;</span><br><span class="line">      grok &#123;</span><br><span class="line">        match =&gt; &#123; <span class="string">&quot;message&quot;</span> =&gt; <span class="string">&quot;%&#123;GREEDYDATA:error_message&#125;&quot;</span> &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="comment"># Parse system logs</span></span><br><span class="line">  <span class="keyword">if</span> [type] == <span class="string">&quot;syslog&quot;</span> &#123;</span><br><span class="line">    grok &#123;</span><br><span class="line">      match =&gt; &#123; <span class="string">&quot;message&quot;</span> =&gt; <span class="string">&quot;%&#123;SYSLOGLINE&#125;&quot;</span> &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="comment"># Remove sensitive data</span></span><br><span class="line">  mutate &#123;</span><br><span class="line">    remove_field =&gt; [<span class="string">&quot;password&quot;</span>, <span class="string">&quot;api_key&quot;</span>, <span class="string">&quot;token&quot;</span>]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">output &#123;</span><br><span class="line">  <span class="comment"># Send to Elasticsearch</span></span><br><span class="line">  elasticsearch &#123;</span><br><span class="line">    hosts =&gt; [<span class="string">&quot;elasticsearch:9200&quot;</span>]</span><br><span class="line">    index =&gt; <span class="string">&quot;logs-%&#123;+YYYY.MM.dd&#125;&quot;</span></span><br><span class="line">    template_name =&gt; <span class="string">&quot;logs&quot;</span></span><br><span class="line">    template =&gt; <span class="string">&quot;/etc/logstash/templates/logs-template.json&quot;</span></span><br><span class="line">    template_overwrite =&gt; <span class="literal">true</span></span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="comment"># Debug output (remove in production)</span></span><br><span class="line">  stdout &#123;</span><br><span class="line">    codec =&gt; rubydebug</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>Filebeat Configuration</strong> (lightweight log
shipper):</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># filebeat.yml</span></span><br><span class="line"><span class="attr">filebeat.inputs:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">type:</span> <span class="string">log</span></span><br><span class="line">    <span class="attr">enabled:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">paths:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">/var/log/app/*.log</span></span><br><span class="line">    <span class="attr">fields:</span></span><br><span class="line">      <span class="attr">log_type:</span> <span class="string">application</span></span><br><span class="line">      <span class="attr">environment:</span> <span class="string">production</span></span><br><span class="line">    <span class="attr">fields_under_root:</span> <span class="literal">false</span></span><br><span class="line">    <span class="attr">multiline.pattern:</span> <span class="string">&#x27;^\d&#123;4&#125;-\d&#123;2&#125;-\d&#123;2&#125;&#x27;</span></span><br><span class="line">    <span class="attr">multiline.negate:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">multiline.match:</span> <span class="string">after</span></span><br><span class="line">  </span><br><span class="line">  <span class="bullet">-</span> <span class="attr">type:</span> <span class="string">log</span></span><br><span class="line">    <span class="attr">enabled:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">paths:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">/var/log/nginx/access.log</span></span><br><span class="line">    <span class="attr">fields:</span></span><br><span class="line">      <span class="attr">log_type:</span> <span class="string">nginx_access</span></span><br><span class="line">    <span class="attr">json.keys_under_root:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">json.add_error_key:</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="attr">processors:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">add_host_metadata:</span></span><br><span class="line">      <span class="attr">when.not.contains.tags:</span> <span class="string">forwarded</span></span><br><span class="line">  </span><br><span class="line">  <span class="bullet">-</span> <span class="attr">add_docker_metadata:</span> <span class="string">~</span></span><br><span class="line"></span><br><span class="line"><span class="attr">output.logstash:</span></span><br><span class="line">  <span class="attr">hosts:</span> [<span class="string">&quot;logstash:5044&quot;</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># Optional: Send directly to Elasticsearch</span></span><br><span class="line"><span class="comment"># output.elasticsearch:</span></span><br><span class="line"><span class="comment">#   hosts: [&quot;elasticsearch:9200&quot;]</span></span><br><span class="line"><span class="comment">#   index: &quot;filebeat-%&#123;+yyyy.MM.dd&#125;&quot;</span></span><br></pre></td></tr></table></figure>
<p><strong>Kibana Query Examples</strong>:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"># Find all errors in the last hour</span><br><span class="line">level: ERROR AND @timestamp &gt;= now()-1h</span><br><span class="line"></span><br><span class="line"># Find slow requests (&gt;1 second)</span><br><span class="line">duration_ms &gt; 1000 AND @timestamp &gt;= now()-24h</span><br><span class="line"></span><br><span class="line"># Group errors by service</span><br><span class="line">level: ERROR | stats count() by service</span><br><span class="line"></span><br><span class="line"># Find authentication failures</span><br><span class="line">message: &quot;authentication failed&quot; OR message: &quot;login failed&quot;</span><br><span class="line"></span><br><span class="line"># Filter by user ID</span><br><span class="line">user_id: &quot;12345&quot; AND @timestamp &gt;= now()-7d</span><br></pre></td></tr></table></figure>
<h3 id="centralized-logging-best-practices">Centralized Logging Best
Practices</h3>
<p><strong>Structured Logging</strong>: Use JSON format for logs to
enable easier parsing and querying.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> logging</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">JSONFormatter</span>(logging.Formatter):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">format</span>(<span class="params">self, record</span>):</span><br><span class="line">        log_entry = &#123;</span><br><span class="line">            <span class="string">&quot;timestamp&quot;</span>: self.formatTime(record),</span><br><span class="line">            <span class="string">&quot;level&quot;</span>: record.levelname,</span><br><span class="line">            <span class="string">&quot;logger&quot;</span>: record.name,</span><br><span class="line">            <span class="string">&quot;message&quot;</span>: record.getMessage(),</span><br><span class="line">            <span class="string">&quot;module&quot;</span>: record.module,</span><br><span class="line">            <span class="string">&quot;function&quot;</span>: record.funcName,</span><br><span class="line">            <span class="string">&quot;line&quot;</span>: record.lineno,</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># Add extra fields</span></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">hasattr</span>(record, <span class="string">&quot;user_id&quot;</span>):</span><br><span class="line">            log_entry[<span class="string">&quot;user_id&quot;</span>] = record.user_id</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">hasattr</span>(record, <span class="string">&quot;request_id&quot;</span>):</span><br><span class="line">            log_entry[<span class="string">&quot;request_id&quot;</span>] = record.request_id</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">hasattr</span>(record, <span class="string">&quot;duration_ms&quot;</span>):</span><br><span class="line">            log_entry[<span class="string">&quot;duration_ms&quot;</span>] = record.duration_ms</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># Add exception info</span></span><br><span class="line">        <span class="keyword">if</span> record.exc_info:</span><br><span class="line">            log_entry[<span class="string">&quot;exception&quot;</span>] = self.formatException(record.exc_info)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> json.dumps(log_entry)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Usage</span></span><br><span class="line">logger = logging.getLogger(__name__)</span><br><span class="line">handler = logging.StreamHandler()</span><br><span class="line">handler.setFormatter(JSONFormatter())</span><br><span class="line">logger.addHandler(handler)</span><br><span class="line">logger.setLevel(logging.INFO)</span><br><span class="line"></span><br><span class="line">logger.info(<span class="string">&quot;User logged in&quot;</span>, extra=&#123;<span class="string">&quot;user_id&quot;</span>: <span class="string">&quot;12345&quot;</span>, <span class="string">&quot;ip&quot;</span>: <span class="string">&quot;192.168.1.1&quot;</span>&#125;)</span><br></pre></td></tr></table></figure>
<p><strong>Log Retention Policies</strong>: Define retention periods
based on compliance requirements and cost considerations. Hot storage
for recent logs, warm storage for older logs, cold storage for
archival.</p>
<p><strong>Log Sampling</strong>: For high-volume applications, sample
logs to reduce storage costs while maintaining visibility into errors
and important events.</p>
<p><strong>Security</strong>: Sanitize logs to remove sensitive
information (passwords, credit card numbers, PII). Use log encryption in
transit and at rest.</p>
<h2 id="automation-and-cicd">Automation and CI/CD</h2>
<p>Automation is the backbone of modern cloud operations, enabling
rapid, reliable deployments and reducing manual errors.</p>
<h3 id="cicd-pipeline-components">CI/CD Pipeline Components</h3>
<p><strong>Continuous Integration (CI)</strong>: Automatically build and
test code changes when developers commit to version control.</p>
<p><strong>Continuous Deployment (CD)</strong>: Automatically deploy
code changes to production after passing tests.</p>
<p><strong>Pipeline Stages</strong>: 1. <strong>Source</strong>: Code
repository (Git) 2. <strong>Build</strong>: Compile code, run unit tests
3. <strong>Test</strong>: Integration tests, security scans 4.
<strong>Deploy</strong>: Deploy to staging/production 5.
<strong>Verify</strong>: Smoke tests, monitoring checks 6.
<strong>Rollback</strong>: Automatic rollback on failure</p>
<h3 id="github-actions-example">GitHub Actions Example</h3>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># .github/workflows/deploy.yml</span></span><br><span class="line"><span class="attr">name:</span> <span class="string">Deploy</span> <span class="string">to</span> <span class="string">AWS</span></span><br><span class="line"></span><br><span class="line"><span class="attr">on:</span></span><br><span class="line">  <span class="attr">push:</span></span><br><span class="line">    <span class="attr">branches:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">main</span></span><br><span class="line">  <span class="attr">pull_request:</span></span><br><span class="line">    <span class="attr">branches:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">main</span></span><br><span class="line"></span><br><span class="line"><span class="attr">env:</span></span><br><span class="line">  <span class="attr">AWS_REGION:</span> <span class="string">us-east-1</span></span><br><span class="line">  <span class="attr">ECR_REPOSITORY:</span> <span class="string">my-app</span></span><br><span class="line">  <span class="attr">ECS_SERVICE:</span> <span class="string">my-app-service</span></span><br><span class="line">  <span class="attr">ECS_CLUSTER:</span> <span class="string">production</span></span><br><span class="line"></span><br><span class="line"><span class="attr">jobs:</span></span><br><span class="line">  <span class="attr">test:</span></span><br><span class="line">    <span class="attr">runs-on:</span> <span class="string">ubuntu-latest</span></span><br><span class="line">    <span class="attr">steps:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">uses:</span> <span class="string">actions/checkout@v3</span></span><br><span class="line">      </span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Set</span> <span class="string">up</span> <span class="string">Python</span></span><br><span class="line">        <span class="attr">uses:</span> <span class="string">actions/setup-python@v4</span></span><br><span class="line">        <span class="attr">with:</span></span><br><span class="line">          <span class="attr">python-version:</span> <span class="string">&#x27;3.11&#x27;</span></span><br><span class="line">      </span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Install</span> <span class="string">dependencies</span></span><br><span class="line">        <span class="attr">run:</span> <span class="string">|</span></span><br><span class="line"><span class="string">          pip install -r requirements.txt</span></span><br><span class="line"><span class="string">          pip install pytest pytest-cov</span></span><br><span class="line"><span class="string"></span>      </span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Run</span> <span class="string">tests</span></span><br><span class="line">        <span class="attr">run:</span> <span class="string">|</span></span><br><span class="line"><span class="string">          pytest --cov=app --cov-report=xml</span></span><br><span class="line"><span class="string"></span>      </span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Upload</span> <span class="string">coverage</span></span><br><span class="line">        <span class="attr">uses:</span> <span class="string">codecov/codecov-action@v3</span></span><br><span class="line">        <span class="attr">with:</span></span><br><span class="line">          <span class="attr">file:</span> <span class="string">./coverage.xml</span></span><br><span class="line">  </span><br><span class="line">  <span class="attr">security-scan:</span></span><br><span class="line">    <span class="attr">runs-on:</span> <span class="string">ubuntu-latest</span></span><br><span class="line">    <span class="attr">steps:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">uses:</span> <span class="string">actions/checkout@v3</span></span><br><span class="line">      </span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Run</span> <span class="string">Trivy</span> <span class="string">vulnerability</span> <span class="string">scanner</span></span><br><span class="line">        <span class="attr">uses:</span> <span class="string">aquasecurity/trivy-action@master</span></span><br><span class="line">        <span class="attr">with:</span></span><br><span class="line">          <span class="attr">scan-type:</span> <span class="string">&#x27;fs&#x27;</span></span><br><span class="line">          <span class="attr">scan-ref:</span> <span class="string">&#x27;.&#x27;</span></span><br><span class="line">          <span class="attr">format:</span> <span class="string">&#x27;sarif&#x27;</span></span><br><span class="line">          <span class="attr">output:</span> <span class="string">&#x27;trivy-results.sarif&#x27;</span></span><br><span class="line">      </span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Upload</span> <span class="string">Trivy</span> <span class="string">results</span></span><br><span class="line">        <span class="attr">uses:</span> <span class="string">github/codeql-action/upload-sarif@v2</span></span><br><span class="line">        <span class="attr">with:</span></span><br><span class="line">          <span class="attr">sarif_file:</span> <span class="string">&#x27;trivy-results.sarif&#x27;</span></span><br><span class="line">  </span><br><span class="line">  <span class="attr">build-and-deploy:</span></span><br><span class="line">    <span class="attr">needs:</span> [<span class="string">test</span>, <span class="string">security-scan</span>]</span><br><span class="line">    <span class="attr">runs-on:</span> <span class="string">ubuntu-latest</span></span><br><span class="line">    <span class="attr">if:</span> <span class="string">github.ref</span> <span class="string">==</span> <span class="string">&#x27;refs/heads/main&#x27;</span></span><br><span class="line">    </span><br><span class="line">    <span class="attr">steps:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">uses:</span> <span class="string">actions/checkout@v3</span></span><br><span class="line">      </span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Configure</span> <span class="string">AWS</span> <span class="string">credentials</span></span><br><span class="line">        <span class="attr">uses:</span> <span class="string">aws-actions/configure-aws-credentials@v2</span></span><br><span class="line">        <span class="attr">with:</span></span><br><span class="line">          <span class="attr">aws-access-key-id:</span> <span class="string">$&#123;&#123;</span> <span class="string">secrets.AWS_ACCESS_KEY_ID</span> <span class="string">&#125;&#125;</span></span><br><span class="line">          <span class="attr">aws-secret-access-key:</span> <span class="string">$&#123;&#123;</span> <span class="string">secrets.AWS_SECRET_ACCESS_KEY</span> <span class="string">&#125;&#125;</span></span><br><span class="line">          <span class="attr">aws-region:</span> <span class="string">$&#123;&#123;</span> <span class="string">env.AWS_REGION</span> <span class="string">&#125;&#125;</span></span><br><span class="line">      </span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Login</span> <span class="string">to</span> <span class="string">Amazon</span> <span class="string">ECR</span></span><br><span class="line">        <span class="attr">id:</span> <span class="string">login-ecr</span></span><br><span class="line">        <span class="attr">uses:</span> <span class="string">aws-actions/amazon-ecr-login@v1</span></span><br><span class="line">      </span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Build,</span> <span class="string">tag,</span> <span class="string">and</span> <span class="string">push</span> <span class="string">image</span></span><br><span class="line">        <span class="attr">env:</span></span><br><span class="line">          <span class="attr">ECR_REGISTRY:</span> <span class="string">$&#123;&#123;</span> <span class="string">steps.login-ecr.outputs.registry</span> <span class="string">&#125;&#125;</span></span><br><span class="line">          <span class="attr">IMAGE_TAG:</span> <span class="string">$&#123;&#123;</span> <span class="string">github.sha</span> <span class="string">&#125;&#125;</span></span><br><span class="line">        <span class="attr">run:</span> <span class="string">|</span></span><br><span class="line"><span class="string">          docker build -t $ECR_REGISTRY/$ECR_REPOSITORY:$IMAGE_TAG .</span></span><br><span class="line"><span class="string">          docker push $ECR_REGISTRY/$ECR_REPOSITORY:$IMAGE_TAG</span></span><br><span class="line"><span class="string">          docker tag $ECR_REGISTRY/$ECR_REPOSITORY:$IMAGE_TAG $ECR_REGISTRY/$ECR_REPOSITORY:latest</span></span><br><span class="line"><span class="string">          docker push $ECR_REGISTRY/$ECR_REPOSITORY:latest</span></span><br><span class="line"><span class="string"></span>      </span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Deploy</span> <span class="string">to</span> <span class="string">ECS</span></span><br><span class="line">        <span class="attr">uses:</span> <span class="string">aws-actions/amazon-ecs-deploy-task-definition@v1</span></span><br><span class="line">        <span class="attr">with:</span></span><br><span class="line">          <span class="attr">task-definition:</span> <span class="string">task-definition.json</span></span><br><span class="line">          <span class="attr">service:</span> <span class="string">$&#123;&#123;</span> <span class="string">env.ECS_SERVICE</span> <span class="string">&#125;&#125;</span></span><br><span class="line">          <span class="attr">cluster:</span> <span class="string">$&#123;&#123;</span> <span class="string">env.ECS_CLUSTER</span> <span class="string">&#125;&#125;</span></span><br><span class="line">          <span class="attr">wait-for-service-stability:</span> <span class="literal">true</span></span><br><span class="line">      </span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Run</span> <span class="string">smoke</span> <span class="string">tests</span></span><br><span class="line">        <span class="attr">run:</span> <span class="string">|</span></span><br><span class="line"><span class="string">          sleep 30</span></span><br><span class="line"><span class="string">          curl -f https://api.example.com/health || exit 1</span></span><br><span class="line"><span class="string"></span>      </span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Notify</span> <span class="string">on</span> <span class="string">failure</span></span><br><span class="line">        <span class="attr">if:</span> <span class="string">failure()</span></span><br><span class="line">        <span class="attr">uses:</span> <span class="string">8398a7/action-slack@v3</span></span><br><span class="line">        <span class="attr">with:</span></span><br><span class="line">          <span class="attr">status:</span> <span class="string">$&#123;&#123;</span> <span class="string">job.status</span> <span class="string">&#125;&#125;</span></span><br><span class="line">          <span class="attr">text:</span> <span class="string">&#x27;Deployment failed!&#x27;</span></span><br><span class="line">          <span class="attr">webhook_url:</span> <span class="string">$&#123;&#123;</span> <span class="string">secrets.SLACK_WEBHOOK</span> <span class="string">&#125;&#125;</span></span><br></pre></td></tr></table></figure>
<h3 id="gitlab-cicd-example">GitLab CI/CD Example</h3>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># .gitlab-ci.yml</span></span><br><span class="line"><span class="attr">stages:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">build</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">test</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">security</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">deploy</span></span><br><span class="line"></span><br><span class="line"><span class="attr">variables:</span></span><br><span class="line">  <span class="attr">DOCKER_DRIVER:</span> <span class="string">overlay2</span></span><br><span class="line">  <span class="attr">DOCKER_TLS_CERTDIR:</span> <span class="string">&quot;/certs&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="attr">build:</span></span><br><span class="line">  <span class="attr">stage:</span> <span class="string">build</span></span><br><span class="line">  <span class="attr">image:</span> <span class="string">docker:latest</span></span><br><span class="line">  <span class="attr">services:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">docker:dind</span></span><br><span class="line">  <span class="attr">script:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">docker</span> <span class="string">build</span> <span class="string">-t</span> <span class="string">$CI_REGISTRY_IMAGE:$CI_COMMIT_SHA</span> <span class="string">.</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">docker</span> <span class="string">build</span> <span class="string">-t</span> <span class="string">$CI_REGISTRY_IMAGE:latest</span> <span class="string">.</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">docker</span> <span class="string">login</span> <span class="string">-u</span> <span class="string">$CI_REGISTRY_USER</span> <span class="string">-p</span> <span class="string">$CI_REGISTRY_PASSWORD</span> <span class="string">$CI_REGISTRY</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">docker</span> <span class="string">push</span> <span class="string">$CI_REGISTRY_IMAGE:$CI_COMMIT_SHA</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">docker</span> <span class="string">push</span> <span class="string">$CI_REGISTRY_IMAGE:latest</span></span><br><span class="line">  <span class="attr">only:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">main</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">develop</span></span><br><span class="line"></span><br><span class="line"><span class="attr">test:</span></span><br><span class="line">  <span class="attr">stage:</span> <span class="string">test</span></span><br><span class="line">  <span class="attr">image:</span> <span class="string">python:3.11</span></span><br><span class="line">  <span class="attr">script:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">pip</span> <span class="string">install</span> <span class="string">-r</span> <span class="string">requirements.txt</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">pip</span> <span class="string">install</span> <span class="string">pytest</span> <span class="string">pytest-cov</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">pytest</span> <span class="string">--cov=app</span> <span class="string">--cov-report=html</span> <span class="string">--cov-report=term</span></span><br><span class="line">  <span class="attr">coverage:</span> <span class="string">&#x27;/TOTAL.*\s+(\d+%)$/&#x27;</span></span><br><span class="line">  <span class="attr">artifacts:</span></span><br><span class="line">    <span class="attr">reports:</span></span><br><span class="line">      <span class="attr">coverage_report:</span></span><br><span class="line">        <span class="attr">coverage_format:</span> <span class="string">cobertura</span></span><br><span class="line">        <span class="attr">path:</span> <span class="string">coverage.xml</span></span><br><span class="line">    <span class="attr">paths:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">htmlcov/</span></span><br><span class="line"></span><br><span class="line"><span class="attr">security:</span></span><br><span class="line">  <span class="attr">stage:</span> <span class="string">security</span></span><br><span class="line">  <span class="attr">image:</span> <span class="string">aquasec/trivy:latest</span></span><br><span class="line">  <span class="attr">script:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">trivy</span> <span class="string">image</span> <span class="string">--exit-code</span> <span class="number">0</span> <span class="string">--severity</span> <span class="string">HIGH,CRITICAL</span> <span class="string">$CI_REGISTRY_IMAGE:$CI_COMMIT_SHA</span></span><br><span class="line"></span><br><span class="line"><span class="attr">deploy-staging:</span></span><br><span class="line">  <span class="attr">stage:</span> <span class="string">deploy</span></span><br><span class="line">  <span class="attr">image:</span> <span class="string">bitnami/kubectl:latest</span></span><br><span class="line">  <span class="attr">script:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">kubectl</span> <span class="string">set</span> <span class="string">image</span> <span class="string">deployment/app</span> <span class="string">app=$CI_REGISTRY_IMAGE:$CI_COMMIT_SHA</span> <span class="string">-n</span> <span class="string">staging</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">kubectl</span> <span class="string">rollout</span> <span class="string">status</span> <span class="string">deployment/app</span> <span class="string">-n</span> <span class="string">staging</span></span><br><span class="line">  <span class="attr">environment:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">staging</span></span><br><span class="line">    <span class="attr">url:</span> <span class="string">https://staging.example.com</span></span><br><span class="line">  <span class="attr">only:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">develop</span></span><br><span class="line"></span><br><span class="line"><span class="attr">deploy-production:</span></span><br><span class="line">  <span class="attr">stage:</span> <span class="string">deploy</span></span><br><span class="line">  <span class="attr">image:</span> <span class="string">bitnami/kubectl:latest</span></span><br><span class="line">  <span class="attr">script:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">kubectl</span> <span class="string">set</span> <span class="string">image</span> <span class="string">deployment/app</span> <span class="string">app=$CI_REGISTRY_IMAGE:$CI_COMMIT_SHA</span> <span class="string">-n</span> <span class="string">production</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">kubectl</span> <span class="string">rollout</span> <span class="string">status</span> <span class="string">deployment/app</span> <span class="string">-n</span> <span class="string">production</span></span><br><span class="line">  <span class="attr">environment:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">production</span></span><br><span class="line">    <span class="attr">url:</span> <span class="string">https://api.example.com</span></span><br><span class="line">  <span class="attr">when:</span> <span class="string">manual</span></span><br><span class="line">  <span class="attr">only:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">main</span></span><br></pre></td></tr></table></figure>
<h2 id="auto-scaling-strategies">Auto-Scaling Strategies</h2>
<p>Auto-scaling automatically adjusts compute resources based on demand,
ensuring optimal performance while minimizing costs.</p>
<h3 id="horizontal-vs-vertical-scaling">Horizontal vs Vertical
Scaling</h3>
<p><strong>Horizontal Scaling (Scale Out/In)</strong>: Add or remove
instances. Better for cloud environments, provides high
availability.</p>
<p><strong>Vertical Scaling (Scale Up/Down)</strong>: Increase or
decrease instance size. Simpler but has limits and requires
downtime.</p>
<h3 id="aws-auto-scaling-configuration">AWS Auto Scaling
Configuration</h3>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Auto Scaling Group with Launch Template</span></span><br><span class="line"><span class="attr">Resources:</span></span><br><span class="line">  <span class="attr">LaunchTemplate:</span></span><br><span class="line">    <span class="attr">Type:</span> <span class="string">AWS::EC2::LaunchTemplate</span></span><br><span class="line">    <span class="attr">Properties:</span></span><br><span class="line">      <span class="attr">LaunchTemplateName:</span> <span class="string">app-launch-template</span></span><br><span class="line">      <span class="attr">LaunchTemplateData:</span></span><br><span class="line">        <span class="attr">ImageId:</span> <span class="string">ami-0c55b159cbfafe1f0</span></span><br><span class="line">        <span class="attr">InstanceType:</span> <span class="string">t3.medium</span></span><br><span class="line">        <span class="attr">SecurityGroupIds:</span></span><br><span class="line">          <span class="bullet">-</span> <span class="type">!Ref</span> <span class="string">SecurityGroup</span></span><br><span class="line">        <span class="attr">UserData:</span></span><br><span class="line">          <span class="attr">Fn::Base64:</span> <span class="type">!Sub</span> <span class="string">|</span></span><br><span class="line"><span class="string">            #!/bin/bash</span></span><br><span class="line"><span class="string">            yum update -y</span></span><br><span class="line"><span class="string">            yum install -y docker</span></span><br><span class="line"><span class="string">            systemctl start docker</span></span><br><span class="line"><span class="string">            systemctl enable docker</span></span><br><span class="line"><span class="string">            docker run -d -p 80:8080 $&#123;ECR_REPO&#125;:latest</span></span><br><span class="line"><span class="string"></span>  </span><br><span class="line">  <span class="attr">AutoScalingGroup:</span></span><br><span class="line">    <span class="attr">Type:</span> <span class="string">AWS::AutoScaling::AutoScalingGroup</span></span><br><span class="line">    <span class="attr">Properties:</span></span><br><span class="line">      <span class="attr">VPCZoneIdentifier:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="type">!Ref</span> <span class="string">Subnet1</span></span><br><span class="line">        <span class="bullet">-</span> <span class="type">!Ref</span> <span class="string">Subnet2</span></span><br><span class="line">      <span class="attr">LaunchTemplate:</span></span><br><span class="line">        <span class="attr">LaunchTemplateId:</span> <span class="type">!Ref</span> <span class="string">LaunchTemplate</span></span><br><span class="line">        <span class="attr">Version:</span> <span class="type">!GetAtt</span> <span class="string">LaunchTemplate.LatestVersionNumber</span></span><br><span class="line">      <span class="attr">MinSize:</span> <span class="number">2</span></span><br><span class="line">      <span class="attr">MaxSize:</span> <span class="number">10</span></span><br><span class="line">      <span class="attr">DesiredCapacity:</span> <span class="number">2</span></span><br><span class="line">      <span class="attr">HealthCheckType:</span> <span class="string">ELB</span></span><br><span class="line">      <span class="attr">HealthCheckGracePeriod:</span> <span class="number">300</span></span><br><span class="line">      <span class="attr">TargetGroupARNs:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="type">!Ref</span> <span class="string">TargetGroup</span></span><br><span class="line">      <span class="attr">Tags:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">Key:</span> <span class="string">Name</span></span><br><span class="line">          <span class="attr">Value:</span> <span class="string">app-instance</span></span><br><span class="line">          <span class="attr">PropagateAtLaunch:</span> <span class="literal">true</span></span><br><span class="line">  </span><br><span class="line">  <span class="comment"># Scale-up policy (CPU &gt; 70%)</span></span><br><span class="line">  <span class="attr">ScaleUpPolicy:</span></span><br><span class="line">    <span class="attr">Type:</span> <span class="string">AWS::AutoScaling::ScalingPolicy</span></span><br><span class="line">    <span class="attr">Properties:</span></span><br><span class="line">      <span class="attr">AdjustmentType:</span> <span class="string">ChangeInCapacity</span></span><br><span class="line">      <span class="attr">AutoScalingGroupName:</span> <span class="type">!Ref</span> <span class="string">AutoScalingGroup</span></span><br><span class="line">      <span class="attr">Cooldown:</span> <span class="number">300</span></span><br><span class="line">      <span class="attr">ScalingAdjustment:</span> <span class="number">1</span></span><br><span class="line">  </span><br><span class="line">  <span class="comment"># Scale-down policy (CPU &lt; 30%)</span></span><br><span class="line">  <span class="attr">ScaleDownPolicy:</span></span><br><span class="line">    <span class="attr">Type:</span> <span class="string">AWS::AutoScaling::ScalingPolicy</span></span><br><span class="line">    <span class="attr">Properties:</span></span><br><span class="line">      <span class="attr">AdjustmentType:</span> <span class="string">ChangeInCapacity</span></span><br><span class="line">      <span class="attr">AutoScalingGroupName:</span> <span class="type">!Ref</span> <span class="string">AutoScalingGroup</span></span><br><span class="line">      <span class="attr">Cooldown:</span> <span class="number">300</span></span><br><span class="line">      <span class="attr">ScalingAdjustment:</span> <span class="number">-1</span></span><br><span class="line">  </span><br><span class="line">  <span class="attr">CPUAlarmHigh:</span></span><br><span class="line">    <span class="attr">Type:</span> <span class="string">AWS::CloudWatch::Alarm</span></span><br><span class="line">    <span class="attr">Properties:</span></span><br><span class="line">      <span class="attr">AlarmName:</span> <span class="string">HighCPU</span></span><br><span class="line">      <span class="attr">AlarmDescription:</span> <span class="string">Alarm</span> <span class="string">when</span> <span class="string">CPU</span> <span class="string">exceeds</span> <span class="number">70</span><span class="string">%</span></span><br><span class="line">      <span class="attr">MetricName:</span> <span class="string">CPUUtilization</span></span><br><span class="line">      <span class="attr">Namespace:</span> <span class="string">AWS/EC2</span></span><br><span class="line">      <span class="attr">Statistic:</span> <span class="string">Average</span></span><br><span class="line">      <span class="attr">Period:</span> <span class="number">300</span></span><br><span class="line">      <span class="attr">EvaluationPeriods:</span> <span class="number">2</span></span><br><span class="line">      <span class="attr">Threshold:</span> <span class="number">70</span></span><br><span class="line">      <span class="attr">ComparisonOperator:</span> <span class="string">GreaterThanThreshold</span></span><br><span class="line">      <span class="attr">Dimensions:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">Name:</span> <span class="string">AutoScalingGroupName</span></span><br><span class="line">          <span class="attr">Value:</span> <span class="type">!Ref</span> <span class="string">AutoScalingGroup</span></span><br><span class="line">      <span class="attr">AlarmActions:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="type">!Ref</span> <span class="string">ScaleUpPolicy</span></span><br><span class="line">  </span><br><span class="line">  <span class="attr">CPUAlarmLow:</span></span><br><span class="line">    <span class="attr">Type:</span> <span class="string">AWS::CloudWatch::Alarm</span></span><br><span class="line">    <span class="attr">Properties:</span></span><br><span class="line">      <span class="attr">AlarmName:</span> <span class="string">LowCPU</span></span><br><span class="line">      <span class="attr">AlarmDescription:</span> <span class="string">Alarm</span> <span class="string">when</span> <span class="string">CPU</span> <span class="string">drops</span> <span class="string">below</span> <span class="number">30</span><span class="string">%</span></span><br><span class="line">      <span class="attr">MetricName:</span> <span class="string">CPUUtilization</span></span><br><span class="line">      <span class="attr">Namespace:</span> <span class="string">AWS/EC2</span></span><br><span class="line">      <span class="attr">Statistic:</span> <span class="string">Average</span></span><br><span class="line">      <span class="attr">Period:</span> <span class="number">300</span></span><br><span class="line">      <span class="attr">EvaluationPeriods:</span> <span class="number">2</span></span><br><span class="line">      <span class="attr">Threshold:</span> <span class="number">30</span></span><br><span class="line">      <span class="attr">ComparisonOperator:</span> <span class="string">LessThanThreshold</span></span><br><span class="line">      <span class="attr">Dimensions:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">Name:</span> <span class="string">AutoScalingGroupName</span></span><br><span class="line">          <span class="attr">Value:</span> <span class="type">!Ref</span> <span class="string">AutoScalingGroup</span></span><br><span class="line">      <span class="attr">AlarmActions:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="type">!Ref</span> <span class="string">ScaleDownPolicy</span></span><br></pre></td></tr></table></figure>
<h3 id="kubernetes-horizontal-pod-autoscaler">Kubernetes Horizontal Pod
Autoscaler</h3>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">autoscaling/v2</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">HorizontalPodAutoscaler</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">app-hpa</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">scaleTargetRef:</span></span><br><span class="line">    <span class="attr">apiVersion:</span> <span class="string">apps/v1</span></span><br><span class="line">    <span class="attr">kind:</span> <span class="string">Deployment</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">app</span></span><br><span class="line">  <span class="attr">minReplicas:</span> <span class="number">2</span></span><br><span class="line">  <span class="attr">maxReplicas:</span> <span class="number">10</span></span><br><span class="line">  <span class="attr">metrics:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">type:</span> <span class="string">Resource</span></span><br><span class="line">      <span class="attr">resource:</span></span><br><span class="line">        <span class="attr">name:</span> <span class="string">cpu</span></span><br><span class="line">        <span class="attr">target:</span></span><br><span class="line">          <span class="attr">type:</span> <span class="string">Utilization</span></span><br><span class="line">          <span class="attr">averageUtilization:</span> <span class="number">70</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">type:</span> <span class="string">Resource</span></span><br><span class="line">      <span class="attr">resource:</span></span><br><span class="line">        <span class="attr">name:</span> <span class="string">memory</span></span><br><span class="line">        <span class="attr">target:</span></span><br><span class="line">          <span class="attr">type:</span> <span class="string">Utilization</span></span><br><span class="line">          <span class="attr">averageUtilization:</span> <span class="number">80</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">type:</span> <span class="string">Pods</span></span><br><span class="line">      <span class="attr">pods:</span></span><br><span class="line">        <span class="attr">metric:</span></span><br><span class="line">          <span class="attr">name:</span> <span class="string">http_requests_per_second</span></span><br><span class="line">        <span class="attr">target:</span></span><br><span class="line">          <span class="attr">type:</span> <span class="string">AverageValue</span></span><br><span class="line">          <span class="attr">averageValue:</span> <span class="string">&quot;100&quot;</span></span><br><span class="line">  <span class="attr">behavior:</span></span><br><span class="line">    <span class="attr">scaleDown:</span></span><br><span class="line">      <span class="attr">stabilizationWindowSeconds:</span> <span class="number">300</span></span><br><span class="line">      <span class="attr">policies:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">type:</span> <span class="string">Percent</span></span><br><span class="line">          <span class="attr">value:</span> <span class="number">50</span></span><br><span class="line">          <span class="attr">periodSeconds:</span> <span class="number">60</span></span><br><span class="line">    <span class="attr">scaleUp:</span></span><br><span class="line">      <span class="attr">stabilizationWindowSeconds:</span> <span class="number">0</span></span><br><span class="line">      <span class="attr">policies:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">type:</span> <span class="string">Percent</span></span><br><span class="line">          <span class="attr">value:</span> <span class="number">100</span></span><br><span class="line">          <span class="attr">periodSeconds:</span> <span class="number">15</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">type:</span> <span class="string">Pods</span></span><br><span class="line">          <span class="attr">value:</span> <span class="number">2</span></span><br><span class="line">          <span class="attr">periodSeconds:</span> <span class="number">15</span></span><br><span class="line">      <span class="attr">selectPolicy:</span> <span class="string">Max</span></span><br></pre></td></tr></table></figure>
<h3 id="auto-scaling-best-practices">Auto-Scaling Best Practices</h3>
<p><strong>Predictive Scaling</strong>: Use machine learning to predict
traffic patterns and scale proactively.</p>
<p><strong>Multiple Metrics</strong>: Don't rely solely on CPU. Consider
memory, request rate, queue depth, and custom metrics.</p>
<p><strong>Cooldown Periods</strong>: Prevent rapid scaling oscillations
with appropriate cooldown periods.</p>
<p><strong>Gradual Scaling</strong>: Scale up quickly but scale down
gradually to handle traffic spikes.</p>
<p><strong>Health Checks</strong>: Ensure new instances are healthy
before routing traffic to them.</p>
<p><strong>Cost Optimization</strong>: Use spot instances for
non-critical workloads, reserved instances for baseline capacity.</p>
<h2 id="cost-optimization">Cost Optimization</h2>
<p>Cloud costs can quickly spiral out of control without proper
management. Effective cost optimization requires continuous monitoring,
right-sizing, and strategic resource usage.</p>
<h3 id="cost-optimization-strategies">Cost Optimization Strategies</h3>
<p><strong>Right-Sizing</strong>: Match instance types to actual
workload requirements. Use cloud provider tools to analyze utilization
and recommend sizes.</p>
<p><strong>Reserved Instances</strong>: Commit to 1-3 year terms for
predictable workloads to save 30-70% compared to on-demand pricing.</p>
<p><strong>Spot Instances</strong>: Use spot instances for
fault-tolerant, flexible workloads. Can save up to 90% compared to
on-demand.</p>
<p><strong>Auto-Shutdown</strong>: Automatically stop non-production
resources during off-hours.</p>
<p><strong>Storage Optimization</strong>: Use appropriate storage
classes (hot, warm, cold, archive) based on access patterns.</p>
<p><strong>Data Transfer Optimization</strong>: Minimize data transfer
costs by using CDNs, compressing data, and optimizing API calls.</p>
<p><strong>Tagging and Cost Allocation</strong>: Tag resources to track
costs by project, team, or environment.</p>
<h3 id="aws-cost-optimization-script">AWS Cost Optimization Script</h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> boto3</span><br><span class="line"><span class="keyword">from</span> datetime <span class="keyword">import</span> datetime, timedelta</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">analyze_idle_instances</span>():</span><br><span class="line">    <span class="string">&quot;&quot;&quot;Identify EC2 instances with low CPU utilization&quot;&quot;&quot;</span></span><br><span class="line">    ec2 = boto3.client(<span class="string">&#x27;ec2&#x27;</span>)</span><br><span class="line">    cloudwatch = boto3.client(<span class="string">&#x27;cloudwatch&#x27;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># Get all running instances</span></span><br><span class="line">    response = ec2.describe_instances(</span><br><span class="line">        Filters=[&#123;<span class="string">&#x27;Name&#x27;</span>: <span class="string">&#x27;instance-state-name&#x27;</span>, <span class="string">&#x27;Values&#x27;</span>: [<span class="string">&#x27;running&#x27;</span>]&#125;]</span><br><span class="line">    )</span><br><span class="line">    </span><br><span class="line">    idle_instances = []</span><br><span class="line">    end_time = datetime.utcnow()</span><br><span class="line">    start_time = end_time - timedelta(days=<span class="number">7</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> reservation <span class="keyword">in</span> response[<span class="string">&#x27;Reservations&#x27;</span>]:</span><br><span class="line">        <span class="keyword">for</span> instance <span class="keyword">in</span> reservation[<span class="string">&#x27;Instances&#x27;</span>]:</span><br><span class="line">            instance_id = instance[<span class="string">&#x27;InstanceId&#x27;</span>]</span><br><span class="line">            </span><br><span class="line">            <span class="comment"># Get CPU utilization for the last 7 days</span></span><br><span class="line">            metrics = cloudwatch.get_metric_statistics(</span><br><span class="line">                Namespace=<span class="string">&#x27;AWS/EC2&#x27;</span>,</span><br><span class="line">                MetricName=<span class="string">&#x27;CPUUtilization&#x27;</span>,</span><br><span class="line">                Dimensions=[&#123;<span class="string">&#x27;Name&#x27;</span>: <span class="string">&#x27;InstanceId&#x27;</span>, <span class="string">&#x27;Value&#x27;</span>: instance_id&#125;],</span><br><span class="line">                StartTime=start_time,</span><br><span class="line">                EndTime=end_time,</span><br><span class="line">                Period=<span class="number">3600</span>,</span><br><span class="line">                Statistics=[<span class="string">&#x27;Average&#x27;</span>]</span><br><span class="line">            )</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">if</span> metrics[<span class="string">&#x27;Datapoints&#x27;</span>]:</span><br><span class="line">                avg_cpu = <span class="built_in">sum</span>([d[<span class="string">&#x27;Average&#x27;</span>] <span class="keyword">for</span> d <span class="keyword">in</span> metrics[<span class="string">&#x27;Datapoints&#x27;</span>]]) / <span class="built_in">len</span>(metrics[<span class="string">&#x27;Datapoints&#x27;</span>])</span><br><span class="line">                </span><br><span class="line">                <span class="keyword">if</span> avg_cpu &lt; <span class="number">10</span>:  <span class="comment"># Less than 10% average CPU</span></span><br><span class="line">                    idle_instances.append(&#123;</span><br><span class="line">                        <span class="string">&#x27;instance_id&#x27;</span>: instance_id,</span><br><span class="line">                        <span class="string">&#x27;instance_type&#x27;</span>: instance[<span class="string">&#x27;InstanceType&#x27;</span>],</span><br><span class="line">                        <span class="string">&#x27;avg_cpu&#x27;</span>: avg_cpu,</span><br><span class="line">                        <span class="string">&#x27;tags&#x27;</span>: instance.get(<span class="string">&#x27;Tags&#x27;</span>, [])</span><br><span class="line">                    &#125;)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> idle_instances</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">generate_cost_report</span>():</span><br><span class="line">    <span class="string">&quot;&quot;&quot;Generate cost optimization report&quot;&quot;&quot;</span></span><br><span class="line">    cost_explorer = boto3.client(<span class="string">&#x27;ce&#x27;</span>)</span><br><span class="line">    </span><br><span class="line">    end_date = datetime.utcnow().strftime(<span class="string">&#x27;%Y-%m-%d&#x27;</span>)</span><br><span class="line">    start_date = (datetime.utcnow() - timedelta(days=<span class="number">30</span>)).strftime(<span class="string">&#x27;%Y-%m-%d&#x27;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># Get costs by service</span></span><br><span class="line">    response = cost_explorer.get_cost_and_usage(</span><br><span class="line">        TimePeriod=&#123;<span class="string">&#x27;Start&#x27;</span>: start_date, <span class="string">&#x27;End&#x27;</span>: end_date&#125;,</span><br><span class="line">        Granularity=<span class="string">&#x27;MONTHLY&#x27;</span>,</span><br><span class="line">        Metrics=[<span class="string">&#x27;BlendedCost&#x27;</span>, <span class="string">&#x27;UnblendedCost&#x27;</span>],</span><br><span class="line">        GroupBy=[&#123;<span class="string">&#x27;Type&#x27;</span>: <span class="string">&#x27;DIMENSION&#x27;</span>, <span class="string">&#x27;Key&#x27;</span>: <span class="string">&#x27;SERVICE&#x27;</span>&#125;]</span><br><span class="line">    )</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Cost by Service (Last 30 days):&quot;</span>)</span><br><span class="line">    <span class="keyword">for</span> result <span class="keyword">in</span> response[<span class="string">&#x27;ResultsByTime&#x27;</span>]:</span><br><span class="line">        <span class="keyword">for</span> group <span class="keyword">in</span> result[<span class="string">&#x27;Groups&#x27;</span>]:</span><br><span class="line">            service = group[<span class="string">&#x27;Keys&#x27;</span>][<span class="number">0</span>]</span><br><span class="line">            cost = <span class="built_in">float</span>(group[<span class="string">&#x27;Metrics&#x27;</span>][<span class="string">&#x27;BlendedCost&#x27;</span>][<span class="string">&#x27;Amount&#x27;</span>])</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;  <span class="subst">&#123;service&#125;</span>: $<span class="subst">&#123;cost:<span class="number">.2</span>f&#125;</span>&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># Get costs by instance type</span></span><br><span class="line">    response = cost_explorer.get_cost_and_usage(</span><br><span class="line">        TimePeriod=&#123;<span class="string">&#x27;Start&#x27;</span>: start_date, <span class="string">&#x27;End&#x27;</span>: end_date&#125;,</span><br><span class="line">        Granularity=<span class="string">&#x27;MONTHLY&#x27;</span>,</span><br><span class="line">        Metrics=[<span class="string">&#x27;BlendedCost&#x27;</span>],</span><br><span class="line">        GroupBy=[&#123;<span class="string">&#x27;Type&#x27;</span>: <span class="string">&#x27;DIMENSION&#x27;</span>, <span class="string">&#x27;Key&#x27;</span>: <span class="string">&#x27;INSTANCE_TYPE&#x27;</span>&#125;]</span><br><span class="line">    )</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;\nCost by Instance Type:&quot;</span>)</span><br><span class="line">    <span class="keyword">for</span> result <span class="keyword">in</span> response[<span class="string">&#x27;ResultsByTime&#x27;</span>]:</span><br><span class="line">        <span class="keyword">for</span> group <span class="keyword">in</span> result[<span class="string">&#x27;Groups&#x27;</span>]:</span><br><span class="line">            instance_type = group[<span class="string">&#x27;Keys&#x27;</span>][<span class="number">0</span>] <span class="keyword">if</span> group[<span class="string">&#x27;Keys&#x27;</span>][<span class="number">0</span>] <span class="keyword">else</span> <span class="string">&#x27;N/A&#x27;</span></span><br><span class="line">            cost = <span class="built_in">float</span>(group[<span class="string">&#x27;Metrics&#x27;</span>][<span class="string">&#x27;BlendedCost&#x27;</span>][<span class="string">&#x27;Amount&#x27;</span>])</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;  <span class="subst">&#123;instance_type&#125;</span>: $<span class="subst">&#123;cost:<span class="number">.2</span>f&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Analyzing idle instances...&quot;</span>)</span><br><span class="line">    idle = analyze_idle_instances()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;\nFound <span class="subst">&#123;<span class="built_in">len</span>(idle)&#125;</span> potentially idle instances:&quot;</span>)</span><br><span class="line">    <span class="keyword">for</span> inst <span class="keyword">in</span> idle:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;  <span class="subst">&#123;inst[<span class="string">&#x27;instance_id&#x27;</span>]&#125;</span>: <span class="subst">&#123;inst[<span class="string">&#x27;instance_type&#x27;</span>]&#125;</span> (Avg CPU: <span class="subst">&#123;inst[<span class="string">&#x27;avg_cpu&#x27;</span>]:<span class="number">.2</span>f&#125;</span>%)&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;\n&quot;</span> + <span class="string">&quot;=&quot;</span>*<span class="number">50</span>)</span><br><span class="line">    generate_cost_report()</span><br></pre></td></tr></table></figure>
<h2 id="troubleshooting-methodologies">Troubleshooting
Methodologies</h2>
<p>Effective troubleshooting requires systematic approaches to identify
root causes quickly.</p>
<h3 id="the-troubleshooting-process">The Troubleshooting Process</h3>
<ol type="1">
<li><strong>Observe</strong>: Gather symptoms, check monitoring
dashboards, review logs</li>
<li><strong>Hypothesize</strong>: Form theories about what might be
wrong</li>
<li><strong>Test</strong>: Verify hypotheses through targeted
checks</li>
<li><strong>Fix</strong>: Implement solutions</li>
<li><strong>Verify</strong>: Confirm the fix resolved the issue</li>
<li><strong>Document</strong>: Record the incident and resolution</li>
</ol>
<h3 id="common-cloud-issues-and-solutions">Common Cloud Issues and
Solutions</h3>
<p><strong>High Latency</strong>: - Check database query performance -
Review cache hit rates - Analyze network latency - Check for resource
contention - Review application code for inefficient algorithms</p>
<p><strong>High Error Rates</strong>: - Check application logs for error
patterns - Review dependency health (databases, APIs) - Check for
resource exhaustion (memory, connections) - Review recent deployments -
Check for configuration errors</p>
<p><strong>Resource Exhaustion</strong>: - Monitor memory usage and
leaks - Check connection pool sizes - Review disk space - Analyze CPU
usage patterns - Check for runaway processes</p>
<p><strong>Network Issues</strong>: - Verify security group rules -
Check route tables - Review DNS configuration - Analyze network ACLs -
Check for DDoS attacks</p>
<h3 id="troubleshooting-tools">Troubleshooting Tools</h3>
<p><strong>Cloud Provider Tools</strong>: - AWS CloudWatch, X-Ray,
Systems Manager - Google Cloud Monitoring, Trace, Debugger - Azure
Monitor, Application Insights</p>
<p><strong>Open Source Tools</strong>: - <code>htop</code>,
<code>iostat</code>, <code>netstat</code> for system monitoring -
<code>tcpdump</code>, <code>wireshark</code> for network analysis -
<code>strace</code>, <code>perf</code> for application profiling -
<code>kubectl</code>, <code>docker stats</code> for container
debugging</p>
<h2 id="site-reliability-engineering-sre">Site Reliability Engineering
(SRE)</h2>
<p>Site Reliability Engineering, pioneered by Google, applies software
engineering principles to operations, focusing on reliability,
scalability, and efficiency.</p>
<h3 id="slo-sli-and-error-budgets">SLO, SLI, and Error Budgets</h3>
<p><strong>Service Level Indicator (SLI)</strong>: A quantitative
measure of service quality (e.g., request latency, error rate,
availability).</p>
<p><strong>Service Level Objective (SLO)</strong>: A target value for an
SLI (e.g., 99.9% availability, P95 latency &lt; 200ms).</p>
<p><strong>Service Level Agreement (SLA)</strong>: A contract with
customers specifying consequences if SLOs aren't met.</p>
<p><strong>Error Budget</strong>: The acceptable amount of unreliability
(100% - SLO). If error budget is exhausted, freeze new feature
development and focus on reliability.</p>
<p><strong>Example SLO Definition</strong>:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">SLI: Availability</span><br><span class="line">Measurement: Successful requests / Total requests</span><br><span class="line">Window: Rolling 30-day window</span><br><span class="line">SLO: 99.9% availability</span><br><span class="line">Error Budget: 0.1% (43.2 minutes of downtime per month)</span><br><span class="line"></span><br><span class="line">SLI: Latency</span><br><span class="line">Measurement: P95 request latency</span><br><span class="line">Window: Rolling 7-day window</span><br><span class="line">SLO: P95 latency &lt; 200ms</span><br><span class="line">Error Budget: 5% of requests can exceed 200ms</span><br></pre></td></tr></table></figure>
<h3 id="sre-practices">SRE Practices</h3>
<p><strong>Toil Reduction</strong>: Automate repetitive operational
tasks to free engineers for high-value work.</p>
<p><strong>Incident Response</strong>: Structured processes for handling
incidents: 1. Detect and alert 2. Assess and escalate 3. Respond and
mitigate 4. Post-mortem and learn</p>
<p><strong>Post-Mortems</strong>: Blameless analysis of incidents
focusing on process improvements, not individual blame.</p>
<p><strong>Canary Deployments</strong>: Gradually roll out changes to a
small subset of users before full deployment.</p>
<p><strong>Feature Flags</strong>: Control feature rollouts and enable
quick rollbacks without code deployments.</p>
<p><strong>Chaos Engineering</strong>: Deliberately inject failures to
test system resilience and identify weaknesses.</p>
<h2 id="gitops">GitOps</h2>
<p>GitOps is an operational model that uses Git as the single source of
truth for infrastructure and application deployments.</p>
<h3 id="gitops-principles">GitOps Principles</h3>
<ol type="1">
<li><strong>Declarative</strong>: Everything is defined declaratively
(Kubernetes manifests, Terraform configs)</li>
<li><strong>Version Controlled</strong>: All changes tracked in Git</li>
<li><strong>Automated</strong>: Changes to Git automatically trigger
deployments</li>
<li><strong>Observable</strong>: System state is continuously compared
to Git state</li>
</ol>
<h3 id="gitops-workflow">GitOps Workflow</h3>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Developer → Git Commit → CI Pipeline → Container Registry</span><br><span class="line">                                           ↓</span><br><span class="line">                                    GitOps Operator</span><br><span class="line">                                           ↓</span><br><span class="line">                                    Kubernetes Cluster</span><br></pre></td></tr></table></figure>
<p><strong>ArgoCD Example</strong>:</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Application manifest</span></span><br><span class="line"><span class="attr">apiVersion:</span> <span class="string">argoproj.io/v1alpha1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Application</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">my-app</span></span><br><span class="line">  <span class="attr">namespace:</span> <span class="string">argocd</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">project:</span> <span class="string">default</span></span><br><span class="line">  <span class="attr">source:</span></span><br><span class="line">    <span class="attr">repoURL:</span> <span class="string">https://github.com/example/k8s-manifests</span></span><br><span class="line">    <span class="attr">targetRevision:</span> <span class="string">main</span></span><br><span class="line">    <span class="attr">path:</span> <span class="string">apps/my-app</span></span><br><span class="line">  <span class="attr">destination:</span></span><br><span class="line">    <span class="attr">server:</span> <span class="string">https://kubernetes.default.svc</span></span><br><span class="line">    <span class="attr">namespace:</span> <span class="string">production</span></span><br><span class="line">  <span class="attr">syncPolicy:</span></span><br><span class="line">    <span class="attr">automated:</span></span><br><span class="line">      <span class="attr">prune:</span> <span class="literal">true</span></span><br><span class="line">      <span class="attr">selfHeal:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">syncOptions:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">CreateNamespace=true</span></span><br><span class="line">  <span class="attr">revisionHistoryLimit:</span> <span class="number">10</span></span><br></pre></td></tr></table></figure>
<p><strong>Flux Example</strong>:</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Flux GitRepository</span></span><br><span class="line"><span class="attr">apiVersion:</span> <span class="string">source.toolkit.fluxcd.io/v1beta1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">GitRepository</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">app-repo</span></span><br><span class="line">  <span class="attr">namespace:</span> <span class="string">flux-system</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">interval:</span> <span class="string">1m</span></span><br><span class="line">  <span class="attr">url:</span> <span class="string">https://github.com/example/k8s-manifests</span></span><br><span class="line">  <span class="attr">ref:</span></span><br><span class="line">    <span class="attr">branch:</span> <span class="string">main</span></span><br><span class="line">  <span class="attr">secretRef:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">git-credentials</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Flux Kustomization</span></span><br><span class="line"><span class="attr">apiVersion:</span> <span class="string">kustomize.toolkit.fluxcd.io/v1beta1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Kustomization</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">app-kustomization</span></span><br><span class="line">  <span class="attr">namespace:</span> <span class="string">flux-system</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">interval:</span> <span class="string">5m</span></span><br><span class="line">  <span class="attr">path:</span> <span class="string">./apps/my-app</span></span><br><span class="line">  <span class="attr">prune:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">sourceRef:</span></span><br><span class="line">    <span class="attr">kind:</span> <span class="string">GitRepository</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">app-repo</span></span><br><span class="line">  <span class="attr">validation:</span> <span class="string">client</span></span><br><span class="line">  <span class="attr">healthChecks:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">apiVersion:</span> <span class="string">apps/v1</span></span><br><span class="line">      <span class="attr">kind:</span> <span class="string">Deployment</span></span><br><span class="line">      <span class="attr">name:</span> <span class="string">my-app</span></span><br><span class="line">      <span class="attr">namespace:</span> <span class="string">production</span></span><br></pre></td></tr></table></figure>
<h2 id="case-studies">Case Studies</h2>
<h3 id="case-study-1-e-commerce-platform-auto-scaling">Case Study 1:
E-Commerce Platform Auto-Scaling</h3>
<p><strong>Challenge</strong>: An e-commerce platform experienced
unpredictable traffic spikes during flash sales, causing site crashes
and lost revenue.</p>
<p><strong>Solution</strong>: Implemented comprehensive auto-scaling
with predictive scaling:</p>
<ol type="1">
<li><strong>Infrastructure</strong>: AWS Auto Scaling Groups with Launch
Templates</li>
<li><strong>Metrics</strong>: CPU, memory, request rate, queue
depth</li>
<li><strong>Predictive Scaling</strong>: ML-based traffic prediction
using historical data</li>
<li><strong>Database</strong>: Read replicas with connection
pooling</li>
<li><strong>Caching</strong>: Multi-layer caching (CDN, Redis,
application cache)</li>
</ol>
<p><strong>Results</strong>: - Handled 10x traffic spikes without manual
intervention - Reduced costs by 40% through right-sizing and spot
instances - Improved availability from 99.5% to 99.95% - Zero downtime
during flash sales</p>
<p><strong>Key Learnings</strong>: - Predictive scaling requires
historical data; start with reactive scaling - Test auto-scaling under
load before production - Monitor costs continuously; auto-scaling can
increase costs if not configured properly</p>
<h3 id="case-study-2-microservices-observability">Case Study 2:
Microservices Observability</h3>
<p><strong>Challenge</strong>: A company migrated from monolith to
microservices but lost visibility into system behavior. Debugging issues
took hours instead of minutes.</p>
<p><strong>Solution</strong>: Implemented comprehensive observability
stack:</p>
<ol type="1">
<li><strong>Metrics</strong>: Prometheus with custom exporters</li>
<li><strong>Logging</strong>: ELK stack with structured logging</li>
<li><strong>Tracing</strong>: OpenTelemetry with Jaeger</li>
<li><strong>APM</strong>: Datadog for application performance
monitoring</li>
<li><strong>Dashboards</strong>: Grafana for visualization</li>
<li><strong>Alerting</strong>: PagerDuty integration</li>
</ol>
<p><strong>Architecture</strong>: <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Applications → OpenTelemetry SDK → OTLP Collector</span><br><span class="line">                                        ↓</span><br><span class="line">                    ┌───────────────────┼───────────────────┐</span><br><span class="line">                    ↓                   ↓                   ↓</span><br><span class="line">              Prometheus          Elasticsearch         Jaeger</span><br><span class="line">                    ↓                   ↓                   ↓</span><br><span class="line">                 Grafana              Kibana            Jaeger UI</span><br></pre></td></tr></table></figure></p>
<p><strong>Results</strong>: - Mean Time To Detect (MTTD): Reduced from
30 minutes to 2 minutes - Mean Time To Resolve (MTTR): Reduced from 4
hours to 30 minutes - Improved developer productivity through better
debugging tools - Proactive issue detection before user impact</p>
<p><strong>Key Learnings</strong>: - Instrumentation overhead is minimal
(&lt;1% CPU) - Structured logging is essential for microservices -
Distributed tracing reveals unexpected dependencies - Start with metrics
and logs, add tracing when needed</p>
<h3 id="case-study-3-cost-optimization-for-startup">Case Study 3: Cost
Optimization for Startup</h3>
<p><strong>Challenge</strong>: A startup's cloud costs grew from
$500/month to $15,000/month in 6 months without corresponding revenue
growth.</p>
<p><strong>Solution</strong>: Comprehensive cost optimization
program:</p>
<ol type="1">
<li><strong>Cost Analysis</strong>: Identified cost drivers using AWS
Cost Explorer</li>
<li><strong>Right-Sizing</strong>: Analyzed CloudWatch metrics to resize
instances</li>
<li><strong>Reserved Instances</strong>: Purchased 1-year RIs for
baseline capacity</li>
<li><strong>Spot Instances</strong>: Migrated batch jobs to spot
instances</li>
<li><strong>Auto-Shutdown</strong>: Automated shutdown of dev/staging
environments</li>
<li><strong>Storage Optimization</strong>: Moved old data to S3
Glacier</li>
<li><strong>Tagging</strong>: Implemented comprehensive tagging for cost
allocation</li>
</ol>
<p><strong>Actions Taken</strong>: - Reduced instance sizes: t3.large →
t3.medium (saved 50%) - Purchased RIs: Saved 40% on baseline capacity -
Spot instances for batch: Saved 70% on batch processing - Auto-shutdown:
Saved 60% on non-production environments - Storage optimization: Saved
80% on archival storage</p>
<p><strong>Results</strong>: - Reduced monthly costs from $15,000 to
$4,500 (70% reduction) - Maintained performance and availability -
Established cost monitoring and alerting - Created cost allocation by
team/project</p>
<p><strong>Key Learnings</strong>: - Regular cost reviews prevent cost
creep - Tagging is essential for cost allocation - Non-production
environments are often over-provisioned - Reserved instances require
commitment but provide significant savings</p>
<h2 id="qa-common-cloud-operations-questions">Q&amp;A: Common Cloud
Operations Questions</h2>
<h3 id="q1-how-do-i-choose-between-terraform-ansible-and-cloudformation">Q1:
How do I choose between Terraform, Ansible, and CloudFormation?</h3>
<p><strong>A</strong>: Choose based on your cloud provider and use case:
- <strong>Terraform</strong>: Multi-cloud, declarative, large ecosystem.
Best for provisioning infrastructure across providers. -
<strong>CloudFormation</strong>: AWS-native, integrates well with AWS
services. Best if you're AWS-only. - <strong>Ansible</strong>:
Configuration management and application deployment. Use alongside
Terraform/CloudFormation for configuring provisioned resources.</p>
<p>Many teams use Terraform for provisioning and Ansible for
configuration.</p>
<h3 id="q2-whats-the-difference-between-monitoring-and-observability">Q2:
What's the difference between monitoring and observability?</h3>
<p><strong>A</strong>: <strong>Monitoring</strong> tells you what's
happening (metrics, alerts). <strong>Observability</strong> helps you
understand why (metrics + logs + traces + context).</p>
<p>Monitoring answers "Is the system working?" Observability answers
"Why isn't it working?" when something goes wrong.</p>
<h3 id="q3-how-do-i-determine-appropriate-slo-targets">Q3: How do I
determine appropriate SLO targets?</h3>
<p><strong>A</strong>: Start with business requirements: 1. What
availability do customers expect? 2. What latency is acceptable? 3. What
error rate is tolerable?</p>
<p>Then work backwards: - Analyze historical data to understand current
performance - Set SLOs slightly above current performance (achievable
but requires improvement) - Consider error budgets: more aggressive SLOs
= less room for new features - Review and adjust quarterly based on
business needs</p>
<h3 id="q4-should-i-use-managed-services-or-self-hosted-tools">Q4:
Should I use managed services or self-hosted tools?</h3>
<p><strong>A</strong>: Consider: - <strong>Managed services</strong>
(CloudWatch, Datadog, New Relic): Faster setup, less maintenance, higher
cost, potential vendor lock-in - <strong>Self-hosted</strong>
(Prometheus, Grafana, ELK): More control, lower cost at scale, requires
operational expertise</p>
<p>Start with managed services for speed, migrate to self-hosted if
costs become significant or you need specific customizations.</p>
<h3 id="q5-how-do-i-implement-effective-alerting">Q5: How do I implement
effective alerting?</h3>
<p><strong>A</strong>: Follow alerting best practices: - <strong>Alert
on symptoms users care about</strong>, not every metric - <strong>Use
alert fatigue prevention</strong>: Appropriate thresholds, grouping, and
suppression - <strong>Page on-call only for actionable alerts</strong>
that require immediate response - <strong>Use different severity
levels</strong>: Critical (page), Warning (ticket), Info (dashboard) -
<strong>Test alerts regularly</strong> to ensure they work -
<strong>Document runbooks</strong> for common alerts</p>
<h3 id="q6-whats-the-best-auto-scaling-strategy">Q6: What's the best
auto-scaling strategy?</h3>
<p><strong>A</strong>: Use multiple strategies: - <strong>Reactive
scaling</strong>: Scale based on current metrics (CPU, memory, request
rate) - <strong>Predictive scaling</strong>: Use ML to predict traffic
and scale proactively - <strong>Scheduled scaling</strong>: Scale based
on known patterns (business hours, events) - <strong>Multiple
metrics</strong>: Don't rely on CPU alone; consider memory, queue depth,
custom metrics</p>
<p>Start simple with reactive scaling, add predictive scaling as you
gather data.</p>
<h3 id="q7-how-do-i-optimize-cloud-costs-without-impacting-performance">Q7:
How do I optimize cloud costs without impacting performance?</h3>
<p><strong>A</strong>: Systematic approach: 1. <strong>Measure</strong>:
Use cost allocation tags and cost analysis tools 2.
<strong>Right-size</strong>: Analyze utilization and resize instances 3.
<strong>Reserved instances</strong>: For predictable workloads 4.
<strong>Spot instances</strong>: For fault-tolerant workloads 5.
<strong>Auto-shutdown</strong>: Stop non-production resources when not
needed 6. <strong>Storage optimization</strong>: Use appropriate storage
classes 7. <strong>Review regularly</strong>: Monthly cost reviews to
catch cost creep</p>
<p>Always test cost optimizations in non-production first.</p>
<h3 id="q8-whats-the-difference-between-ci-and-cd">Q8: What's the
difference between CI and CD?</h3>
<p><strong>A</strong>: - <strong>CI (Continuous Integration)</strong>:
Automatically build and test code when developers commit. Focuses on
code quality. - <strong>CD (Continuous Deployment)</strong>:
Automatically deploy code to production after passing tests. Focuses on
delivery speed.</p>
<p>Some teams use <strong>Continuous Delivery</strong> (manual approval
before production deployment) instead of Continuous Deployment
(automatic).</p>
<h3 id="q9-how-do-i-implement-gitops">Q9: How do I implement
GitOps?</h3>
<p><strong>A</strong>: Steps: 1. <strong>Store everything in
Git</strong>: Infrastructure code, application configs, Kubernetes
manifests 2. <strong>Use GitOps operator</strong>: ArgoCD or Flux to
sync Git state to clusters 3. <strong>Automate</strong>: CI pipeline
builds containers, GitOps operator deploys 4. <strong>Monitor</strong>:
GitOps operator continuously compares cluster state to Git 5.
<strong>Self-heal</strong>: Automatically revert manual changes to match
Git</p>
<p>Start with a single application, expand gradually.</p>
<h3 id="q10-what-should-i-include-in-a-post-mortem">Q10: What should I
include in a post-mortem?</h3>
<p><strong>A</strong>: Post-mortem structure: 1.
<strong>Timeline</strong>: Chronological events leading to incident 2.
<strong>Impact</strong>: Users affected, duration, business impact 3.
<strong>Root cause</strong>: Technical and process causes 4.
<strong>What went well</strong>: Response effectiveness 5. <strong>What
went wrong</strong>: Gaps in monitoring, processes, tools 6.
<strong>Action items</strong>: Specific, assigned, time-bound
improvements 7. <strong>Follow-up</strong>: Review action items in next
post-mortem</p>
<p>Keep post-mortems blameless and focused on learning.</p>
<h2 id="cloud-operations-checklist">Cloud Operations Checklist</h2>
<p>Use this checklist to ensure comprehensive cloud operations
coverage:</p>
<h3 id="infrastructure">Infrastructure</h3>
<ul class="task-list">
<li><label><input type="checkbox">Infrastructure defined as code
(Terraform/CloudFormation)</label></li>
<li><label><input type="checkbox">Infrastructure changes reviewed
through pull requests</label></li>
<li><label><input type="checkbox">State files stored securely with
locking</label></li>
<li><label><input type="checkbox">Environments separated
(dev/staging/prod)</label></li>
<li><label><input type="checkbox">Secrets managed securely (AWS
Secrets Manager, HashiCorp Vault)</label></li>
<li><label><input type="checkbox">Network security configured
(security groups, NACLs, firewalls)</label></li>
<li><label><input type="checkbox">Backup and disaster recovery plans
documented and tested</label></li>
</ul>
<h3 id="monitoring-and-observability-1">Monitoring and
Observability</h3>
<ul class="task-list">
<li><label><input type="checkbox">Metrics collection configured
(Prometheus, CloudWatch)</label></li>
<li><label><input type="checkbox">Key SLIs defined and
measured</label></li>
<li><label><input type="checkbox">Dashboards created for critical
services</label></li>
<li><label><input type="checkbox">Logging centralized (ELK, CloudWatch
Logs)</label></li>
<li><label><input type="checkbox">Structured logging
implemented</label></li>
<li><label><input type="checkbox">Distributed tracing configured
(Jaeger, X-Ray)</label></li>
<li><label><input type="checkbox">APM tooling in place</label></li>
<li><label><input type="checkbox">Real User Monitoring (RUM)
configured</label></li>
</ul>
<h3 id="alerting">Alerting</h3>
<ul class="task-list">
<li><label><input type="checkbox">Alerting rules defined for critical
metrics</label></li>
<li><label><input type="checkbox">Alert severity levels
established</label></li>
<li><label><input type="checkbox">On-call rotation
configured</label></li>
<li><label><input type="checkbox">Alert routing to appropriate
teams</label></li>
<li><label><input type="checkbox">Runbooks documented for common
alerts</label></li>
<li><label><input type="checkbox">Alert fatigue prevention measures in
place</label></li>
<li><label><input type="checkbox">Alert testing procedures
established</label></li>
</ul>
<h3 id="cicd">CI/CD</h3>
<ul class="task-list">
<li><label><input type="checkbox">CI pipeline configured (build, test,
security scan)</label></li>
<li><label><input type="checkbox">CD pipeline configured (deploy to
staging/production)</label></li>
<li><label><input type="checkbox">Automated testing (unit,
integration, e2e)</label></li>
<li><label><input type="checkbox">Security scanning automated (SAST,
DAST, dependency scanning)</label></li>
<li><label><input type="checkbox">Deployment strategies defined
(blue-green, canary, rolling)</label></li>
<li><label><input type="checkbox">Rollback procedures
tested</label></li>
<li><label><input type="checkbox">Deployment notifications
configured</label></li>
</ul>
<h3 id="auto-scaling">Auto-Scaling</h3>
<ul class="task-list">
<li><label><input type="checkbox">Auto-scaling groups
configured</label></li>
<li><label><input type="checkbox">Scaling policies defined (scale-up
and scale-down)</label></li>
<li><label><input type="checkbox">Multiple metrics used for scaling
decisions</label></li>
<li><label><input type="checkbox">Cooldown periods configured
appropriately</label></li>
<li><label><input type="checkbox">Health checks
configured</label></li>
<li><label><input type="checkbox">Predictive scaling considered (if
applicable)</label></li>
<li><label><input type="checkbox">Scaling limits set (min/max
instances)</label></li>
</ul>
<h3 id="cost-management">Cost Management</h3>
<ul class="task-list">
<li><label><input type="checkbox">Cost allocation tags
implemented</label></li>
<li><label><input type="checkbox">Cost monitoring and alerting
configured</label></li>
<li><label><input type="checkbox">Regular cost reviews
scheduled</label></li>
<li><label><input type="checkbox">Right-sizing analysis
performed</label></li>
<li><label><input type="checkbox">Reserved instances
evaluated</label></li>
<li><label><input type="checkbox">Spot instances used where
appropriate</label></li>
<li><label><input type="checkbox">Auto-shutdown configured for
non-production</label></li>
<li><label><input type="checkbox">Storage optimization
implemented</label></li>
</ul>
<h3 id="security">Security</h3>
<ul class="task-list">
<li><label><input type="checkbox">Access control configured (IAM,
RBAC)</label></li>
<li><label><input type="checkbox">Secrets rotation
automated</label></li>
<li><label><input type="checkbox">Security scanning
automated</label></li>
<li><label><input type="checkbox">Vulnerability management process
established</label></li>
<li><label><input type="checkbox">Network security reviewed
regularly</label></li>
<li><label><input type="checkbox">Compliance requirements
documented</label></li>
<li><label><input type="checkbox">Security incident response plan
documented</label></li>
</ul>
<h3 id="documentation">Documentation</h3>
<ul class="task-list">
<li><label><input type="checkbox">Architecture diagrams up to
date</label></li>
<li><label><input type="checkbox">Runbooks documented</label></li>
<li><label><input type="checkbox">Incident response procedures
documented</label></li>
<li><label><input type="checkbox">Onboarding documentation for new
team members</label></li>
<li><label><input type="checkbox">Post-mortem templates
established</label></li>
<li><label><input type="checkbox">Knowledge base
maintained</label></li>
</ul>
<h3 id="sre-practices-1">SRE Practices</h3>
<ul class="task-list">
<li><label><input type="checkbox">SLOs defined for critical
services</label></li>
<li><label><input type="checkbox">SLIs measured and
tracked</label></li>
<li><label><input type="checkbox">Error budgets calculated and
monitored</label></li>
<li><label><input type="checkbox">Toil reduction initiatives
identified</label></li>
<li><label><input type="checkbox">Post-mortem process
established</label></li>
<li><label><input type="checkbox">Chaos engineering
considered</label></li>
<li><label><input type="checkbox">Feature flags
implemented</label></li>
</ul>
<h3 id="disaster-recovery">Disaster Recovery</h3>
<ul class="task-list">
<li><label><input type="checkbox">Backup procedures automated and
tested</label></li>
<li><label><input type="checkbox">Disaster recovery plan
documented</label></li>
<li><label><input type="checkbox">Recovery time objectives (RTO)
defined</label></li>
<li><label><input type="checkbox">Recovery point objectives (RPO)
defined</label></li>
<li><label><input type="checkbox">DR drills scheduled and
executed</label></li>
<li><label><input type="checkbox">Multi-region deployment
considered</label></li>
</ul>
<h2 id="conclusion">Conclusion</h2>
<p>Cloud operations and DevOps practices are essential for building and
maintaining reliable, scalable, and cost-effective cloud systems. The
journey from traditional IT operations to modern cloud operations
requires cultural shifts, new tools, and continuous learning.</p>
<p>Key takeaways:</p>
<ul>
<li><strong>Infrastructure as Code</strong> brings version control,
testing, and automation to infrastructure management</li>
<li><strong>Comprehensive observability</strong> (metrics, logs, traces)
is essential for understanding system behavior</li>
<li><strong>Automation</strong> reduces manual errors and enables rapid,
reliable deployments</li>
<li><strong>Auto-scaling</strong> ensures optimal performance while
controlling costs</li>
<li><strong>Cost optimization</strong> requires continuous monitoring
and strategic resource usage</li>
<li><strong>SRE practices</strong> (SLOs, error budgets, post-mortems)
improve reliability systematically</li>
<li><strong>GitOps</strong> provides a modern operational model using
Git as the source of truth</li>
</ul>
<p>The cloud operations landscape continues to evolve. New tools emerge,
best practices refine, and the complexity of distributed systems
increases. Staying current requires continuous learning,
experimentation, and adaptation. Start with the fundamentals, implement
incrementally, measure results, and iterate based on what you learn.</p>
<p>Remember: perfect operations don't exist. The goal is continuous
improvement—detecting issues faster, resolving them quicker, and
preventing them proactively. Every incident is a learning opportunity,
every optimization a step toward better reliability and efficiency.</p>

        </div>

        
            <div class="post-copyright-info">
                <div class="article-copyright-info-container">
    
    
    
    
    
    
    <ul>
        <li>Post title：Cloud Computing (7): Operations and DevOps Practices</li>
        <li>Post author：Chen Kai</li>
        <li>Create time：2025-01-05 00:00:00</li>
        <li>
            Post link：https://www.chenk.top/en/cloud-computing-operations-devops/
        </li>
        <li>
            Copyright Notice：All articles in this blog are licensed under <a class="license" target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.en">BY-NC-SA</a> unless stating additionally.
        </li>
    </ul>
</div>

            </div>
        

        
            <ul class="post-tags-box">
                
                    <li class="tag-item">
                        <a href="/en/tags/DevOps/">#DevOps</a>&nbsp;
                    </li>
                
                    <li class="tag-item">
                        <a href="/en/tags/Cloud-Computing/">#Cloud Computing</a>&nbsp;
                    </li>
                
                    <li class="tag-item">
                        <a href="/en/tags/Operations/">#Operations</a>&nbsp;
                    </li>
                
                    <li class="tag-item">
                        <a href="/en/tags/Monitoring/">#Monitoring</a>&nbsp;
                    </li>
                
                    <li class="tag-item">
                        <a href="/en/tags/Automation/">#Automation</a>&nbsp;
                    </li>
                
            </ul>
        

        

        
            <div class="article-nav">
                
                    <div class="article-prev">
                        <a class="prev"
                           rel="prev"
                           href="/en/cloud-computing-cloud-native-containers/"
                        >
                            <span class="left arrow-icon flex-center">
                              <i class="fas fa-chevron-left"></i>
                            </span>
                            <span class="title flex-center">
                                <span class="post-nav-title-item">Cloud Computing (4): Cloud-Native and Container Technologies</span>
                                <span class="post-nav-item">Prev posts</span>
                            </span>
                        </a>
                    </div>
                
                
                    <div class="article-next">
                        <a class="next"
                           rel="next"
                           href="/en/cloud-computing-security-privacy/"
                        >
                            <span class="title flex-center">
                                <span class="post-nav-title-item">Cloud Computing (6): Security and Privacy Protection</span>
                                <span class="post-nav-item">Next posts</span>
                            </span>
                            <span class="right arrow-icon flex-center">
                              <i class="fas fa-chevron-right"></i>
                            </span>
                        </a>
                    </div>
                
            </div>
        

        
            <div class="comment-container">
                <div class="comments-container">
    <div id="comment-anchor"></div>
    <div class="comment-area-title">
        <i class="fas fa-comments">&nbsp;Comments</i>
    </div>
    

        
            
    <div class="valine-container">
        <script data-pjax
                src="//cdn.jsdelivr.net/npm/valine@latest/dist/Valine.min.js"></script>
        <div id="vcomments"></div>
        <script data-pjax>
            function loadValine() {
                new Valine({
                    el: '#vcomments',
                    appId: 'p2Cu9MgjoKzo3VmulhNLIusH-gzGzoHsz',
                    appKey: 'QThQHg3c8sVwGpzg9lu8zEG3',
                    meta: ['nick', 'mail', 'link'],
                    avatar: 'wavatar',
                    enableQQ: true,
                    placeholder: '😜 尽情赞美帅气伟大的ck吧~',
                    lang: 'en'.toLowerCase()
                });

                function getAuthor(language) {
                    switch (language) {
                        case 'en':
                            return 'Author';
                        case 'zh-CN':
                            return '博主';
                        default:
                            return 'Master';
                    }
                }

                // Add "Author" identify
                const getValineDomTimer = setInterval(() => {
                    const vcards = document.querySelectorAll('#vcomments .vcards .vcard');
                    if (vcards.length > 0) {
                        let author = 'Chen Kai';

                        if (author) {
                            for (let vcard of vcards) {
                                const vnick_dom = vcard.querySelector('.vhead .vnick');
                                const vnick = vnick_dom.innerHTML;
                                if (vnick === author) {
                                    vnick_dom.innerHTML = `${vnick} <span class="author">${getAuthor(KEEP.hexo_config.language)}</span>`
                                }
                            }
                        }
                        clearInterval(getValineDomTimer);
                    } else {
                        clearInterval(getValineDomTimer);
                    }
                }, 2000);
            }

            if ('true') {
                const loadValineTimeout = setTimeout(() => {
                    loadValine();
                    clearTimeout(loadValineTimeout);
                }, 1000);
            } else {
                window.addEventListener('DOMContentLoaded', loadValine);
            }
        </script>
    </div>



        
    
</div>

            </div>
        
    </div>
</div>


                
            </div>

        </div>

        <div class="page-main-content-bottom">
            <footer class="footer">
    <div class="info-container">
        <div class="copyright-info info-item">
            &copy;
            
              <span>2020</span>
              -
            
            2026&nbsp;<i class="fas fa-heart icon-animate"></i>&nbsp;<a href="/">Chen Kai</a>
        </div>
        
            <script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
            <div class="website-count info-item">
                
                    <span id="busuanzi_container_site_uv">
                        Visitor Count&nbsp;<span id="busuanzi_value_site_uv"></span>&ensp;
                    </span>
                
                
            </div>
        
        <div class="theme-info info-item">
            <!-- Powered by <a target="_blank" href="https://hexo.io">Hexo</a>&nbsp;|&nbsp;Theme&nbsp;<a class="theme-version" target="_blank" href="https://github.com/XPoet/hexo-theme-keep">Keep v3.4.5</a> -->
        </div>
        
        
    </div>
</footer>

        </div>
    </div>

    
        <div class="post-tools">
            <div class="post-tools-container">
    <ul class="tools-list">
        <!-- TOC aside toggle -->
        
            <li class="tools-item page-aside-toggle">
                <i class="fas fa-outdent"></i>
            </li>
        

        <!-- go comment -->
        
            <li class="go-comment">
                <i class="fas fa-comment"></i>
            </li>
        
    </ul>
</div>

        </div>
    

    <div class="right-bottom-side-tools">
        <div class="side-tools-container">
    <ul class="side-tools-list">
        <li class="tools-item tool-font-adjust-plus flex-center">
            <i class="fas fa-search-plus"></i>
        </li>

        <li class="tools-item tool-font-adjust-minus flex-center">
            <i class="fas fa-search-minus"></i>
        </li>

        <li class="tools-item tool-expand-width flex-center">
            <i class="fas fa-arrows-alt-h"></i>
        </li>

        <li class="tools-item tool-dark-light-toggle flex-center">
            <i class="fas fa-moon"></i>
        </li>

        <!-- rss -->
        
            <li class="tools-item rss flex-center">
                <a class="flex-center"
                   href="/atom.xml"
                   target="_blank"
                >
                    <i class="fas fa-rss"></i>
                </a>
            </li>
        

        
            <li class="tools-item tool-scroll-to-top flex-center">
                <i class="fas fa-arrow-up"></i>
            </li>
        

        <li class="tools-item tool-scroll-to-bottom flex-center">
            <i class="fas fa-arrow-down"></i>
        </li>
    </ul>

    <ul class="exposed-tools-list">
        <li class="tools-item tool-toggle-show flex-center">
            <i class="fas fa-cog fa-spin"></i>
        </li>
        
    </ul>
</div>

    </div>

    
        <aside class="page-aside">
            <div class="post-toc-wrap">
    <div class="post-toc">
        <ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#the-evolution-of-cloud-operations"><span class="nav-number">1.</span> <span class="nav-text">The Evolution of Cloud
Operations</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#from-traditional-it-to-devops"><span class="nav-number">1.1.</span> <span class="nav-text">From Traditional IT to
DevOps</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#cloud-operations-challenges"><span class="nav-number">1.2.</span> <span class="nav-text">Cloud Operations Challenges</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#infrastructure-as-code-iac"><span class="nav-number">2.</span> <span class="nav-text">Infrastructure as Code (IaC)</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#why-infrastructure-as-code"><span class="nav-number">2.1.</span> <span class="nav-text">Why Infrastructure as Code?</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#terraform-declarative-infrastructure-provisioning"><span class="nav-number">2.2.</span> <span class="nav-text">Terraform:
Declarative Infrastructure Provisioning</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ansible-configuration-management-and-automation"><span class="nav-number">2.3.</span> <span class="nav-text">Ansible:
Configuration Management and Automation</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#aws-cloudformation-native-aws-iac"><span class="nav-number">2.4.</span> <span class="nav-text">AWS CloudFormation: Native
AWS IaC</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#monitoring-and-observability"><span class="nav-number">3.</span> <span class="nav-text">Monitoring and Observability</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#the-three-pillars-of-observability"><span class="nav-number">3.1.</span> <span class="nav-text">The Three Pillars of
Observability</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#prometheus-metrics-collection-and-alerting"><span class="nav-number">3.2.</span> <span class="nav-text">Prometheus: Metrics
Collection and Alerting</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#grafana-visualization-and-dashboards"><span class="nav-number">3.3.</span> <span class="nav-text">Grafana: Visualization and
Dashboards</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#application-performance-monitoring-apm"><span class="nav-number">3.4.</span> <span class="nav-text">Application Performance
Monitoring (APM)</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#logging-and-analysis"><span class="nav-number">4.</span> <span class="nav-text">Logging and Analysis</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#elk-stack-elasticsearch-logstash-and-kibana"><span class="nav-number">4.1.</span> <span class="nav-text">ELK Stack:
Elasticsearch, Logstash, and Kibana</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#centralized-logging-best-practices"><span class="nav-number">4.2.</span> <span class="nav-text">Centralized Logging Best
Practices</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#automation-and-cicd"><span class="nav-number">5.</span> <span class="nav-text">Automation and CI&#x2F;CD</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#cicd-pipeline-components"><span class="nav-number">5.1.</span> <span class="nav-text">CI&#x2F;CD Pipeline Components</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#github-actions-example"><span class="nav-number">5.2.</span> <span class="nav-text">GitHub Actions Example</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#gitlab-cicd-example"><span class="nav-number">5.3.</span> <span class="nav-text">GitLab CI&#x2F;CD Example</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#auto-scaling-strategies"><span class="nav-number">6.</span> <span class="nav-text">Auto-Scaling Strategies</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#horizontal-vs-vertical-scaling"><span class="nav-number">6.1.</span> <span class="nav-text">Horizontal vs Vertical
Scaling</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#aws-auto-scaling-configuration"><span class="nav-number">6.2.</span> <span class="nav-text">AWS Auto Scaling
Configuration</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#kubernetes-horizontal-pod-autoscaler"><span class="nav-number">6.3.</span> <span class="nav-text">Kubernetes Horizontal Pod
Autoscaler</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#auto-scaling-best-practices"><span class="nav-number">6.4.</span> <span class="nav-text">Auto-Scaling Best Practices</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#cost-optimization"><span class="nav-number">7.</span> <span class="nav-text">Cost Optimization</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#cost-optimization-strategies"><span class="nav-number">7.1.</span> <span class="nav-text">Cost Optimization Strategies</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#aws-cost-optimization-script"><span class="nav-number">7.2.</span> <span class="nav-text">AWS Cost Optimization Script</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#troubleshooting-methodologies"><span class="nav-number">8.</span> <span class="nav-text">Troubleshooting
Methodologies</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#the-troubleshooting-process"><span class="nav-number">8.1.</span> <span class="nav-text">The Troubleshooting Process</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#common-cloud-issues-and-solutions"><span class="nav-number">8.2.</span> <span class="nav-text">Common Cloud Issues and
Solutions</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#troubleshooting-tools"><span class="nav-number">8.3.</span> <span class="nav-text">Troubleshooting Tools</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#site-reliability-engineering-sre"><span class="nav-number">9.</span> <span class="nav-text">Site Reliability Engineering
(SRE)</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#slo-sli-and-error-budgets"><span class="nav-number">9.1.</span> <span class="nav-text">SLO, SLI, and Error Budgets</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#sre-practices"><span class="nav-number">9.2.</span> <span class="nav-text">SRE Practices</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#gitops"><span class="nav-number">10.</span> <span class="nav-text">GitOps</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#gitops-principles"><span class="nav-number">10.1.</span> <span class="nav-text">GitOps Principles</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#gitops-workflow"><span class="nav-number">10.2.</span> <span class="nav-text">GitOps Workflow</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#case-studies"><span class="nav-number">11.</span> <span class="nav-text">Case Studies</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#case-study-1-e-commerce-platform-auto-scaling"><span class="nav-number">11.1.</span> <span class="nav-text">Case Study 1:
E-Commerce Platform Auto-Scaling</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#case-study-2-microservices-observability"><span class="nav-number">11.2.</span> <span class="nav-text">Case Study 2:
Microservices Observability</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#case-study-3-cost-optimization-for-startup"><span class="nav-number">11.3.</span> <span class="nav-text">Case Study 3: Cost
Optimization for Startup</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#qa-common-cloud-operations-questions"><span class="nav-number">12.</span> <span class="nav-text">Q&amp;A: Common Cloud
Operations Questions</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#q1-how-do-i-choose-between-terraform-ansible-and-cloudformation"><span class="nav-number">12.1.</span> <span class="nav-text">Q1:
How do I choose between Terraform, Ansible, and CloudFormation?</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#q2-whats-the-difference-between-monitoring-and-observability"><span class="nav-number">12.2.</span> <span class="nav-text">Q2:
What&#39;s the difference between monitoring and observability?</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#q3-how-do-i-determine-appropriate-slo-targets"><span class="nav-number">12.3.</span> <span class="nav-text">Q3: How do I
determine appropriate SLO targets?</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#q4-should-i-use-managed-services-or-self-hosted-tools"><span class="nav-number">12.4.</span> <span class="nav-text">Q4:
Should I use managed services or self-hosted tools?</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#q5-how-do-i-implement-effective-alerting"><span class="nav-number">12.5.</span> <span class="nav-text">Q5: How do I implement
effective alerting?</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#q6-whats-the-best-auto-scaling-strategy"><span class="nav-number">12.6.</span> <span class="nav-text">Q6: What&#39;s the best
auto-scaling strategy?</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#q7-how-do-i-optimize-cloud-costs-without-impacting-performance"><span class="nav-number">12.7.</span> <span class="nav-text">Q7:
How do I optimize cloud costs without impacting performance?</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#q8-whats-the-difference-between-ci-and-cd"><span class="nav-number">12.8.</span> <span class="nav-text">Q8: What&#39;s the
difference between CI and CD?</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#q9-how-do-i-implement-gitops"><span class="nav-number">12.9.</span> <span class="nav-text">Q9: How do I implement
GitOps?</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#q10-what-should-i-include-in-a-post-mortem"><span class="nav-number">12.10.</span> <span class="nav-text">Q10: What should I
include in a post-mortem?</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#cloud-operations-checklist"><span class="nav-number">13.</span> <span class="nav-text">Cloud Operations Checklist</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#infrastructure"><span class="nav-number">13.1.</span> <span class="nav-text">Infrastructure</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#monitoring-and-observability-1"><span class="nav-number">13.2.</span> <span class="nav-text">Monitoring and
Observability</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#alerting"><span class="nav-number">13.3.</span> <span class="nav-text">Alerting</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#cicd"><span class="nav-number">13.4.</span> <span class="nav-text">CI&#x2F;CD</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#auto-scaling"><span class="nav-number">13.5.</span> <span class="nav-text">Auto-Scaling</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#cost-management"><span class="nav-number">13.6.</span> <span class="nav-text">Cost Management</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#security"><span class="nav-number">13.7.</span> <span class="nav-text">Security</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#documentation"><span class="nav-number">13.8.</span> <span class="nav-text">Documentation</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#sre-practices-1"><span class="nav-number">13.9.</span> <span class="nav-text">SRE Practices</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#disaster-recovery"><span class="nav-number">13.10.</span> <span class="nav-text">Disaster Recovery</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#conclusion"><span class="nav-number">14.</span> <span class="nav-text">Conclusion</span></a></li></ol>
    </div>
</div>
        </aside>
    

    <div class="image-viewer-container">
    <img src="">
</div>


    
        <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
          <span class="search-input-field-pre">
            <i class="fas fa-keyboard"></i>
          </span>
            <div class="search-input-container">
                <input autocomplete="off"
                       autocorrect="off"
                       autocapitalize="off"
                       placeholder="Search..."
                       spellcheck="false"
                       type="search"
                       class="search-input"
                >
            </div>
            <span class="popup-btn-close">
                <i class="fas fa-times"></i>
            </span>
        </div>
        <div id="search-result">
            <div id="no-result">
                <i class="fas fa-spinner fa-pulse fa-5x fa-fw"></i>
            </div>
        </div>
    </div>
</div>

    

</main>




<script src="/js/utils.js"></script>

<script src="/js/main.js"></script>

<script src="/js/header-shrink.js"></script>

<script src="/js/back2top.js"></script>

<script src="/js/dark-light-toggle.js"></script>

<script src="/js/lang-switch.js"></script>



    
<script src="/js/local-search.js"></script>




    
<script src="/js/code-copy.js"></script>





<div class="post-scripts pjax">
    
        
<script src="/js/left-side-toggle.js"></script>

<script src="/js/libs/anime.min.js"></script>

<script src="/js/toc.js"></script>

    
</div>


    
<script src="/js/libs/pjax.min.js"></script>

<script>
    window.addEventListener('DOMContentLoaded', () => {
        window.pjax = new Pjax({
            selectors: [
                'head title',
                '.page-container',
                '.pjax'
            ],
            history: true,
            debug: false,
            cacheBust: false,
            timeout: 0,
            analytics: false,
            currentUrlFullReload: false,
            scrollRestoration: false,
            // scrollTo: true,
        });

        document.addEventListener('pjax:send', () => {
            KEEP.utils.pjaxProgressBarStart();
        });

        document.addEventListener('pjax:complete', () => {
            KEEP.utils.pjaxProgressBarEnd();
            window.pjax.executeScripts(document.querySelectorAll('script[data-pjax], .pjax script'));
            KEEP.refresh();
        });
    });
</script>



</body>
</html>
