<!DOCTYPE html>



<html lang="zh-CN">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="keywords" content="Hexo Theme Keep">
    <meta name="description" content="Hexo Theme Keep">
    <meta name="author" content="Chen Kai">
    
    <title>
        
            Linux 系统服务管理 |
        
        Chen Kai Blog
    </title>
    
<link rel="stylesheet" href="/css/style.css">

    <link rel="shortcut icon" href="/images/logo.svg">
    
<link rel="stylesheet" href="/css/font-awesome.min.css">

    <script id="hexo-configurations">
    let KEEP = window.KEEP || {};
    KEEP.hexo_config = {"hostname":"chenk.top","root":"/","language":"zh-CN","default_language":"zh-CN","languages":["zh-CN","en","default"],"path":"search.json"};
    KEEP.theme_config = {"toc":{"enable":true,"number":true,"expand_all":true,"init_open":true},"style":{"primary_color":"#0066CC","avatar":"/images/avatar.svg","favicon":"/images/logo.svg","article_img_align":"left","left_side_width":"260px","content_max_width":"920px","hover":{"shadow":false,"scale":false},"first_screen":{"enable":true,"background_img":"/images/bg.svg","description":"Keep writing and Keep loving."},"scroll":{"progress_bar":{"enable":true},"percent":{"enable":false}}},"local_search":{"enable":true,"preload":true},"code_copy":{"enable":true,"style":"default"},"pjax":{"enable":true},"lazyload":{"enable":false},"version":"3.4.5"};
    KEEP.language_ago = {"second":"%s 秒前","minute":"%s 分钟前","hour":"%s 小时前","day":"%s 天前","week":"%s 周前","month":"%s 个月前","year":"%s 年前"};
  </script>
<meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="Chen Kai Blog" type="application/atom+xml">
</head>


<body>
<div class="progress-bar-container">
    
        <span class="scroll-progress-bar"></span>
    

    
        <span class="pjax-progress-bar"></span>
        <span class="pjax-progress-icon">
            <i class="fas fa-circle-notch fa-spin"></i>
        </span>
    
</div>


<main class="page-container">

    

    <div class="page-main-content">

        <div class="page-main-content-top">
            <header class="header-wrapper">

    
    
    
    
    

    <div class="header-content">
        <div class="left">
            
            <a class="logo-title" href="/">
                Chen Kai Blog
            </a>
        </div>

        <div class="right">
            <div class="pc">
                <ul class="menu-list">
                    
                        <li class="menu-item">
                            
                            
                            <a class=""
                               href="/"
                            >
                                首页
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            
                            
                            <a class=""
                               href="/archives"
                            >
                                归档
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            
                            
                            <a class=""
                               href="/categories"
                            >
                                分类
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            
                            
                            <a class=""
                               href="/tags"
                            >
                                标签
                            </a>
                        </li>
                    
                    <li class="menu-item lang-switch lang-switch-trigger" title="Language">
                        <i class="fas fa-globe"></i>
                    </li>
                    
                        <li class="menu-item search search-popup-trigger">
                            <i class="fas fa-search"></i>
                        </li>
                    
                </ul>
            </div>
            <div class="mobile">
                
                    <div class="icon-item search search-popup-trigger"><i class="fas fa-search"></i></div>
                
                <div class="icon-item lang-switch-trigger"><i class="fas fa-globe"></i></div>
                <div class="icon-item menu-bar">
                    <div class="menu-bar-middle"></div>
                </div>
            </div>
        </div>
    </div>

    <div class="header-drawer">
        <ul class="drawer-menu-list">
            
                <li class="drawer-menu-item flex-center">
                    
                    
                    <a class=""
                       href="/">首页</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    
                    
                    <a class=""
                       href="/archives">归档</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    
                    
                    <a class=""
                       href="/categories">分类</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    
                    
                    <a class=""
                       href="/tags">标签</a>
                </li>
            
        </ul>
    </div>

    <div class="window-mask"></div>

</header>


        </div>

        <div class="page-main-content-middle">

            <div class="main-content">

                
                    <div class="fade-in-down-animation">
    <div class="article-content-container">

        <div class="article-title">
            <span class="title-hover-animation">Linux 系统服务管理</span>
        </div>

        
            <div class="article-header">
                <div class="avatar">
                    <img src="/images/avatar.svg">
                </div>
                <div class="info">
                    <div class="author">
                        <span class="name">Chen Kai</span>
                        
                            <span class="author-label">CTO</span>
                        
                    </div>
                    <div class="meta-info">
                        <div class="article-meta-info">
    <span class="article-date article-meta-item">
        <i class="fas fa-edit"></i>&nbsp;
        <span class="pc">2025-01-06 00:00:00</span>
        <span class="mobile">2025-01-06 00:00</span>
    </span>
    
    
        <span class="article-tags article-meta-item">
            <i class="fas fa-tags"></i>&nbsp;
            <ul>
                
                    <li>
                        <a href="/tags/Linux/">Linux</a>&nbsp;
                    </li>
                
                    <li>
                        | <a href="/tags/%E4%BA%91%E8%AE%A1%E7%AE%97/">云计算</a>&nbsp;
                    </li>
                
            </ul>
        </span>
    

    
    
        <span class="article-wordcount article-meta-item">
            <i class="fas fa-file-word"></i>&nbsp;<span>6.4k 字</span>
        </span>
    
    
        <span class="article-min2read article-meta-item">
            <i class="fas fa-clock"></i>&nbsp;<span>25 分钟</span>
        </span>
    
    
        <span class="article-pv article-meta-item">
            <i class="fas fa-eye"></i>&nbsp;<span id="busuanzi_value_page_pv"></span>
        </span>
    
</div>

                    </div>
                </div>
            </div>
        

        <div class="article-content markdown-body">
            <p>在操作系统中，“服务”指后台常驻的进程或守护程序。本文介绍常见服务如 ntpd、firewalld、ssh 等的管理，并讲解如何使用 systemctl 命令进行启动、停止、重启与开机自启的配置。</p>
<span id="more"></span>
<h1>一、什么是系统服务管理</h1>
<p>在操作系统中，“服务”指的是在后台长期运行、对系统或用户提供某种功能的进程或守护程序。例如：</p>
<ul>
<li><strong>Windows</strong> 系统中的服务可通过 “services.msc” 可视化管理，包括 WiFi、蓝牙、音频、数据库等；</li>
<li><strong>Linux</strong> 系统同样提供大量服务，例如网络、时间同步、计划任务、数据库守护进程等，都可用命令行或工具进行管理。</li>
</ul>
<p><strong>Windows 服务举例</strong></p>
<ul>
<li>WiFi 服务：依赖网卡硬件+网卡驱动+对应服务程序一起协作，让系统能够进行无线网络连接。</li>
<li><strong>MySQL</strong>：若在 Windows 安装了 MySQL 数据库，可以通过 Windows 服务控制面板启动/停止服务，也可在命令行通过 <code>net start mysql</code> / <code>net stop mysql</code> 管理。</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Win 下示例：通过 cmd 管理服务</span></span><br><span class="line">net start mysql</span><br><span class="line">net stop mysql</span><br></pre></td></tr></table></figure>
<p>Linux 则依赖一套统一的服务管理机制（如 Systemd），使用 systemctl 等命令行工具配置和管理这些服务，包括自动启动、重启、停止等操作。</p>
<h1>二、Linux Systemd 服务管理</h1>
<h2 id="1-Systemd-基本作用"><a class="header-anchor" href="#1-Systemd-基本作用">¶</a>1.Systemd 基本作用</h2>
<p><strong>Systemd</strong> 是现代 Linux 发行版广泛使用的系统与服务管理器，它会在系统引导时启动各种服务，并维持它们的运行和状态。核心命令是 <code>systemctl</code>。</p>
<p>常见操作：</p>
<table>
<thead>
<tr>
<th>用法</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>systemctl start name</code></td>
<td>启动指定服务</td>
</tr>
<tr>
<td><code>systemctl stop name</code></td>
<td>停止指定服务</td>
</tr>
<tr>
<td><code>systemctl restart name</code></td>
<td>重启指定服务</td>
</tr>
<tr>
<td><code>systemctl status name</code></td>
<td>查看指定服务状态</td>
</tr>
<tr>
<td><code>systemctl enable name</code></td>
<td>开机自动启动</td>
</tr>
<tr>
<td><code>systemctl disable name</code></td>
<td>取消开机自启</td>
</tr>
<tr>
<td><code>systemctl is-active name</code></td>
<td>判断服务是否正在运行</td>
</tr>
<tr>
<td><code>systemctl is-enabled name</code></td>
<td>判断是否设置为开机启动</td>
</tr>
</tbody>
</table>
<p>示例：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">systemctl start crond</span><br><span class="line">systemctl <span class="built_in">enable</span> crond</span><br><span class="line">systemctl status firewalld</span><br></pre></td></tr></table></figure>
<h2 id="2-systemctl-使用"><a class="header-anchor" href="#2-systemctl-使用">¶</a>2.systemctl 使用</h2>
<p>CentOS 6 使用 <code>service</code> 来管理，CentOS 7 中的 <code>service</code> 和 <code>chkconfig</code> 都被整合到了 <code>systemctl</code> 里，向下兼容，可以使用旧的命令。</p>
<ol>
<li>
<p><strong>设置服务运行级别</strong>：<code>systemctl set-default multi-user.target</code> / <code>systemctl set-default graphical.target</code> 等控制是否进入文本多用户/图形环境。</p>
</li>
<li>
<p><strong>查看日志</strong>：配合 <code>journalctl -u servicename</code> 查看某服务相关日志。</p>
</li>
<li>
<p><strong>编辑服务单元文件</strong>：在 <code>/etc/systemd/system/</code> 或 <code>/usr/lib/systemd/system/</code> 下存放 <code>.service</code> 文件，自定义服务启动顺序、依赖等。</p>
</li>
<li>
<p><strong>列出 active 运行中的服务</strong>：</p>
<p>![image-20250127141849192](./Linux 系统服务管理/image-20250127141849192.png)</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 列出运行中的ssh服务</span></span><br><span class="line">systemctl list-units --<span class="built_in">type</span> service --all | grep ssh</span><br><span class="line"><span class="comment"># ssh.service             loaded    active   running OpenBSD Secure Shell server</span></span><br></pre></td></tr></table></figure>
<p>unit：单元、服务，指的是如sshd、network、nginx这样的服务名。</p>
</li>
</ol>
<blockquote>
<p>之前的service命令原理补充： Linux的大部分命令都是去机器上寻找到某个文件，然后读取文件的配置加载功能。而service默认是去 /etc/init.d 目录下寻找服务管理脚本文件，然后根据指令service start network等去进行启动。</p>
<p>![image-20250203001009014](./Linux 系统服务管理/image-20250203001009014.png)</p>
</blockquote>
<p>找到 <code>ssh</code> 这个文件进行打开，往下翻会出现下面的内容，这些就包含了一些相关的指令：</p>
<blockquote>
<p>![image-20250203001145705](./Linux 系统服务管理/image-20250203001145705.png)</p>
<p>所以如果安装了某个软件后没有方便的启停管理脚本，可以自己写完后放到 <code>/etc/init.d</code> 目录下再调用就行。</p>
</blockquote>
<p>通过 <code>yum</code> 或 <code>apt</code> 等安装的程序，会自动生成对应的管理脚本，自动的在 <code>systemctl</code> 管理脚本目录下：</p>
<p>![image-20250203002716348](./Linux 系统服务管理/image-20250203002716348.png)</p>
<p>于是我们每次要关停服务的时候就不需要先 <code>ps -ef</code> 再 <code>kill pid</code> 了，非常省事。以 <code>nginx</code> 为例我们可以有两种运行方式：</p>
<ol>
<li>直接运行命令</li>
<li>以服务管理模式运行systemctl</li>
</ol>
<p>![image-20250203005916445](./Linux 系统服务管理/image-20250203005916445.png)</p>
<p>可以查看 nginx 的服务管理脚本，以后安装软件可以参照这个脚本来写：</p>
<p>![image-20250203010533155](./Linux 系统服务管理/image-20250203010533155.png)</p>
<h1>三、常见自有服务与用途</h1>
<p>Linux 系统自带许多基础服务，以下列举几个常用且重要的示例：</p>
<h2 id="1-时间服务"><a class="header-anchor" href="#1-时间服务">¶</a>1.时间服务</h2>
<h3 id="ntpd-ntpsec"><a class="header-anchor" href="#ntpd-ntpsec">¶</a>ntpd &amp; ntpsec</h3>
<p><strong>ntpd</strong> 是用来实现时间同步的守护进程。它会定期与上游时间服务器通信，使本机系统时钟准确一致。<strong>ntpsec</strong> 是 <code>ntpd</code> 的现代化版本，旨在提高安全性、减少代码复杂度，并提供更高效的时间同步服务。它与传统的 <code>ntpd</code> 在核心功能上类似，但经过优化，移除了许多遗留特性，以提升稳定性和安全性。</p>
<p><strong>为什么需要时间同步？</strong></p>
<p>在分布式系统、集群、日志分析等应用场景下，时间同步至关重要。例如：</p>
<p>​	•	<strong>定时任务的执行</strong>（如 cron 任务）</p>
<p>​	•	<strong>日志对比和分析</strong>（确保日志时间戳的一致性）</p>
<p>​	•	<strong>数据同步</strong>（如数据库主从复制）</p>
<p>​	•	<strong>分布式计算和安全协议</strong>（如 Kerberos 身份认证）</p>
<p>如果服务器时间不一致，可能会导致：</p>
<p>​	•	<strong>任务调度混乱</strong>（任务可能提前或延后执行）</p>
<p>​	•	<strong>日志分析错误</strong>（难以关联不同系统的日志）</p>
<p>​	•	<strong>通信异常</strong>（如 TLS 证书时间不匹配）</p>
<p>因此保证服务器之前的时间一致非常重要。一些要点如下：</p>
<ul>
<li>NTP（Network Time Protocol）可实现毫秒级甚至更精确的时间同步，精度在局域网内可达 0.1 ms，在互联网上绝大多数地方的精度可以达到 1-50 ms。</li>
<li>在 <code>/etc/ntp.conf</code> 或 <code>/etc/chrony.conf</code> 中配置上游时间服务器地址。</li>
<li>启动服务后，<code>ntpd</code> 会定时校准本机时间。</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">systemctl <span class="built_in">enable</span> ntpsec</span><br><span class="line">systemctl start ntpsec</span><br></pre></td></tr></table></figure>
<p>![image-20250203113641235](./Linux 系统服务管理/image-20250203113641235.png)</p>
<p>可以前往 <code>/etc/ntpsec/ntp.conf</code> 查看对应的配置文件：</p>
<p>![image-20250203115220880](./Linux 系统服务管理/image-20250203115220880.png)</p>
<p>以阿里云 ntp 服务器为例，要修改为这个服务器的时间可以：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">server times.aliyun.com iburst prefer</span><br><span class="line">server ntp.aliyun.com iburst</span><br><span class="line">server cn.pool.ntp.org iburst</span><br></pre></td></tr></table></figure>
<p>可以查看 <code>/usr/lib/systemd/system/ntpsec.service</code> 查看配置文件：</p>
<p>![image-20250203115608782](./Linux 系统服务管理/image-20250203115608782.png)</p>
<p>查看运行状态：</p>
<p>![image-20250203115835862](./Linux 系统服务管理/image-20250203115835862.png)</p>
<p><code>ntpd -q</code> 可以监视 <code>ntpsec</code> 运行状态：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">2025-02-03T12:11:49 ntpd[973215]: INIT: ntpd ntpsec-1.2.2: Starting</span><br><span class="line">2025-02-03T12:11:49 ntpd[973215]: INIT: Command line: ntpd -q</span><br><span class="line">2025-02-03T12:11:49 ntpd[973215]: INIT: precision = 0.042 usec (-24)</span><br><span class="line">2025-02-03T12:11:49 ntpd[973215]: INIT: successfully locked into RAM</span><br><span class="line">2025-02-03T12:11:49 ntpd[973215]: CONFIG: readconfig: parsing file: /etc/ntpsec/ntp.conf</span><br><span class="line">2025-02-03T12:11:49 ntpd[973215]: CONFIG: Cannot open logfile /var/log/myntpsec.log: Permission denied</span><br><span class="line">2025-02-03T12:11:49 ntpd[973215]: INIT: ntpd ntpsec-1.2.2: Starting</span><br><span class="line">2025-02-03T12:11:49 ntpd[973215]: INIT: Command line: ntpd -q</span><br><span class="line">2025-02-03T12:11:49 ntpd[973215]: CONFIG: restrict nopeer ignored</span><br><span class="line">2025-02-03T12:11:49 ntpd[973215]: CLOCK: leapsecond file (<span class="string">&#x27;/usr/share/zoneinfo/leap-seconds.list&#x27;</span>): good <span class="built_in">hash</span> signature</span><br><span class="line">2025-02-03T12:11:49 ntpd[973215]: CLOCK: leapsecond file (<span class="string">&#x27;/usr/share/zoneinfo/leap-seconds.list&#x27;</span>): loaded, expire=2025-06-28T00:00Z last=2017-01-01T00:00Z ofs=37</span><br><span class="line">2025-02-03T12:11:49 ntpd[973215]: IO: unable to <span class="built_in">bind</span> to wildcard address :: - another process may be running: Address already <span class="keyword">in</span> use; EXITING</span><br></pre></td></tr></table></figure>
<h3 id="ntpdate（一次性时间同步工具）"><a class="header-anchor" href="#ntpdate（一次性时间同步工具）">¶</a>ntpdate（一次性时间同步工具）</h3>
<p>如果仅需临时更新时间，也可用 <code>ntpdate</code>（或 <code>chronyc</code>）命令：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ntpdate pool.ntp.org</span><br></pre></td></tr></table></figure>
<p>可以添加 <code>-u</code> 参数，指定来自某台服务器或者某个服务器厂商，例如：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ntpdate -u ntp.aliyun.com</span><br><span class="line">ntpdate -u 192.132.2.111</span><br></pre></td></tr></table></figure>
<p><code>ntpdata</code> 它会一次性与指定服务器进行同步，而非常驻守护进程。 <code>ntpd</code> 在实际同步时间时是一点点校准过来的，最终把时间慢慢校对，但 <code>ntpdate</code> 不会考虑其他程序是否会阵痛，直接调整时间，区别是一个是校准，一个是调整。总结来说 <code>ntpdate</code> 有如下<strong>缺点</strong>：</p>
<ol>
<li><strong>暴力修改时间</strong>
<ol>
<li><code>ntpdate</code> 直接调整时间，可能导致依赖时序的程序（如定时任务、数据库同步）出错。</li>
<li><code>ntpsec</code> 采用 <strong>平滑调整</strong> 方式，避免系统出现 <strong>时间跳变</strong> 影响应用。</li>
</ol>
</li>
<li><strong>安全隐患</strong>
<ol>
<li><code>ntpdate</code> 依赖外部 NTP 服务器，如果服务器被攻击，可能导致伪造时间同步。</li>
</ol>
</li>
</ol>
<p><strong>推荐使用 <code>ntpsec</code> 进行长时间运行的同步，避免 <code>ntpdate</code> 直接修改系统时间带来的问题。</strong></p>
<h3 id="timedatectl-（管理系统时间和-NTP-设置）"><a class="header-anchor" href="#timedatectl-（管理系统时间和-NTP-设置）">¶</a>timedatectl （管理系统时间和 NTP 设置）</h3>
<p><code>timedatectl</code> 是一个命令行工具，用于在 Linux 系统上查看和配置系统时间和日期相关设置。它提供了一种简单且统一的方式来管理系统时间，可用于查看当前时间、时区设置，更改时间和日期，启用或禁用 NTP 同步等操作。<code>timedatectl</code> 主要是整合了两类指令：</p>
<ul>
<li>
<p>date：改时间日期（软件时间，程序计算的时间）</p>
<p>![image-20250203120351446](./Linux 系统服务管理/image-20250203120351446.png)</p>
</li>
<li>
<p>hwlock：改硬件时间（计算机的主板上有一个 BIOS 的系统以及纽扣电池提供电量），可以同步硬件时间和软件时间，但现在 timedatectl 直接都做同步了。</p>
<p>![image-20250203120334565](./Linux 系统服务管理/image-20250203120334565.png)</p>
</li>
</ul>
<p>也就是说我们可以选择自己搭建一个 <code>ntpsec</code>，也可以选择直接使用 <code>timedatectl</code> 自动运行一个 <code>ntpsec</code>。</p>
<p>![image-20250203121839638](./Linux 系统服务管理/image-20250203121839638.png)</p>
<p>我们可以做个实验，先把原来的 <code>ntpsec</code> 服务关掉，再开启 <code>timedatectl</code> 这边的服务：</p>
<p>![image-20250203122209417](./Linux 系统服务管理/image-20250203122209417.png)</p>
<p>发现出了问题，经过排查发现 <code>timedatectl</code> 是通过 <code>systemd-timesyncd</code> 管理 <code>ntp</code> 同步的，因此首先应该安装 <code>systemd-timesyncd</code>，然后开启它，再设置 <code>timedatectl</code> 里的 <code>set-ntp</code>：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sudo apt install systemd-timesyncd -y</span><br><span class="line"><span class="comment"># systemctl status systemd-timesyncd</span></span><br><span class="line">sudo systemctl start systemd-timesyncd</span><br><span class="line">timedatectl set-ntp on</span><br></pre></td></tr></table></figure>
<p>![image-20250203122508617](./Linux 系统服务管理/image-20250203122508617.png)</p>
<p>当我们启动了 <code>ntp</code> 服务后，会发现无法再使用 <code>timedatectl</code> 设置时间了：</p>
<p>![image-20250203122609864](./Linux 系统服务管理/image-20250203122609864.png)</p>
<h4 id="查看当前时间和日期信息"><a class="header-anchor" href="#查看当前时间和日期信息">¶</a>查看当前时间和日期信息</h4>
<p>可以使用以下命令查看系统当前的时间、日期、时区以及 NTP 同步状态：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">timedatectl</span><br></pre></td></tr></table></figure>
<p>执行该命令后，会输出类似如下信息：</p>
<p>![image-20250203105914072](./Linux 系统服务管理/image-20250203105914072.png)</p>
<h4 id="查看可用时区"><a class="header-anchor" href="#查看可用时区">¶</a>查看可用时区</h4>
<p>要查看所有可用的时区列表，可以使用以下命令：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">timedatectl list-timezones</span><br></pre></td></tr></table></figure>
<p>这会列出所有支持的时区名称，例如 <code>Asia/Shanghai</code>、<code>Europe/London</code> 等。</p>
<p>![image-20250203110010533](./Linux 系统服务管理/image-20250203110010533.png)</p>
<p>要修改时区或者系统中查看有哪些时区文件也可以手动去做，这也是 CentOS 6 中一般使用的方法：</p>
<p>![image-20250203110415833](./Linux 系统服务管理/image-20250203110415833.png)</p>
<h4 id="设置时区"><a class="header-anchor" href="#设置时区">¶</a>设置时区</h4>
<p>若要更改系统的时区，可以使用以下命令，将时区名称替换为你需要的时区：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">timedatectl set-timezone Asia/Shanghai</span><br></pre></td></tr></table></figure>
<h4 id="设置时间和日期"><a class="header-anchor" href="#设置时间和日期">¶</a>设置时间和日期</h4>
<p>可以直接使用 <code>timedatectl</code> 设置系统的时间和日期，例如设置为 2025 年 2 月 3 日 13:00:00：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">timedatectl set-time <span class="string">&quot;2025-02-03 13:00:00&quot;</span></span><br></pre></td></tr></table></figure>
<p>![image-20250203121555291](./Linux 系统服务管理/image-20250203121555291.png)</p>
<h4 id="启用或禁用-NTP-同步"><a class="header-anchor" href="#启用或禁用-NTP-同步">¶</a>启用或禁用 NTP 同步</h4>
<p>如果要启用 NTP 同步，使用以下命令：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">timedatectl set-ntp <span class="literal">true</span>				<span class="comment"># 启用</span></span><br><span class="line">timedatectl set-ntp <span class="literal">false</span>				<span class="comment"># 禁用</span></span><br></pre></td></tr></table></figure>
<p><code>ntpd</code> 主要专注于通过 NTP 协议与时间服务器进行通信，实现系统时间的精确同步，是一个持续运行的守护进程，负责不断调整系统时间以保持与时间服务器一致。而 <code>timedatectl</code> 是一个管理系统时间设置的工具，它可以查看系统时间状态、更改时区、设置时间日期以及控制 NTP 同步的启用和禁用等操作。可以说 <code>timedatectl</code> 提供了一个用户操作界面，而 <code>ntpd</code> 则负责实际的时间同步工作，两者可以配合使用，例如使用 <code>timedatectl</code> 启用 NTP 同步后，<code>ntpd</code> 会按照配置进行时间同步操作。</p>
<hr>
<h2 id="2-firewalld-防火墙服务"><a class="header-anchor" href="#2-firewalld-防火墙服务">¶</a>2.firewalld (防火墙服务)</h2>
<h3 id="基本介绍"><a class="header-anchor" href="#基本介绍">¶</a>基本介绍</h3>
<p>防火墙（Firewall）是一种网络安全工具（安全策略），用于<strong>控制和过滤网络流量</strong>，防止未经授权的访问，同时允许合法的数据通信。它就像一座<strong>智能大门</strong>，决定哪些数据包可以进入或离开计算机或服务器。</p>
<p>![Documentation - Architecture | firewalld](./Linux 系统服务管理/firewalld-structure+nftables.png)</p>
<p>防火墙的主要作用包括：</p>
<ul>
<li><strong>拦截恶意流量</strong>：防止黑客攻击、病毒传播或未经许可的访问。</li>
<li><strong>保护内部网络</strong>：阻止外部设备直接访问你的计算机或服务器的敏感端口，可以禁止来自特殊站点的访问。</li>
<li><strong>流量管理</strong>：根据设定的规则（如 IP 地址、端口号）允许或阻止特定的数据通信，可以关闭不使用的端口，能够禁止特定端口的流出通信。</li>
</ul>
<p>简单来说，<strong>防火墙就像保安</strong>，负责检查每个试图进入或离开你网络的“人”（数据包），并决定是放行、拦截还是询问管理员。防火墙分为硬件防火墙和软件防火墙：</p>
<ul>
<li>硬件防火墙：在硬件级别实现部分防火墙功能，另一部分功能基于软件实现，性能高，成本高</li>
<li>软件防火墙：应用软件处理逻辑运行于通用硬件平台之上的防火墙，性能低，成本低</li>
</ul>
<p>常见的防火墙服务有：</p>
<ul>
<li>
<p><strong>iptables</strong>（传统 Linux 防火墙），是有从前到后之分的</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">iptables -A INPUT -p tcp -m tcp --dport 22 -j ACCEPT		<span class="comment"># 接受22端口</span></span><br><span class="line">iptables -A INPUT -p tcp -m tcp --dport 98 -j DROP			<span class="comment"># 拒绝98端口</span></span><br></pre></td></tr></table></figure>
</li>
<li>
<p><strong>firewalld</strong>（现代 Linux 动态防火墙），其实也是创建 <code>iptables</code> 规则</p>
</li>
<li>
<p><strong>ufw（Uncomplicated Firewall）</strong>（Ubuntu 友好型防火墙）</p>
</li>
</ul>
<p>在 Linux 中，<code>firewalld</code> 是基于 iptables/netfilter 提供的一层动态防火墙管理，红帽系（RHEL/CentOS）常用，提供可实时加载规则，支持 zone、service、port 等管理方式。</p>
<h3 id="firewalld-服务脚本"><a class="header-anchor" href="#firewalld-服务脚本">¶</a>firewalld 服务脚本</h3>
<p>我们可以通过以下命令查看防火墙服务名以及查看服务脚本：</p>
<blockquote>
<p>服务管理脚本其实就是帮我们执行软件提供的二进制命令，firewalld、nginx 和其他软件都是这样</p>
</blockquote>
<p>![image-20250203192318288](./Linux 系统服务管理/image-20250203192318288.png)</p>
<h3 id="启用与关闭"><a class="header-anchor" href="#启用与关闭">¶</a>启用与关闭</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">systemctl start firewalld</span><br><span class="line">systemctl <span class="built_in">enable</span> firewalld</span><br><span class="line"></span><br><span class="line">systemctl stop firewalld</span><br><span class="line">systemctl <span class="built_in">disable</span> firewalld</span><br></pre></td></tr></table></figure>
<p><code>firewalld</code> 默认使用运行模式，运行模式是配置的防火墙策略立即生效，但不写入配置文件，与之相对的是永久模式，此模式下配置的防火墙策略写入配置文件，但要 <code>reload</code> 才生效。</p>
<h3 id="常用规则操作"><a class="header-anchor" href="#常用规则操作">¶</a>常用规则操作</h3>
<h4 id="添加-删除端口允许规则"><a class="header-anchor" href="#添加-删除端口允许规则">¶</a>添加/删除端口允许规则</h4>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 开放80端口</span></span><br><span class="line">firewall-cmd --permanent --add-port=80/tcp</span><br><span class="line">firewall-cmd --reload</span><br></pre></td></tr></table></figure>
<ul>
<li>
<p><code>--permanent</code>：写入永久规则，需要 <code>--reload</code> 生效。</p>
</li>
<li>
<p>若只想临时生效可不加 <code>--permanent</code>。</p>
</li>
<li>
<p>如果不加对应的协议会报错：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Error: INVALID_PORT: bad port (most likely missing protocol), correct syntax is portid[-portid]/protocol</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>举个例子，我们现在使用以下命令从89端口启动一个简单的HTTP服务（首先需要将虚拟机设置为桥接模式）：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 -m http.server 89</span><br></pre></td></tr></table></figure>
<p>我们会发现输入这个网址并没有连接成功：<a class="link" target="_blank" rel="noopener" href="http://0.0.0.0:89/">http://0.0.0.0:89/<i class="fas fa-external-link-alt"></i></a></p>
<p>![image-20250204234359318](./Linux 系统服务管理/image-20250204234359318.png)</p>
<p>原因当然是我们在主机上要访问的是虚拟机的地址+端口号啦，但测试了虚拟机的地址后依然发现没有连接成功，我们回去看一下我们防火墙的规则，发现其实我们并没有开启89端口：</p>
<p>![image-20250204234438104](./Linux 系统服务管理/image-20250204234438104.png)</p>
<p>因此我们需要手动先开启端口再尝试连接：</p>
<p>![image-20250205000851177](./Linux 系统服务管理/image-20250205000851177.png)</p>
<p>大功告成：</p>
<p>![image-20250205000900921](./Linux 系统服务管理/image-20250205000900921.png)</p>
<p>接下来我们可以删除端口：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">firewall-cmd --remove-port=89/tcp</span><br><span class="line"><span class="comment"># success</span></span><br></pre></td></tr></table></figure>
<p>![image-20250205001405409](./Linux 系统服务管理/image-20250205001405409.png)</p>
<p>现在又不能连接上了～</p>
<blockquote>
<p>补充 tcp协议和 udp 协议：</p>
<ul>
<li>tcp 协议是一个安全可靠的连接，需要双向确认，客户端和服务端都需要确认对方连接上了才能通信。</li>
<li>udp 协议是一个不可靠的连接协议，客户端可以随便给服务端发，不需要对方确认</li>
</ul>
<p>比如在一个很差的网络环境下，网页无法访问，无法做 DNS 解析，但 QQ 可以收发消息。因为网络网站服务用的都是 TCP 协议，而 QQ 和 ntp 用的都是 UDP 协议。</p>
</blockquote>
<h4 id="添加-删除服务"><a class="header-anchor" href="#添加-删除服务">¶</a>添加/删除服务</h4>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 开放ntp服务（一般包含80端口规则）</span></span><br><span class="line">firewall-cmd --permanent --add-service=ntp</span><br><span class="line">firewall-cmd --reload</span><br></pre></td></tr></table></figure>
<p>![image-20250205002650259](./Linux 系统服务管理/image-20250205002650259.png)</p>
<p>注意：我们有些服务其实是被包含在一些大模块下的，比如我们想要直接添加 nginx 服务是做不到的，但我们可以添加http服务，放行80端口即可：</p>
<p>![image-20250205004341309](./Linux 系统服务管理/image-20250205004341309.png)</p>
<p>如果 nginx 不是绑定在80端口就不好使了，得直接指定端口号进行添加：</p>
<p>![image-20250205004835538](./Linux 系统服务管理/image-20250205004835538.png)</p>
<p>![image-20250205004824003](./Linux 系统服务管理/image-20250205004824003.png)</p>
<p>总结就是最好直接针对端口号和协议号添加规则，而且 <code>firewalld</code> 使用起来限制比较多，可以直接使用 <code>iptables</code>，它支持很多复杂的参数，针对协议、来源端口、目标端口等，如公有云的安全组（阿里云提供的硬件防火墙）也是基于 <code>iptables</code> 这样的规则添加的。</p>
<h4 id="zone概念"><a class="header-anchor" href="#zone概念">¶</a>zone概念</h4>
<p><code>firewalld</code> 中把网络接口与 zone 绑定，不同 zone（public、trusted、internal 等）可有不同规则策略，以细分安全级别。</p>
<table>
<thead>
<tr>
<th>区域名称</th>
<th>信任级别</th>
<th>默认策略</th>
<th>典型应用场景</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>drop</strong></td>
<td>最低</td>
<td>丢弃所有传入流量，不回应任何请求，允许所有传出流量</td>
<td>最高安全性，完全隐藏设备，如黑洞防护</td>
</tr>
<tr>
<td><strong>block</strong></td>
<td>低</td>
<td>拒绝所有传入流量（返回 ICMP 端口不可达），允许所有传出流量</td>
<td>仅允许受信任的系统主动连接</td>
</tr>
<tr>
<td><strong>public</strong></td>
<td>低</td>
<td>允许出站连接，默认拒绝所有入站连接，仅允许 SSH</td>
<td>公共网络，如 WiFi 热点或陌生环境</td>
</tr>
<tr>
<td><strong>external</strong></td>
<td>中</td>
<td>用于 NAT 路由，默认只允许出站连接</td>
<td>服务器充当路由器，保护内部网络</td>
</tr>
<tr>
<td><strong>dmz</strong></td>
<td>中</td>
<td>允许外部访问特定服务，如 HTTP/HTTPS，默认拒绝所有其他流量</td>
<td>部署 Web 服务器或公共服务的隔离区域</td>
</tr>
<tr>
<td><strong>work</strong></td>
<td>高</td>
<td>允许内部可信网络的访问，默认允许 SSH、Samba</td>
<td>公司内部网络，适用于员工办公环境</td>
</tr>
<tr>
<td><strong>home</strong></td>
<td>高</td>
<td>允许家用网络的访问，默认允许 SSH、Samba、mDNS</td>
<td>家庭网络，适用于个人设备互通</td>
</tr>
<tr>
<td><strong>internal</strong></td>
<td>高</td>
<td>允许内部设备访问，默认允许 SSH、Samba、mDNS</td>
<td>受信任的局域网，如 VPN 连接</td>
</tr>
<tr>
<td><strong>trusted</strong></td>
<td>最高</td>
<td>允许所有流量（入站和出站）</td>
<td>完全信任的环境，如封闭内网</td>
</tr>
</tbody>
</table>
<p><strong>查看当前默认区域：</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">firewall-cmd --get-default-zone</span><br><span class="line"><span class="comment"># public</span></span><br></pre></td></tr></table></figure>
<p><strong>修改默认区域：</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo firewall-cmd --set-default-zone=work</span><br></pre></td></tr></table></figure>
<p><strong>列出所有区域的名字：</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">firewall-cmd --get-zones</span><br><span class="line"><span class="comment"># block dmz drop external home internal public trusted work</span></span><br></pre></td></tr></table></figure>
<p><strong>查询某个区域的默认规则：</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">firewall-cmd --zone=public --list-all</span><br></pre></td></tr></table></figure>
<p>![image-20250203194047421](./Linux 系统服务管理/image-20250203194047421.png)</p>
<p><strong>变更某个接口的区域：</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo firewall-cmd --zone=home --change-interface=eth0 --permanent</span><br></pre></td></tr></table></figure>
<p>然后重新加载防火墙：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo firewall-cmd --reload</span><br></pre></td></tr></table></figure>
<h3 id="复杂规则"><a class="header-anchor" href="#复杂规则">¶</a>复杂规则</h3>
<p>可借助 <code>--add-rich-rule</code> 来添加更复杂的匹配条件，如限制特定 IP 地址、端口、协议等；或直接使用 <code>iptables</code> 语法进行自定义，注意与 firewalld 的并存管理时要小心冲突。</p>
<h2 id="3-计划任务（crontab）"><a class="header-anchor" href="#3-计划任务（crontab）">¶</a>3.计划任务（crontab）</h2>
<p>计划任务让系统在指定时间周期自动执行某些脚本或命令，例如：</p>
<ul>
<li>定时备份数据库，每天凌晨 2 点；</li>
<li>定时清理日志文件或临时文件夹。</li>
</ul>
<h3 id="编辑与常用操作"><a class="header-anchor" href="#编辑与常用操作">¶</a>编辑与常用操作</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">crontab -e       <span class="comment"># 编辑当前用户的计划任务</span></span><br><span class="line">crontab -l       <span class="comment"># 查看</span></span><br><span class="line">crontab -r       <span class="comment"># 删除</span></span><br></pre></td></tr></table></figure>
<p><strong>条目格式</strong>：<br>
<code>MIN HOUR DAY MONTH WEEKDAY command</code></p>
<p>![image-20250205103130393](./Linux 系统服务管理/image-20250205103130393.png)</p>
<p>注意：</p>
<ol>
<li>写在定时任务里的命令必须是绝对路径，不容易出错</li>
<li>日期和星期是不能同时写的</li>
<li>WEEKDAY 从 0 到 7 分别表示周日到周六</li>
<li>四个符号
<ol>
<li><code>*</code> 表示取值范围中的每一个数字</li>
<li><code>-</code> 是做连续区间表达式的，想要表达 <code>1-7</code> 就直接写 <code>1-7</code> 即可</li>
<li><code>/</code> 表示每多少个，例如想每十分钟一次，可以在分的位置写 <code>*/10</code></li>
<li><code>,</code> 表示多个取值例如想在 1 点、2 点、6 点执行，可以写 <code>1,2,6</code></li>
</ol>
</li>
</ol>
<p>例如，每天凌晨 1:30 运行脚本 <code>/usr/local/bin/backup.sh</code>：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">30 1 * * * /usr/local/bin/backup.sh</span><br></pre></td></tr></table></figure>
<p>每天凌晨2点30，执行 <code>ntpdate</code> 命令同步 <code>ntp.aliyun.com</code> 且不输入任何信息（也就是把命令结果重定向到黑洞文件 <code>/dev/null</code>）：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">30 2 * * * /usr/sbin/ntpdate -u ntp.aliyun.com &amp;&gt; /dev/null</span><br></pre></td></tr></table></figure>
<p>现在做一个简单的测试，首先运行 <code>crontab -e</code> 进入写定时任务的界面：</p>
<p>![image-20250205113536906](./Linux 系统服务管理/image-20250205113536906.png)</p>
<p>可以看到定时任务已经生效了：</p>
<p>![image-20250205114021239](./Linux 系统服务管理/image-20250205114021239.png)</p>
<h3 id="相关目录"><a class="header-anchor" href="#相关目录">¶</a>相关目录</h3>
<ul>
<li>
<p><code>/etc/crontab</code> / <code>/etc/cron.d</code>：系统级计划任务配置。</p>
<p>![image-20250205115927338](./Linux 系统服务管理/image-20250205115927338.png)</p>
</li>
<li>
<p><code>/etc/cron.daily/</code>, <code>/etc/cron.hourly/</code>, <code>/etc/cron.weekly/</code>, <code>/etc/cron.monthly/</code>：自动分类执行脚本。</p>
</li>
</ul>
<p>要查看 <code>crontab</code> 的日志，可以查找：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">grep CRON /var/log/syslog</span><br></pre></td></tr></table></figure>
<p>![image-20250205115740974](./Linux 系统服务管理/image-20250205115740974.png)</p>
<h3 id="黑名单和白名单"><a class="header-anchor" href="#黑名单和白名单">¶</a>黑名单和白名单</h3>
<p>超级管理员可以通过配置来设置某些用户不允许设置计划任务，配置文件在 <code>/etc/cron.deny</code>，里面每行写一个用户名，白名单在 <code>/etc/allow</code>。白名单优先级高于黑名单，如果一个用户同时存在于两个名单中，则会被默认允许创建计划任务。</p>
<h2 id="4-SSH-Secure-Shell"><a class="header-anchor" href="#4-SSH-Secure-Shell">¶</a>4.SSH (Secure Shell)</h2>
<h3 id="作用与原理"><a class="header-anchor" href="#作用与原理">¶</a>作用与原理</h3>
<p><strong>SSH</strong> (Secure Shell) 提供安全的远程登录方式，可替代明文的 telnet/rsh。常见服务端程序如 <code>sshd</code>，允许远程客户端 <code>ssh user@host</code> 方式连接。</p>
<ul>
<li><strong>默认端口</strong>：22</li>
<li><strong>加密通信</strong>：所有数据（含密码）都通过加密隧道传输，确保安全性。</li>
</ul>
<p>查看软件的网络配置：</p>
<p>![image-20250128145224693](./Linux 系统服务管理/image-20250128145224693.png)</p>
<p>其中 <code>ens</code> 是真实的网卡配置文件。在网卡配置文件中，<code>BOOTPROTO</code> 这一个变量控制的是 IP 的获取方式，其中 <code>dhcp</code> 为动态分配，VMware 虚拟网卡会自动给你分配 IP 地址，而<code>static</code> 为静态 IP，即自己手动根据网络环境设置固定的 IP 地址。一般默认启动 network 服务都是获取 <code>dhcp</code> 动态 IP，可用范围一般是 192.168.0.2 到 192.168.0.254，同时会有一个默认的地址租期，这段时间内某台设备没用的话这个 IP 就会分配给别的设备，网关是流量出去的大门。</p>
<p>![TP-LINK](./Linux 系统服务管理/interlace,1.png)</p>
<p>要将动态 IP 修改为静态 IP，首先查看这个文件：</p>
<p>![image-20250130151023153](./Linux 系统服务管理/image-20250130151023153.png)</p>
<p>需要修改写入的内容形式可以为：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 对于桥接模式</span></span><br><span class="line"></span><br><span class="line">network:</span><br><span class="line">  version: 2</span><br><span class="line">  renderer: networkd</span><br><span class="line">  ethernets:</span><br><span class="line">    ens33:</span><br><span class="line">      dhcp4: no</span><br><span class="line">      addresses: [192.168.1.50/24]</span><br><span class="line">      gateway4: 192.168.1.1</span><br><span class="line">      nameservers:</span><br><span class="line">        addresses: [8.8.8.8, 8.8.4.4]</span><br><span class="line">        </span><br><span class="line"><span class="comment"># 对于NAT模式</span></span><br><span class="line">network:</span><br><span class="line">  version: 2</span><br><span class="line">  renderer: networkd</span><br><span class="line">  ethernets:</span><br><span class="line">    ens33:</span><br><span class="line">      dhcp4: no</span><br><span class="line">      addresses: [192.168.182.200/24]</span><br><span class="line">      gateway4: 192.168.182.2</span><br><span class="line">      nameservers:</span><br><span class="line">        addresses: [8.8.8.8, 8.8.4.4]</span><br></pre></td></tr></table></figure>
<p>注意 address 写之前记得 ping 一下看看是否存在。最后修改完配置文件记得要重庆网络。</p>
<h3 id="启动与管理"><a class="header-anchor" href="#启动与管理">¶</a>启动与管理</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">systemctl start sshd</span><br><span class="line">systemctl <span class="built_in">enable</span> sshd</span><br><span class="line">systemctl status sshd</span><br><span class="line">systemctl reload sshd</span><br><span class="line">systemctl <span class="built_in">enable</span> sshd    <span class="comment"># 设置开机自启</span></span><br><span class="line">systemctl <span class="built_in">disable</span> sshd</span><br><span class="line">systemctl is-enabled sshd.service    <span class="comment"># 查看是否开机自启</span></span><br></pre></td></tr></table></figure>
<ul>
<li><code>sshd</code> 为守护进程名，在某些发行版中也写作 <code>ssh</code>。</li>
</ul>
<h3 id="主要配置"><a class="header-anchor" href="#主要配置">¶</a>主要配置</h3>
<p><strong>配置文件</strong>：<code>/etc/ssh/sshd_config</code>。</p>
<ul>
<li><code>Port</code>：指定 SSH 监听端口（可修改防止被暴力扫描）。</li>
<li><code>PermitRootLogin</code>：是否允许 root 用户直接登录。</li>
<li><code>PasswordAuthentication</code>：可禁止密码登录，改为公钥方式以提升安全。</li>
</ul>
<h3 id="常见使用场景"><a class="header-anchor" href="#常见使用场景">¶</a>常见使用场景</h3>
<ol>
<li>
<p><strong>远程登录</strong>：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh root@192.168.1.100</span><br></pre></td></tr></table></figure>
</li>
<li>
<p><strong>文件传输</strong>：<code>scp</code> 或 <code>sftp</code> 通过 SSH 通道安全地上传/下载文件。</p>
</li>
<li>
<p><strong>SSH 公钥免密</strong>：把本地公钥加到目标主机的 <code>~/.ssh/authorized_keys</code> 里，即可免密码登录。</p>
</li>
</ol>
<h1>四、源码包与二进制包：软件安装模式</h1>
<h2 id="1-源码包"><a class="header-anchor" href="#1-源码包">¶</a>1.源码包</h2>
<ul>
<li>优点：可自由编译选项、适配性好、可进行自定义特性；</li>
<li>缺点：手动编译复杂、编译周期长、依赖配置繁琐。</li>
</ul>
<p>编译安装流程一般为</p>
<ol>
<li><code>./configure --prefix=... [--with-... etc]</code></li>
<li><code>make</code></li>
<li><code>make install</code></li>
</ol>
<p>安装结果通常放在指定 <code>prefix</code> 路径，需自行创建服务脚本或 systemd unit 文件。</p>
<h2 id="2-二进制包"><a class="header-anchor" href="#2-二进制包">¶</a>2.二进制包</h2>
<ul>
<li><strong>RPM</strong> 系：RedHat/CentOS 等使用的包管理格式，如 <code>yum</code>、<code>dnf</code>。</li>
<li><strong>DEB</strong> 系：Debian/Ubuntu 用 apt/dpkg 安装。</li>
<li>优点：安装方便，自动处理依赖，大多数发行版官方仓库都提供常见软件包；</li>
<li>缺点：可定制程度较低，版本可能不够新。</li>
</ul>
<p><strong>RPM</strong>（Red Hat Package Manager）是 RedHat 系统的底层包管理工具，<code>yum</code>/<code>dnf</code> 是对其的高层封装。</p>
<p><strong>常见命令</strong>：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">rpm -ivh package.rpm     <span class="comment"># 安装</span></span><br><span class="line">rpm -Uvh package.rpm     <span class="comment"># 升级</span></span><br><span class="line">rpm -e packagename       <span class="comment"># 卸载</span></span><br><span class="line">rpm -qa                   <span class="comment"># 查询已安装包列表</span></span><br><span class="line">rpm -qi packagename       <span class="comment"># 查看包信息</span></span><br></pre></td></tr></table></figure>
<p><strong>更多使用方式</strong></p>
<ul>
<li><code>rpm -ql packagename</code>：列出包中安装了哪些文件及路径。</li>
<li><code>rpm -qf /path/to/file</code>：反查某文件属于哪个 RPM 包。</li>
<li><code>yum</code>/<code>dnf</code>：自动依赖解析，在 /etc/yum.repos.d/ 定义源仓库；
<ul>
<li><code>yum install packagename</code>；</li>
<li><code>dnf update</code>；</li>
<li><code>yum remove packagename</code>。</li>
</ul>
</li>
</ul>

        </div>

        
            <div class="post-copyright-info">
                <div class="article-copyright-info-container">
    <ul>
        <li>本文标题：Linux 系统服务管理</li>
        <li>本文作者：Chen Kai</li>
        <li>创建时间：2025-01-06 00:00:00</li>
        <li>
            本文链接：https://www.chenk.top/Linux 系统服务管理/
        </li>
        <li>
            版权声明：本博客所有文章除特别声明外，均采用 <a class="license" target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh">BY-NC-SA</a> 许可协议。转载请注明出处！
        </li>
    </ul>
</div>

            </div>
        

        
            <ul class="post-tags-box">
                
                    <li class="tag-item">
                        <a href="/tags/Linux/">#Linux</a>&nbsp;
                    </li>
                
                    <li class="tag-item">
                        <a href="/tags/%E4%BA%91%E8%AE%A1%E7%AE%97/">#云计算</a>&nbsp;
                    </li>
                
            </ul>
        

        
            <div class="article-nav">
                
                    <div class="article-prev">
                        <a class="prev"
                           rel="prev"
                           href="/Linux%20%E4%BD%BF%E7%94%A8%E5%9F%BA%E7%A1%80/"
                        >
                            <span class="left arrow-icon flex-center">
                              <i class="fas fa-chevron-left"></i>
                            </span>
                            <span class="title flex-center">
                                <span class="post-nav-title-item">Linux 使用基础</span>
                                <span class="post-nav-item">上一篇</span>
                            </span>
                        </a>
                    </div>
                
                
                    <div class="article-next">
                        <a class="next"
                           rel="next"
                           href="/%E4%BA%91%E8%AE%A1%E7%AE%97%E4%B8%8E%E6%95%B0%E6%8D%AE%E4%B8%AD%E5%BF%83%E7%9F%A5%E8%AF%86%E4%BD%93%E7%B3%BB%E6%A2%B3%E7%90%86/"
                        >
                            <span class="title flex-center">
                                <span class="post-nav-title-item">云计算与数据中心知识体系梳理</span>
                                <span class="post-nav-item">下一篇</span>
                            </span>
                            <span class="right arrow-icon flex-center">
                              <i class="fas fa-chevron-right"></i>
                            </span>
                        </a>
                    </div>
                
            </div>
        

        
            <div class="comment-container">
                <div class="comments-container">
    <div id="comment-anchor"></div>
    <div class="comment-area-title">
        <i class="fas fa-comments">&nbsp;评论</i>
    </div>
    

        
            
    <div class="valine-container">
        <script data-pjax
                src="//cdn.jsdelivr.net/npm/valine@latest/dist/Valine.min.js"></script>
        <div id="vcomments"></div>
        <script data-pjax>
            function loadValine() {
                new Valine({
                    el: '#vcomments',
                    appId: 'p2Cu9MgjoKzo3VmulhNLIusH-gzGzoHsz',
                    appKey: 'QThQHg3c8sVwGpzg9lu8zEG3',
                    meta: ['nick', 'mail', 'link'],
                    avatar: 'wavatar',
                    enableQQ: true,
                    placeholder: '😜 尽情赞美帅气伟大的ck吧~',
                    lang: 'zh-CN'.toLowerCase()
                });

                function getAuthor(language) {
                    switch (language) {
                        case 'en':
                            return 'Author';
                        case 'zh-CN':
                            return '博主';
                        default:
                            return 'Master';
                    }
                }

                // Add "Author" identify
                const getValineDomTimer = setInterval(() => {
                    const vcards = document.querySelectorAll('#vcomments .vcards .vcard');
                    if (vcards.length > 0) {
                        let author = 'Chen Kai';

                        if (author) {
                            for (let vcard of vcards) {
                                const vnick_dom = vcard.querySelector('.vhead .vnick');
                                const vnick = vnick_dom.innerHTML;
                                if (vnick === author) {
                                    vnick_dom.innerHTML = `${vnick} <span class="author">${getAuthor(KEEP.hexo_config.language)}</span>`
                                }
                            }
                        }
                        clearInterval(getValineDomTimer);
                    } else {
                        clearInterval(getValineDomTimer);
                    }
                }, 2000);
            }

            if ('true') {
                const loadValineTimeout = setTimeout(() => {
                    loadValine();
                    clearTimeout(loadValineTimeout);
                }, 1000);
            } else {
                window.addEventListener('DOMContentLoaded', loadValine);
            }
        </script>
    </div>



        
    
</div>

            </div>
        
    </div>
</div>


                
            </div>

        </div>

        <div class="page-main-content-bottom">
            <footer class="footer">
    <div class="info-container">
        <div class="copyright-info info-item">
            &copy;
            
              <span>2020</span>
              -
            
            2026&nbsp;<i class="fas fa-heart icon-animate"></i>&nbsp;<a href="/">Chen Kai</a>
        </div>
        
            <script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
            <div class="website-count info-item">
                
                    <span id="busuanzi_container_site_uv">
                        访问人数&nbsp;<span id="busuanzi_value_site_uv"></span>&ensp;
                    </span>
                
                
            </div>
        
        <div class="theme-info info-item">
            <!-- 由 <a target="_blank" href="https://hexo.io">Hexo</a> 驱动&nbsp;|&nbsp;主题&nbsp;<a class="theme-version" target="_blank" href="https://github.com/XPoet/hexo-theme-keep">Keep v3.4.5</a> -->
        </div>
        
        
    </div>
</footer>

        </div>
    </div>

    
        <div class="post-tools">
            <div class="post-tools-container">
    <ul class="tools-list">
        <!-- TOC aside toggle -->
        
            <li class="tools-item page-aside-toggle">
                <i class="fas fa-outdent"></i>
            </li>
        

        <!-- go comment -->
        
            <li class="go-comment">
                <i class="fas fa-comment"></i>
            </li>
        
    </ul>
</div>

        </div>
    

    <div class="right-bottom-side-tools">
        <div class="side-tools-container">
    <ul class="side-tools-list">
        <li class="tools-item tool-font-adjust-plus flex-center">
            <i class="fas fa-search-plus"></i>
        </li>

        <li class="tools-item tool-font-adjust-minus flex-center">
            <i class="fas fa-search-minus"></i>
        </li>

        <li class="tools-item tool-expand-width flex-center">
            <i class="fas fa-arrows-alt-h"></i>
        </li>

        <li class="tools-item tool-dark-light-toggle flex-center">
            <i class="fas fa-moon"></i>
        </li>

        <!-- rss -->
        
            <li class="tools-item rss flex-center">
                <a class="flex-center"
                   href="/atom.xml"
                   target="_blank"
                >
                    <i class="fas fa-rss"></i>
                </a>
            </li>
        

        
            <li class="tools-item tool-scroll-to-top flex-center">
                <i class="fas fa-arrow-up"></i>
            </li>
        

        <li class="tools-item tool-scroll-to-bottom flex-center">
            <i class="fas fa-arrow-down"></i>
        </li>
    </ul>

    <ul class="exposed-tools-list">
        <li class="tools-item tool-toggle-show flex-center">
            <i class="fas fa-cog fa-spin"></i>
        </li>
        
    </ul>
</div>

    </div>

    
        <aside class="page-aside">
            <div class="post-toc-wrap">
    <div class="post-toc">
        <ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link"><span class="nav-number">1.</span> <span class="nav-text">一、什么是系统服务管理</span></a></li><li class="nav-item nav-level-1"><a class="nav-link"><span class="nav-number">2.</span> <span class="nav-text">二、Linux Systemd 服务管理</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-Systemd-%E5%9F%BA%E6%9C%AC%E4%BD%9C%E7%94%A8"><span class="nav-number">2.1.</span> <span class="nav-text">1.Systemd 基本作用</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-systemctl-%E4%BD%BF%E7%94%A8"><span class="nav-number">2.2.</span> <span class="nav-text">2.systemctl 使用</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link"><span class="nav-number">3.</span> <span class="nav-text">三、常见自有服务与用途</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-%E6%97%B6%E9%97%B4%E6%9C%8D%E5%8A%A1"><span class="nav-number">3.1.</span> <span class="nav-text">1.时间服务</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#ntpd-ntpsec"><span class="nav-number">3.1.1.</span> <span class="nav-text">ntpd &amp; ntpsec</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ntpdate%EF%BC%88%E4%B8%80%E6%AC%A1%E6%80%A7%E6%97%B6%E9%97%B4%E5%90%8C%E6%AD%A5%E5%B7%A5%E5%85%B7%EF%BC%89"><span class="nav-number">3.1.2.</span> <span class="nav-text">ntpdate（一次性时间同步工具）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#timedatectl-%EF%BC%88%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%E6%97%B6%E9%97%B4%E5%92%8C-NTP-%E8%AE%BE%E7%BD%AE%EF%BC%89"><span class="nav-number">3.1.3.</span> <span class="nav-text">timedatectl （管理系统时间和 NTP 设置）</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%9F%A5%E7%9C%8B%E5%BD%93%E5%89%8D%E6%97%B6%E9%97%B4%E5%92%8C%E6%97%A5%E6%9C%9F%E4%BF%A1%E6%81%AF"><span class="nav-number">3.1.3.1.</span> <span class="nav-text">查看当前时间和日期信息</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%9F%A5%E7%9C%8B%E5%8F%AF%E7%94%A8%E6%97%B6%E5%8C%BA"><span class="nav-number">3.1.3.2.</span> <span class="nav-text">查看可用时区</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%AE%BE%E7%BD%AE%E6%97%B6%E5%8C%BA"><span class="nav-number">3.1.3.3.</span> <span class="nav-text">设置时区</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%AE%BE%E7%BD%AE%E6%97%B6%E9%97%B4%E5%92%8C%E6%97%A5%E6%9C%9F"><span class="nav-number">3.1.3.4.</span> <span class="nav-text">设置时间和日期</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%90%AF%E7%94%A8%E6%88%96%E7%A6%81%E7%94%A8-NTP-%E5%90%8C%E6%AD%A5"><span class="nav-number">3.1.3.5.</span> <span class="nav-text">启用或禁用 NTP 同步</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-firewalld-%E9%98%B2%E7%81%AB%E5%A2%99%E6%9C%8D%E5%8A%A1"><span class="nav-number">3.2.</span> <span class="nav-text">2.firewalld (防火墙服务)</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%9F%BA%E6%9C%AC%E4%BB%8B%E7%BB%8D"><span class="nav-number">3.2.1.</span> <span class="nav-text">基本介绍</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#firewalld-%E6%9C%8D%E5%8A%A1%E8%84%9A%E6%9C%AC"><span class="nav-number">3.2.2.</span> <span class="nav-text">firewalld 服务脚本</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%90%AF%E7%94%A8%E4%B8%8E%E5%85%B3%E9%97%AD"><span class="nav-number">3.2.3.</span> <span class="nav-text">启用与关闭</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B8%B8%E7%94%A8%E8%A7%84%E5%88%99%E6%93%8D%E4%BD%9C"><span class="nav-number">3.2.4.</span> <span class="nav-text">常用规则操作</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%B7%BB%E5%8A%A0-%E5%88%A0%E9%99%A4%E7%AB%AF%E5%8F%A3%E5%85%81%E8%AE%B8%E8%A7%84%E5%88%99"><span class="nav-number">3.2.4.1.</span> <span class="nav-text">添加&#x2F;删除端口允许规则</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%B7%BB%E5%8A%A0-%E5%88%A0%E9%99%A4%E6%9C%8D%E5%8A%A1"><span class="nav-number">3.2.4.2.</span> <span class="nav-text">添加&#x2F;删除服务</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#zone%E6%A6%82%E5%BF%B5"><span class="nav-number">3.2.4.3.</span> <span class="nav-text">zone概念</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%A4%8D%E6%9D%82%E8%A7%84%E5%88%99"><span class="nav-number">3.2.5.</span> <span class="nav-text">复杂规则</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-%E8%AE%A1%E5%88%92%E4%BB%BB%E5%8A%A1%EF%BC%88crontab%EF%BC%89"><span class="nav-number">3.3.</span> <span class="nav-text">3.计划任务（crontab）</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%BC%96%E8%BE%91%E4%B8%8E%E5%B8%B8%E7%94%A8%E6%93%8D%E4%BD%9C"><span class="nav-number">3.3.1.</span> <span class="nav-text">编辑与常用操作</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9B%B8%E5%85%B3%E7%9B%AE%E5%BD%95"><span class="nav-number">3.3.2.</span> <span class="nav-text">相关目录</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%BB%91%E5%90%8D%E5%8D%95%E5%92%8C%E7%99%BD%E5%90%8D%E5%8D%95"><span class="nav-number">3.3.3.</span> <span class="nav-text">黑名单和白名单</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-SSH-Secure-Shell"><span class="nav-number">3.4.</span> <span class="nav-text">4.SSH (Secure Shell)</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BD%9C%E7%94%A8%E4%B8%8E%E5%8E%9F%E7%90%86"><span class="nav-number">3.4.1.</span> <span class="nav-text">作用与原理</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%90%AF%E5%8A%A8%E4%B8%8E%E7%AE%A1%E7%90%86"><span class="nav-number">3.4.2.</span> <span class="nav-text">启动与管理</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%BB%E8%A6%81%E9%85%8D%E7%BD%AE"><span class="nav-number">3.4.3.</span> <span class="nav-text">主要配置</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B8%B8%E8%A7%81%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF"><span class="nav-number">3.4.4.</span> <span class="nav-text">常见使用场景</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link"><span class="nav-number">4.</span> <span class="nav-text">四、源码包与二进制包：软件安装模式</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-%E6%BA%90%E7%A0%81%E5%8C%85"><span class="nav-number">4.1.</span> <span class="nav-text">1.源码包</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-%E4%BA%8C%E8%BF%9B%E5%88%B6%E5%8C%85"><span class="nav-number">4.2.</span> <span class="nav-text">2.二进制包</span></a></li></ol></li></ol>
    </div>
</div>
        </aside>
    

    <div class="image-viewer-container">
    <img src="">
</div>


    
        <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
          <span class="search-input-field-pre">
            <i class="fas fa-keyboard"></i>
          </span>
            <div class="search-input-container">
                <input autocomplete="off"
                       autocorrect="off"
                       autocapitalize="off"
                       placeholder="搜索..."
                       spellcheck="false"
                       type="search"
                       class="search-input"
                >
            </div>
            <span class="popup-btn-close">
                <i class="fas fa-times"></i>
            </span>
        </div>
        <div id="search-result">
            <div id="no-result">
                <i class="fas fa-spinner fa-pulse fa-5x fa-fw"></i>
            </div>
        </div>
    </div>
</div>

    

</main>




<script src="/js/utils.js"></script>

<script src="/js/main.js"></script>

<script src="/js/header-shrink.js"></script>

<script src="/js/back2top.js"></script>

<script src="/js/dark-light-toggle.js"></script>

<script src="/js/lang-switch.js"></script>



    
<script src="/js/local-search.js"></script>




    
<script src="/js/code-copy.js"></script>





<div class="post-scripts pjax">
    
        
<script src="/js/left-side-toggle.js"></script>

<script src="/js/libs/anime.min.js"></script>

<script src="/js/toc.js"></script>

    
</div>


    
<script src="/js/libs/pjax.min.js"></script>

<script>
    window.addEventListener('DOMContentLoaded', () => {
        window.pjax = new Pjax({
            selectors: [
                'head title',
                '.page-container',
                '.pjax'
            ],
            history: true,
            debug: false,
            cacheBust: false,
            timeout: 0,
            analytics: false,
            currentUrlFullReload: false,
            scrollRestoration: false,
            // scrollTo: true,
        });

        document.addEventListener('pjax:send', () => {
            KEEP.utils.pjaxProgressBarStart();
        });

        document.addEventListener('pjax:complete', () => {
            KEEP.utils.pjaxProgressBarEnd();
            window.pjax.executeScripts(document.querySelectorAll('script[data-pjax], .pjax script'));
            KEEP.refresh();
        });
    });
</script>



</body>
</html>
